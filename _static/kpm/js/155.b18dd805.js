"use strict";(self.webpackChunkpipeline_manager=self.webpackChunkpipeline_manager||[]).push([[155],{99155:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=n(12893),s=n(78126),o=n(95542),i=function(t,e,n){this.id=t,this.rect=e,this.children=n,this.leaf=void 0===n||0===n.length};e.NodeWrapper=i;var a=function(t,e,n,r,s){void 0===r&&(r=null),void 0===s&&(s=null),this.id=t,this.x=e,this.y=n,this.node=r,this.line=s};e.Vert=a;var h=function(){function t(e,n){this.s=e,this.t=n;var r=t.findMatch(e,n),s=n.slice(0).reverse(),o=t.findMatch(e,s);r.length>=o.length?(this.length=r.length,this.si=r.si,this.ti=r.ti,this.reversed=!1):(this.length=o.length,this.si=o.si,this.ti=n.length-o.ti-o.length,this.reversed=!0)}return t.findMatch=function(t,e){for(var n=t.length,r=e.length,s={length:0,si:-1,ti:-1},o=new Array(n),i=0;i<n;i++){o[i]=new Array(r);for(var a=0;a<r;a++)if(t[i]===e[a]){var h=o[i][a]=0===i||0===a?1:o[i-1][a-1]+1;h>s.length&&(s.length=h,s.si=i-h+1,s.ti=a-h+1)}else o[i][a]=0}return s},t.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},t}();e.LongestCommonSubsequence=h;var u=function(){function t(t,e,n){var s=this;void 0===n&&(n=12),this.originalnodes=t,this.groupPadding=n,this.leaves=null,this.nodes=t.map((function(t,n){return new i(n,e.getBounds(t),e.getChildren(t))})),this.leaves=this.nodes.filter((function(t){return t.leaf})),this.groups=this.nodes.filter((function(t){return!t.leaf})),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach((function(t){return t.children.forEach((function(e){return s.nodes[e].parent=t}))})),this.root={children:[]},this.nodes.forEach((function(t){void 0===t.parent&&(t.parent=s.root,s.root.children.push(t.id)),t.ports=[]})),this.backToFront=this.nodes.slice(0),this.backToFront.sort((function(t,e){return s.getDepth(t)-s.getDepth(e)})),this.backToFront.slice(0).reverse().filter((function(t){return!t.leaf})).forEach((function(t){var e=r.Rectangle.empty();t.children.forEach((function(t){return e=e.union(s.nodes[t].rect)})),t.rect=e.inflate(s.groupPadding)}));var o=this.midPoints(this.cols.map((function(t){return t.pos}))),h=this.midPoints(this.rows.map((function(t){return t.pos}))),u=o[0],c=o[o.length-1],f=h[0],l=h[h.length-1],g=this.rows.map((function(t){return{x1:u,x2:c,y1:t.pos,y2:t.pos}})).concat(h.map((function(t){return{x1:u,x2:c,y1:t,y2:t}}))),p=this.cols.map((function(t){return{x1:t.pos,x2:t.pos,y1:f,y2:l}})).concat(o.map((function(t){return{x1:t,x2:t,y1:f,y2:l}}))),d=g.concat(p);d.forEach((function(t){return t.verts=[]})),this.verts=[],this.edges=[],g.forEach((function(t){return p.forEach((function(e){var n=new a(s.verts.length,e.x1,t.y1);t.verts.push(n),e.verts.push(n),s.verts.push(n);for(var r=s.backToFront.length;r-- >0;){var o=s.backToFront[r],i=o.rect,h=Math.abs(n.x-i.cx()),u=Math.abs(n.y-i.cy());if(h<i.width()/2&&u<i.height()/2){n.node=o;break}}}))})),d.forEach((function(t,e){s.nodes.forEach((function(e,n){e.rect.lineIntersections(t.x1,t.y1,t.x2,t.y2).forEach((function(n,r){var o=new a(s.verts.length,n.x,n.y,e,t);s.verts.push(o),t.verts.push(o),e.ports.push(o)}))}));var n=Math.abs(t.y1-t.y2)<.1,r=function(t,e){return n?e.x-t.x:e.y-t.y};t.verts.sort(r);for(var o=1;o<t.verts.length;o++){var i=t.verts[o-1],h=t.verts[o];i.node&&i.node===h.node&&i.node.leaf||s.edges.push({source:i.id,target:h.id,length:Math.abs(r(i,h))})}}))}return t.prototype.avg=function(t){return t.reduce((function(t,e){return t+e}))/t.length},t.prototype.getGridLines=function(t){for(var e=[],n=this.leaves.slice(0,this.leaves.length);n.length>0;){var r=n.filter((function(e){return e.rect["overlap"+t.toUpperCase()](n[0].rect)})),s={nodes:r,pos:this.avg(r.map((function(e){return e.rect["c"+t]()})))};e.push(s),s.nodes.forEach((function(t){return n.splice(n.indexOf(t),1)}))}return e.sort((function(t,e){return t.pos-e.pos})),e},t.prototype.getDepth=function(t){for(var e=0;t.parent!==this.root;)e++,t=t.parent;return e},t.prototype.midPoints=function(t){for(var e=t[1]-t[0],n=[t[0]-e/2],r=1;r<t.length;r++)n.push((t[r]+t[r-1])/2);return n.push(t[t.length-1]+e/2),n},t.prototype.findLineage=function(t){var e=[t];do{t=t.parent,e.push(t)}while(t!==this.root);return e.reverse()},t.prototype.findAncestorPathBetween=function(t,e){for(var n=this.findLineage(t),r=this.findLineage(e),s=0;n[s]===r[s];)s++;return{commonAncestor:n[s-1],lineages:n.slice(s).concat(r.slice(s))}},t.prototype.siblingObstacles=function(t,e){var n=this,r=this.findAncestorPathBetween(t,e),s={};r.lineages.forEach((function(t){return s[t.id]={}}));var o=r.commonAncestor.children.filter((function(t){return!(t in s)}));return r.lineages.filter((function(t){return t.parent!==r.commonAncestor})).forEach((function(t){return o=o.concat(t.parent.children.filter((function(e){return e!==t.id})))})),o.map((function(t){return n.nodes[t]}))},t.getSegmentSets=function(t,e,n){for(var r=[],s=0;s<t.length;s++)for(var o=t[s],i=0;i<o.length;i++){(f=o[i]).edgeid=s,f.i=i;var a=f[1][e]-f[0][e];Math.abs(a)<.1&&r.push(f)}r.sort((function(t,n){return t[0][e]-n[0][e]}));for(var h=[],u=null,c=0;c<r.length;c++){var f=r[c];(!u||Math.abs(f[0][e]-u.pos)>.1)&&(u={pos:f[0][e],segments:[]},h.push(u)),u.segments.push(f)}return h},t.nudgeSegs=function(t,e,n,r,o,i){var a=r.length;if(!(a<=1)){for(var h=r.map((function(e){return new s.Variable(e[0][t])})),u=[],c=0;c<a;c++)for(var f=0;f<a;f++)if(c!==f){var l=r[c],g=r[f],p=l.edgeid,d=g.edgeid,v=-1,y=-1;"x"==t?o(p,d)&&(l[0][e]<l[1][e]?(v=f,y=c):(v=c,y=f)):o(p,d)&&(l[0][e]<l[1][e]?(v=c,y=f):(v=f,y=c)),v>=0&&u.push(new s.Constraint(h[v],h[y],i))}new s.Solver(h,u).solve(),h.forEach((function(e,s){var o=r[s],i=e.position();o[0][t]=o[1][t]=i;var a=n[o.edgeid];o.i>0&&(a[o.i-1][1][t]=i),o.i<a.length-1&&(a[o.i+1][0][t]=i)}))}},t.nudgeSegments=function(e,n,r,s,o){for(var i=t.getSegmentSets(e,n,r),a=0;a<i.length;a++){for(var h=i[a],u=[],c=0;c<h.segments.length;c++){var f=h.segments[c];u.push({type:0,s:f,pos:Math.min(f[0][r],f[1][r])}),u.push({type:1,s:f,pos:Math.max(f[0][r],f[1][r])})}u.sort((function(t,e){return t.pos-e.pos+t.type-e.type}));var l=[],g=0;u.forEach((function(i){0===i.type?(l.push(i.s),g++):g--,0==g&&(t.nudgeSegs(n,r,e,l,s,o),l=[])}))}},t.prototype.routeEdges=function(e,n,r,s){var o=this,i=e.map((function(t){return o.route(r(t),s(t))})),a=t.orderEdges(i),h=i.map((function(e){return t.makeSegments(e)}));return t.nudgeSegments(h,"x","y",a,n),t.nudgeSegments(h,"y","x",a,n),t.unreverseEdges(h,i),h},t.unreverseEdges=function(t,e){t.forEach((function(t,n){e[n].reversed&&(t.reverse(),t.forEach((function(t){t.reverse()})))}))},t.angleBetween2Lines=function(t,e){var n=Math.atan2(t[0].y-t[1].y,t[0].x-t[1].x),r=Math.atan2(e[0].y-e[1].y,e[0].x-e[1].x),s=n-r;return(s>Math.PI||s<-Math.PI)&&(s=r-n),s},t.isLeft=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)<=0},t.getOrder=function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];void 0===e[r.l]&&(e[r.l]={}),e[r.l][r.r]=!0}return function(t,n){return void 0!==e[t]&&e[t][n]}},t.orderEdges=function(e){for(var n=[],r=0;r<e.length-1;r++)for(var s=r+1;s<e.length;s++){var o,i,a,u=e[r],c=e[s],f=new h(u,c);0!==f.length&&(f.reversed&&(c.reverse(),c.reversed=!0,f=new h(u,c)),(f.si<=0||f.ti<=0)&&(f.si+f.length>=u.length||f.ti+f.length>=c.length)?n.push({l:r,r:s}):(f.si+f.length>=u.length||f.ti+f.length>=c.length?(o=u[f.si+1],a=u[f.si-1],i=c[f.ti-1]):(o=u[f.si+f.length-2],i=u[f.si+f.length],a=c[f.ti+f.length]),t.isLeft(o,i,a)?n.push({l:s,r}):n.push({l:r,r:s})))}return t.getOrder(n)},t.makeSegments=function(t){function e(t){return{x:t.x,y:t.y}}for(var n=function(t,e,n){return Math.abs((e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x))<.001},r=[],s=e(t[0]),o=1;o<t.length;o++){var i=e(t[o]),a=o<t.length-1?t[o+1]:null;a&&n(s,i,a)||(r.push([s,i]),s=i)}return r},t.prototype.route=function(t,e){var n=this,r=this.nodes[t],s=this.nodes[e];this.obstacles=this.siblingObstacles(r,s);var i={};this.obstacles.forEach((function(t){return i[t.id]=t})),this.passableEdges=this.edges.filter((function(t){var e=n.verts[t.source],r=n.verts[t.target];return!(e.node&&e.node.id in i||r.node&&r.node.id in i)}));for(var a=1;a<r.ports.length;a++){var h=r.ports[0].id,u=r.ports[a].id;this.passableEdges.push({source:h,target:u,length:0})}for(a=1;a<s.ports.length;a++)h=s.ports[0].id,u=s.ports[a].id,this.passableEdges.push({source:h,target:u,length:0});var c=new o.Calculator(this.verts.length,this.passableEdges,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).PathFromNodeToNodeWithPrevCost(r.ports[0].id,s.ports[0].id,(function(t,e,o){var i=n.verts[t],a=n.verts[e],h=n.verts[o],u=Math.abs(h.x-i.x),c=Math.abs(h.y-i.y);return i.node===r&&i.node===a.node||a.node===s&&a.node===h.node?0:u>1&&c>1?1e3:0})),f=c.reverse().map((function(t){return n.verts[t]}));return f.push(this.nodes[s.id].ports[0]),f.filter((function(t,e){return!(e<f.length-1&&f[e+1].node===r&&t.node===r||e>0&&t.node===s&&f[e-1].node===s)}))},t.getRoutePath=function(e,n,r,s){var o,i,a,h={routepath:"M "+e[0][0].x+" "+e[0][0].y+" ",arrowpath:""};if(e.length>1)for(var u=0;u<e.length;u++){var c=(o=e[u])[1].x,f=o[1].y,l=c-o[0].x,g=f-o[0].y;if(u<e.length-1){Math.abs(l)>0?c-=l/Math.abs(l)*n:f-=g/Math.abs(g)*n,h.routepath+="L "+c+" "+f+" ";var p=e[u+1],d=p[0].x,v=p[0].y;l=p[1].x-d,g=p[1].y-v;var y,x,b=t.angleBetween2Lines(o,p)<0?1:0;Math.abs(l)>0?(y=d+l/Math.abs(l)*n,x=v):(y=d,x=v+g/Math.abs(g)*n);var m=Math.abs(y-c),M=Math.abs(x-f);h.routepath+="A "+m+" "+M+" 0 0 "+b+" "+y+" "+x+" "}else{var E=[c,f];Math.abs(l)>0?(i=[c-=l/Math.abs(l)*s,f+r],a=[c,f-r]):(i=[c+r,f-=g/Math.abs(g)*s],a=[c-r,f]),h.routepath+="L "+c+" "+f+" ",s>0&&(h.arrowpath="M "+E[0]+" "+E[1]+" L "+i[0]+" "+i[1]+" L "+a[0]+" "+a[1])}}else c=(o=e[0])[1].x,f=o[1].y,l=c-o[0].x,g=f-o[0].y,E=[c,f],Math.abs(l)>0?(i=[c-=l/Math.abs(l)*s,f+r],a=[c,f-r]):(i=[c+r,f-=g/Math.abs(g)*s],a=[c-r,f]),h.routepath+="L "+c+" "+f+" ",s>0&&(h.arrowpath="M "+E[0]+" "+E[1]+" L "+i[0]+" "+i[1]+" L "+a[0]+" "+a[1]);return h},t}();e.GridRouter=u}}]);
//# sourceMappingURL=155.b18dd805.js.map