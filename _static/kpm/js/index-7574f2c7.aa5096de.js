"use strict";(self.webpackChunkpipeline_manager=self.webpackChunkpipeline_manager||[]).push([[257],{35851:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(46171),i=n(63491),a=n(20641),r=n(42302),s=n(34250),l=n(41857),d=n(96422),c=n(54320),u=n(14121),p=n(8239),h=n(57565);class v extends o.KE{preview=!1;_hideHud=!1;get hideHud(){return this._hideHud||this.preview}set hideHud(e){this._hideHud=e}_readonly=!1;get readonly(){return this._readonly||this.preview}set readonly(e){this._readonly=e}allowLoopbacks=!1;nodeIcons=new Map;nodeColors=new Map;baseURLs=new Map;baseIconUrls=new Map;nodeURLs=new Map;nodeStyles=new Map;layoutManager=new c.A;subgraphStack=[];parentNodes=new Map;subgraphStackGraphTypeEnum={SUBGRAPH:"subgraph",RELATEDGRAPH:"relatedGraph"};editorManager=null;newRootGraph=void 0;registerGraph(e){const t=function(e){return e.events.addAnchor=new s.Hx,e.events.removeAnchor=new s.Hx,e.events.editNode=new s.Hx,e.graphNode=void 0,e.checkConnection=function(e,t){if(!e||!t)return{connectionAllowed:!1,error:"Invalid from and to references."};const n=this.findNodeById(e.nodeId),i=this.findNodeById(t.nodeId);if(n&&i&&n===i&&!this.editor.allowLoopbacks)return{connectionAllowed:!1,error:"Loopbacks are not allowed."};if("input"===e.direction&&"output"===t.direction||"input"===e.direction&&"inout"===t.direction||"inout"===e.direction&&"output"===t.direction){const n=e;e=t,t=n}if(e.isInput&&"inout"!==e.direction)return{connectionAllowed:!1,error:"Connections are only allowed from output or inout interfaces."};if(!t.isInput)return{connectionAllowed:!1,error:"Connections are only allowed to input or inout interfaces."};if(this.connections.some((n=>n.from===e&&n.to===t)))return{connectionAllowed:!1,error:"Duplicate connections are not allowed."};if(e.maxConnectionsCount>0&&e.connectionCount+1>e.maxConnectionsCount)return{connectionAllowed:!1,error:`Too many connections from an input interface '${e.id}', maximum of '${e.maxConnectionsCount}' are allowed.`};if((0===t.maxConnectionsCount||void 0===t.maxConnectionsCount)&&t.connectionCount>0)return{connectionAllowed:!1,error:`By default only one connection to an input interface '${t.id}' allowed.`};if(t.maxConnectionsCount>0&&t.connectionCount+1>t.maxConnectionsCount)return{connectionAllowed:!1,error:`Too many connections to an output interface '${t.id}', maximum of '${t.maxConnectionsCount}' are allowed.`};if(e.type&&t.type){const n="string"==typeof e.type||e.type instanceof String?[e.type]:e.type,o="string"==typeof t.type||t.type instanceof String?[t.type]:t.type;if(void 0===n.find((e=>o.includes(e))))return{connectionAllowed:!1,error:`No common types between interfaces. Interface '${e.id}' supports types '${n}' and interface '${t.id}' supports types '${o}'.`}}return this.events.checkConnection.emit({from:e,to:t}).prevented?{connectionAllowed:!1,error:`Connection between an input interface '${e.id}' and an output interface '${t.id}' was prevented`}:this.hooks.checkConnection.execute({from:e,to:t}).some((e=>!e.connectionAllowed))?{connectionAllowed:!1,errors:`Connection between an input interface '${e.id}' and an output interface '${t.id}' was prevented`}:{connectionAllowed:!0,dummyConnection:new o.pB(e,t),connectionsInDanger:[]}},e.addAnchor=function(t,n,o){const i={x:t.x,y:t.y,id:(0,r.A)()};void 0===n.anchors&&(n.anchors=[]),n.anchors.splice(o,0,i),e.events.addAnchor.emit([n,3*o+1])},e.replaceNode=function(e,t){const n=e.position,i=new(this.editor.nodeTypes.get(t).type);e.title!==e.type&&(i.title=e.title),Object.entries({...e.inputs,...e.outputs}).forEach((([e,t])=>{void 0!==t.direction?(Object.prototype.hasOwnProperty.call(i.inputs,e)&&(0,d.q6)(i,i.inputs[e],t.side,t.sidePosition,!1,!1),Object.prototype.hasOwnProperty.call(i.outputs,e)&&(0,d.q6)(i,i.outputs[e],t.side,t.sidePosition,!1,!1)):Object.prototype.hasOwnProperty.call(i.inputs,e)&&i.inputs[e].componentName===t.componentName&&(i.inputs[e].value=t.value)}));const a=[...Object.values(e.inputs),...Object.values(e.outputs)],r=this.connections.filter((e=>a.includes(e.from)||a.includes(e.to))),s=[];return Object.entries({...e.inputs,...e.outputs}).forEach((([e,t])=>{void 0!==t.direction&&r.forEach((n=>{if(Object.prototype.hasOwnProperty.call(i.inputs,e))if(n.from===t){const t=new o.Ng(i.inputs[e],n.to);t.anchors=n.anchors,s.push(t)}else if(n.to===t){const t=new o.Ng(n.from,i.inputs[e]);t.anchors=n.anchors,s.push(t)}if(Object.prototype.hasOwnProperty.call(i.outputs,e))if(n.from===t){const t=new o.Ng(i.outputs[e],n.to);t.anchors=n.anchors,s.push(t)}else if(n.to===t){const t=new o.Ng(n.from,i.outputs[e]);t.anchors=n.anchors,s.push(t)}}))})),i.position=n,(0,l.nb)(),this.removeNode(e),this.addNode(i),s.forEach((e=>this.internalAddConnection(e))),(0,l.wH)(),i},e.addNode=function(e,t,n){if(!this.events.beforeAddNode.emit(e).prevented){if(this.nodeEvents.addTarget(e.events),this.nodeHooks.addTarget(e.hooks),e.registerGraph(this),void 0!==e.template){const t=JSON.parse(JSON.stringify(e.template.save()));t.id??=(0,r.A)(),e.template=new o.b1(t,this.editor)}return this._nodes.push(e),(e=this.nodes.find((t=>t.id===e.id))).onPlaced(t,n),this.events.addNode.emit(e),e}},e.destroy=function(){},e.load=function(t){const n=[];for(let e=this.connections.length-1;e>=0;e-=1)this.removeConnection(this.connections[e]);for(let e=this.nodes.length-1;e>=0;e-=1)this.removeNode(this.nodes[e]);return this.id=t.id??(0,r.A)(),this.name=t.name??void 0,t.nodes.forEach((e=>{const o=this.editor.nodeTypes.get(e.name);if(o){const i=new o.type;e.id??=(0,r.A)(),this.addNode(i,t.graphLoadingState,e.id);const a=i.load(e);Array.isArray(a)&&a.length&&n.push(...a)}else n.push(`Node type ${e.name} is not registered`)})),t.connections.forEach((e=>{e.id??=(0,r.A)()})),t.connections.forEach((i=>{const a=this.findNodeInterface(i.from),r=this.findNodeInterface(i.to);if(a)if(a.port)if(r)if(r.port)if(t.connections.some((e=>e.id===i.id&&(e.from!==i.from||e.to!==i.to))))n.push(`Connection of id '${i.id}' invalid. ID is already taken.`);else{const t=this.checkConnection(a,r);if(t.connectionAllowed){t.connectionsInDanger.forEach((e=>{const t=this.connections.find((t=>t.id===e.id));t&&this.removeConnection(t)}));const n=new o.Ng(t.dummyConnection.from,t.dummyConnection.to);i.anchors?.forEach(((t,o)=>{e.addAnchor(t,n,o)})),this.internalAddConnection(n)}else n.push(`Could not create connection of id '${i.id}'. ${t.error}`)}else n.push(`Connection of id '${i.id}' invalid. Destination of the connection is not an Interface`);else n.push(`Connection of id '${i.id}' invalid. Could not find interface with id '${i.to}'`);else n.push(`Connection of id '${i.id}' invalid. Source of the connection is not an Interface`);else n.push(`Connection of id '${i.id}' invalid. Could not find interface with id '${i.from}'`)})),this.hooks.load.execute(t),n},e.size=function(){const e=this.nodes.map((e=>{const t=document.getElementById(e.id);return{width:t.offsetWidth,height:t.offsetHeight,position:e.position}})),t=100,n=Math.max(...e.map((e=>e.position.x+e.width)))+t,o=Math.min(...e.map((e=>e.position.x)))-t,i=Math.max(...e.map((e=>e.position.y+e.height)))+t,a=Math.min(...e.map((e=>e.position.y)))-t;return{graphHeight:i-a,graphWidth:n-o,rightmostX:n,leftmostX:o,bottommostY:i,topmostY:a}},e.save=function(){const e={id:this.id,name:this.name,nodes:this.nodes.map((e=>e.save())),connections:this.connections.map((e=>({id:e.id,from:e.from.id,to:e.to.id,anchors:e.anchors?.map((e=>({x:e.x,y:e.y})))}))),scaling:this.scaling,panning:this.panning};return this.hooks.save.execute(e)},e.removeSelectedNodes=function(){for(let e=this.selectedNodes.length-1;e>=0;e-=1)this.removeNode(this.selectedNodes[e])},e.removeNode=function(e){if(this.nodes.includes(e)){if(this.events.beforeRemoveNode.emit(e).prevented)return;const t=[...Object.values(e.inputs),...Object.values(e.outputs)];this.connections.filter((e=>t.includes(e.from)||t.includes(e.to))).forEach((e=>this.removeConnection(e))),this._nodes.splice(this.nodes.indexOf(e),1),this.events.removeNode.emit(e),e.onDestroy(),this.nodeEvents.removeTarget(e.events),this.nodeHooks.removeTarget(e.hooks)}},e.removeNodeOnly=function(e){this._nodes.splice(this.nodes.indexOf(e),1),this.events.removeNode.emit(e),e.onDestroy(),this.nodeEvents.removeTarget(e),this.nodeHooks.removeTarget(e)},e.editNode=function(e){this.events.editNode.emit(e)},e.obtainExposedNames=function(){const e=[];return this._nodes.forEach((t=>{Object.values({...t.inputs,...t.outputs}).forEach((t=>{void 0!==t.externalName&&e.push(t.externalName)}))})),e},e.isIncorrectExternalName=function(e,t){const n=t.filter((t=>t===e)).length,o=[...Object.keys(this.graphNode.inputs),...Object.keys(this.graphNode.outputs)].map((e=>e.split("_"))).filter((e=>"property"!==e[0])).map((e=>e[1])).filter((t=>t===e)).length;return 0===e.length||0!==n||0!==o},e.resolveNewExposedName=function(e){const t=this.obtainExposedNames();let n=1,o=e;for(;this.isIncorrectExternalName(o,t);)o=`${e}_${n}`,n+=1;return o},e}(e);super.registerGraph(t)}save(){const e=[];for(;this.isInSubgraph();)void 0===this._graph.graphNode?e.push({type:this.subgraphStackGraphTypeEnum.RELATEDGRAPH,frame:this._graph.id}):e.push({type:this.subgraphStackGraphTypeEnum.SUBGRAPH,frame:this._graph.graphNode}),this.backFromSubgraph();let t=this._graph.id,n=this.graph.save();n.panning=this._graph.panning,n.scaling=this._graph.scaling,void 0!==this.newRootGraph&&(t=this.newRootGraph.id,n=this.newRootGraph.save());const o={graphs:[]},i=e=>{void 0!==e.subgraph&&(o.graphs.push(e.graphState),e.graphState.nodes.forEach(i)),delete e.graphState};return n.nodes.forEach(i),this.nodeTypes.forEach(((e,t)=>{e.relatedGraphs?.forEach((({id:e})=>{const t=Array.from(this.graphs).find((t=>e===t.id));t&&!o.graphs.find((e=>e.id===t.id))&&o.graphs.push(t.save())}))})),n.nodes.forEach((e=>{e.color=this.getNodeColor(e)})),o.graphs.length&&(o.entryGraph=t),o.graphs=[n,...o.graphs],e.reverse().forEach((({frame:e,type:t})=>{switch(t){case this.subgraphStackGraphTypeEnum.RELATEDGRAPH:this.switchToRelatedGraph(e);break;case this.subgraphStackGraphTypeEnum.SUBGRAPH:this.switchToSubgraph(e)}})),o}deepCleanEditor(e=!0){this.subgraphStack.forEach(this.backFromSubgraph.bind(this)),this.cleanEditor(e),this.graphName=void 0}cleanEditor(e=!0){for(;this.isInSubgraph();)this.backFromSubgraph();const t=this._graph;(0,l.$4)(e);for(let e=t.connections.length-1;e>=0;e-=1)t.removeConnection(t.connections[e]);for(let e=t.nodes.length-1;e>=0;e-=1)t.removeNode(t.nodes[e]);(0,l.$4)(!1)}unregisterGraphs(){[...this.graphs].filter((e=>e.id!==this._graph.id)).forEach((e=>this.unregisterGraph(e))),this.subgraphStack=[]}unregisterNodes(){this.nodeTypes.forEach(((e,t)=>{this.unregisterNodeType(t)}))}registerNodeType(e,t){if(this.events.beforeRegisterNodeType.emit({type:e,options:t}).prevented)return;const n=new e;this._nodeTypes.set(n.type,{type:e,category:t?.category??"default",title:t?.title??n.title,isCategory:t?.isCategory??!1,color:t?.color,subgraphId:t?.subgraphId,relatedGraphs:t?.relatedGraphs,style:t?.style,pill:t?.pill}),this.events.registerNodeType.emit({type:e,options:t})}async load(e,t=!1,n=!1,i=null){this.unregisterGraphs(),h.ir.clearRegistry();const r=this.readonly;this.readonly=!0;const s=[];if(!e.graphs.length)return["No graphs found"];let l;if(e.entryGraph){if(l=e.graphs.find((t=>t.id===e.entryGraph)),!l)return[`No entry graph found of id '${e.entryGraph}'`]}else l=e.graphs[0];const{panning:d,scaling:c}=l,u=new Set;this.nodeColors.clear(),e.graphs.forEach((t=>{t.nodes.forEach((t=>{if(void 0!==t.subgraph){const n=e.graphs.filter((e=>e.id===t.subgraph));1!==n.length&&s.push([`Expected exactly one template with ID ${t.name}, got ${n.length}`]),u.has(t.subgraph)&&null===i&&s.push([`Subgraph ${t.subgraph} has multiple nodes pointing to it - only unique IDs are allowed`]),u.add(t.subgraph),[t.graphState]=n}t.relatedGraphs?.filter((({id:t})=>void 0===e.graphs.find((e=>e.id===t)))).forEach((({id:e})=>s.push([`The related graph of id ${e} is not defined`]))),this.setNodeColor(t.id,t.color)}))}));try{if(s.length)return s;if(e.graphs?.forEach((e=>{if(!u.has(e.id)&&l.id!==e.id){const t=new o.TS(this);s.push(...t.load(e)),this.registerGraph(t)}})),!s.length){let t;if(i){const e=new(this._nodeTypes.get(i).type),{state:n,errors:o}=e.prepareSubgraphInstance();s.push(...o),t=n}else e=this.hooks.load.execute(e),t=l;s.length||s.push(...this._graph.load(t))}}catch(e){return this.cleanEditor(),this.readonly=r,[e.toString()]}if(Array.isArray(s)&&s.length)return this.cleanEditor(),this.readonly=r,s;if(this.events.loaded.emit(),this.graphName=l.name,this.readonly=r,"undefined"==typeof window||n)return s;const p=(e,t)=>{if(void 0!==e?.nodes)for(let n=0;n<e.nodes.length;n+=1)if(void 0!==e.nodes[n].subgraph){if(e.nodes[n].subgraph.id===l.id)return[...t,e.nodes[n]];const o=p(e.nodes[n].subgraph,[...t,e.nodes[n]]);if(o.length)return o}return[]},v=p(this._graph,[]);try{v.forEach((e=>{this.switchToSubgraph(e)}))}catch(e){s.push(e.toString())}return"NoLayout"!==this.layoutManager.layoutEngine.activeAlgorithm&&(await(0,a.dY)(),await this.applyAutolayout(!1)),await(0,a.dY)(),void 0!==d&&(this._graph.panning=d),void 0!==c&&(this._graph.scaling=c),t||void 0!==c||void 0!==d||this.centerZoom(),s}privatizeInterface(e,t){if(void 0===t.externalName)return;let n=[...this.graphs].find((t=>t.id===e)),o=n.graphNode;if(t.externalName=void 0,void 0===o)return;const{graphIds:i,sharedInterface:a}=h.ir.getRegisteredInterface(t.id),r=i.findIndex((e=>e===o.graph.id));i.splice(r,i.length-r),o.updateExposedInterfaces(void 0,void 0,!0);for(let e=r+1;e<i.length;e+=1)n=[...this.graphs].find((e=>e.id===i[r])),o=n.graphNode,o.updateExposedInterfaces(void 0,void 0,!0);a===t&&h.ir.deleteRegisteredInterface(t.id)}exposeInterface(e,t,n=void 0){const o=[...this.graphs].find((t=>t.id===e)),i=o.graphNode;t.externalName=n??o.resolveNewExposedName(t.name),void 0!==i&&i.updateExposedInterfaces()}static editorSize(){if("undefined"==typeof document)throw new Error("The editor is in browserless mode. Cannot obtain editor size.");const e=document.getElementsByClassName("terminal-wrapper")[0]?.offsetHeight??0,t=document.getElementsByClassName("wrapper")[0]?.offsetHeight??0,n=document.getElementsByClassName("baklava-node-palette");let o=0;if(0!==n.length){const e=n[0].getBoundingClientRect();o=Math.max(e.right,0)}const i=window.innerHeight-e-t;return{editorWidth:window.innerWidth-o,editorHeight:i,sideBarWidth:o}}centerZoom(){if(!Array.isArray(this._graph.nodes)||0===this._graph.nodes.length)return;if("undefined"==typeof document)throw new Error("The editor is in browserless mode. Cannot obtain editor size.");const{editorWidth:e,editorHeight:t,sideBarWidth:n}=v.editorSize(),{graphHeight:o,graphWidth:i,leftmostX:a,topmostY:r}=this._graph.size(),s=100,l=t/(o+200),d=e/(i+200);if(d>l){const t=e/2*(1/l)-(i+200)/2;this._graph.panning={x:-(a-s-t-n/l),y:-(r-s)},this._graph.scaling=l}else{const e=t/2*(1/d)-(o+200)/2;this._graph.panning={x:-(a-s-n/d),y:-(r-s-e)},this._graph.scaling=d}}nodeURLsEmpty(){return 0===this.nodeURLs.size}getNodeURLs(e){const t=this.nodeURLs.get(e)||{},n=[];return Object.entries(t).forEach((([e,t])=>{const o={...this.baseURLs.get(e)};o.url+=t,n.push(o)})),n}getNodeIconPath(e){return this.nodeIcons.get(e)||void 0}getPillText(e){const t=this.nodeTypes.get(e);return void 0!==t?.pill?t.pill?.text:void 0!==t?.style?this.getNodeStyle(t.style)?.pill?.text:void 0}getNodeCategory(e){return this.nodeTypes.get(e).category||void 0}getNodeColor(e){const t=this.nodeColors.get(e.id);if(void 0!==t)return t;const n=this.nodeTypes.get(e.type);return void 0!==n?.color?n.color:void 0!==n?.style?this.getNodeStyle(n.style)?.color:void 0}setNodeColor(e,t){void 0!==t&&this.nodeColors.set(e,t)}getStyleIcon(e){const t=this.nodeTypes.get(e);if(void 0!==t?.style)return this.getNodeStyle(t.style)?.icon}getNodeStyle(e){return Array.isArray(e)||(e=[e]),Object.assign({},...e.map((e=>this.nodeStyles.get(e))).filter((e=>void 0!==e)))}getPillColor(e){const t=this.nodeTypes.get(e),n=void 0!==t?.pill?t.pill:this.getNodeStyle(t.style).pill;if(void 0!==n)return n.color??"#ffffff"}getTextColor(e){if(!e)return"white";const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=parseInt(t[1],16)/255,o=parseInt(t[2],16)/255,i=parseInt(t[3],16)/255;return(Math.max(n,o,i)+Math.min(n,o,i))/2>.5?"black":"white"}isGraphNode(e){return!!this.nodeTypes.has(e)&&void 0!==this.nodeTypes.get(e).subgraphId}nodeHasRelatedGraphs(e){return void 0!==(e.relatedGraphs??this.nodeTypes.get(e.type)?.relatedGraphs)}addGraphTemplate(e,t){if(this.events.beforeAddGraphTemplate.emit(e).prevented)return;this._graphTemplates.push(e),this.graphTemplateEvents.addTarget(e.events),this.graphTemplateHooks.addTarget(e.hooks);const n=function(e,t){const[n,i]=function(e){const t=e.interfaces??[],n=(0,u.Cy)(t,[],[]);return Array.isArray(n)&&n.length?n.map((t=>`Node ${e.name} invalid. ${t}`)):(0,p.j4)(n)}(t),a=function(e){const t=e.properties??[],n=(0,p.$9)(t);return Array.isArray(n)&&n.length?n.map((t=>`Node ${e.name} invalid. ${t}`)):(0,p.eC)(n)}(t),s={...n,...a};return class extends p.y5{type=t.name;title=t.name;template=e;nodeInterfaces={...s,...i};constructor(){super(t.name,t.layer,s,i,t.twoColumn??!1,t.description??"",t.extends??[],t.extending??[],t.siblings??[],t.width??300,t.relatedGraphs)}save(){const e=super.save();return e.subgraph=this.subgraph.id,e.graphState=this.subgraph.save(),e}load(e){this.hooks.beforeLoad.execute(e);const t=(0,u.Cy)(e.interfaces??[],[],[]);if(Array.isArray(t)&&t.length)return t;let{inputs:n,outputs:o}=t;if(n=Object.values(n),o=Object.values(o),void 0!==e.graphState){delete e.graphState.interfaces,delete e.subgraph;const t=this.subgraph.load(e.graphState);if(t.length)return t}return this.updateExposedInterfaces(n,o),this.position=e.position,this.title=e.instanceName??"",super.load(e),this.events.loaded.emit(this),[]}updateExposedInterfaces(e=void 0,t=void 0,n=!1){const o=(0,p.Sx)(this.subgraph.nodes,e??Object.values(this.inputs),t??Object.values(this.outputs));if(Array.isArray(o)&&o.length)throw new Error(`Internal error occurred while exposing an interface.\nReason: ${o.join(". ")}`);this.updateInterfaces(o.inputs,o.outputs,n)}onPlaced(e,t){this.initialize(e,t)}initialize(e,t){this.subgraph&&this.subgraph.destroy();const n=new o.TS(this.template.editor),{state:i,errors:a}=this.prepareSubgraphInstance(e,t);if(a.length||a.push(...n.load(i)),a.length)throw new Error(`Internal error occurred while initializing ${n.type} graph. Reason: ${a.join(". ")}`);n.template=this.template,this.subgraph=n,n.graphNode=this,this.updateExposedInterfaces([],[]),this._title=this.template.name,this.events.update.emit(null)}privatizeInterfaces(e,t){Object.entries(t).forEach((([t,n])=>{if(void 0===e.find((e=>e.id===n.id))&&!Object.keys(this.nodeInterfaces).some((e=>e===t))){const e="output"===n.direction?"output":"input";this.removeInterface(e,t)}}))}updateInterfaces(e,t,n=!1){const i=[...e,...t],a={...this.inputs,...this.outputs};n&&this.privatizeInterfaces(i,a),i.forEach((e=>{const t=Object.values(a).find((t=>t.id===e.id));if(void 0===t){const t=new o.gZ(e.name);Object.assign(t,e),h.ir.pushGraphIdToRegistry(t.id,this.subgraph.id),h.ir.createSharedInterface(t);const n="output"===e.direction?"output":"input";this.addInterface(n,`${e.direction}_${e.name}`,t)}else Object.assign(t,e)})),Object.values(a).forEach((e=>{(0,d.q6)(this,e,e.side,void 0,!1,!1)}))}prepareSubgraphInstance(e,t){const n=[];if(this.template.nodes.some((e=>void 0!==e.subgraph&&void 0===e.id))&&n.push("Node defining a nested graph in a subgraph template should have their own ID"),n.length)return{errors:n};const o=void 0===e;e??={newToSpecNodeIds:new Map,newInterfaceIds:new Map};const{newToSpecNodeIds:i}=e,a=i.get(t),s=e=>{const t=(0,r.A)();return void 0!==e.subgraph&&i.set(t,e.id),t},l=this.template.connections.map((e=>({...e,id:(0,r.A)()}))),{newInterfaceIds:d}=e,c=(e,t,n=r.A)=>(e.has(t)||e.set(t,n()),e.get(t)),u=(e,t)=>{const n=((e,t)=>{const n=void 0!==e.subgraph?e.id:a,i=c(d,n,(()=>new Map)),s=void 0===e.subgraph&&void 0===t.externalName,l=!(o||void 0===t.externalName||void 0!==a&&i.has(t.externalName));return s||l?(0,r.A)():c(i,t.externalName??t.name)})(t,Object.values(t.inputs).concat(Object.values(t.outputs)).find((t=>t.id===e)));return l.filter((t=>t.from===e)).forEach((e=>{e.from=n})),l.filter((t=>t.to===e)).forEach((e=>{e.to=n})),n},p=(e,t)=>({...e,id:u(e.id,t)}),h=(e,t)=>Object.entries(e).reduce(((e,[n,o])=>({...e,[n]:p(o,t)})),{});return{state:{id:(0,r.A)(),nodes:this.template.nodes.map((e=>({...e,inputs:h(e.inputs,e),outputs:h(e.outputs,e)}))).map((e=>({...e,id:s(e)}))),connections:l,graphLoadingState:e},errors:n}}}}(e,t);this.registerNodeType(n,{category:t.category,title:t.title,isCategory:t.isCategory,color:t.color,style:t.style,pill:t.pill,subgraphId:t.subgraphId,relatedGraphs:t?.relatedGraphs}),this.events.addGraphTemplate.emit(e)}switchGraph(e){if(void 0===this._switchGraph){const{switchGraph:e}=(0,i.uU)();this._switchGraph=e}if((0,l.$4)(!0),void 0===e.subgraph)throw Error(`Node "${e.name}" does contain a subgraph.`);this._graph=e.subgraph,this._switchGraph(e.subgraph),this.graphName=this._graph.name,(0,l.$4)(!1),(0,a.dY)().then((()=>{const e=this.graph.save();this.layoutManager.registerGraph(e),this.layoutManager.computeLayout(e).then(this.updateNodesPosition.bind(this)).then((()=>{(0,a.dY)().then((()=>{this._graph.wasCentered||(this.centerZoom(),this._graph.wasCentered=!0)}))}))}))}switchToSubgraph(e){e&&e.subgraph&&(this.subgraphStack.push(e.graph),this.switchGraph(e))}switchToGraph(e,t=!1){if(e){if(void 0===this._switchGraph){const{switchGraph:e}=(0,i.uU)();this._switchGraph=e}(0,l.$4)(!0),t?this.subgraphStack.push(this._graph):this.subgraphStack.length>0&&this.subgraphStack.pop(),this._graph=e,this._switchGraph(this._graph),this.graphName=this._graph.name,(0,a.dY)().then((()=>{const e=this.graph.save();this.layoutManager.registerGraph(e),this.layoutManager.computeLayout(e).then(this.updateNodesPosition.bind(this)).then((()=>{(0,a.dY)().then((()=>{this._graph.wasCentered||(this.centerZoom(),this._graph.wasCentered=!0)}))}))})),(0,l.$4)(!1)}}switchToRelatedGraph(e){const t=Array.from(this.graphs).find((t=>t.id===e));this.switchToGraph(t,!0)}backFromSubgraph(){const e=this.subgraphStack.pop();(0,l.$4)(!0),this._graph=e,this._switchGraph(this._graph),this.graphName=this._graph.name,(0,l.$4)(!1)}changeTopLevelGraph(e){const t=Array.from(this.graphs).find((t=>t.id===e));this.newRootGraph=t}findInterface(e){for(let t=0;t<this.graph.nodes.length;t+=1){const n=Object.values(this.graph.nodes[t].inputs).concat(Object.values(this.graph.nodes[t].outputs)).find((t=>t.id===e));if(n)return n}return null}unwrapSubgraph(e){const t=Object.values(e.subgraph._nodes),n=t.map((e=>e.position.x)).reduce(((e,t)=>e+t),0)/t.length,o=t.map((e=>e.position.y)).reduce(((e,t)=>e+t),0)/t.length;this.graph.selectedNodes=[],t.forEach((t=>{const i=t.save(),a=this.graph.addNode(t);a&&(a.position.x+=e.position.x-n,a.position.y+=e.position.y-o,this.graph.selectedNodes.push(a),Object.values(a.inputs).concat(Object.values(a.outputs)).forEach((e=>{e.connectionCount=0})),a.load(i))}));const i=this.graph.connections.filter((t=>t.from.nodeId===e.id||t.to.nodeId===e.id));this.graph.removeNode(e),Object.values(e.subgraph.connections).concat(i).forEach((t=>{if("Connection"===t.from.name||"Connection"===t.to.name)return;const i=this.findInterface(t.from.id),a=this.findInterface(t.to.id);if(i&&a){const r=this.graph.addConnection(i,a);(t.anchors??[]).forEach(((i,a)=>{let s;s=e.subgraph.connections.includes(t)?{x:i.x+e.position.x-n,y:i.y+e.position.y-o}:{x:i.x,y:i.y},this.graph.addAnchor(s,r,a)}))}}))}isInSubgraph(){return this.subgraphStack.length>0}async applyAutolayout(e=!0){const t=this.graph.save();e&&t.nodes.forEach((e=>{e.position=void 0})),this.layoutManager.registerGraph(t);const n=await this.layoutManager.computeLayout(t);this.updateNodesPosition(n)}updateNodesPosition(e){e.nodes.forEach((e=>{this.graph.nodes.filter((t=>e.id===t.id))[0].position=e.position}))}updateCurrentSubgraphName(e){this._graph.name=e}}},38601:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(20641),i=n(90033),a=n(53751);const r=["id"],s={key:2};var l=n(50953),d=n(63491),c=n(22007),u=n(41426),p=n(14121);const h=(0,o.pM)({extends:d.XF.NodeInterface,props:{highlighted:Boolean,picked:Boolean,switchSides:{},toggleGroup:{default:()=>{},required:!1},updateDynamicInterfaces:{default:()=>{},required:!1},tabindexValue:{default:-1,required:!1}},components:{Arrow:c.A},setup(e){const{el:t,isConnected:n,showComponent:i,startHover:a,endHover:r,openSidebar:s}=d.XF.NodeInterface.setup(e),{viewModel:c}=(0,d.if)(),{graph:h}=(0,d.uU)();e.intf.events.beforeSetValue.unsubscribe(e.intf),e.intf.events.beforeSetValue.subscribe(e.intf,((t,n)=>{c.value.editor.readonly&&n(),(void 0!==e.intf.min&&t<e.intf.min||void 0!==e.intf.max&&t>e.intf.max)&&n()})),e.intf.group&&(e.toggleGroup(e.intf),e.intf.events.setValue.unsubscribe(e.intf),e.intf.events.setValue.subscribe(e.intf,(()=>e.toggleGroup(e.intf)))),e.intf.name.endsWith(p.Yg)&&(e.updateDynamicInterfaces(e.intf),e.intf.events.setValue.unsubscribe(e.intf),e.intf.events.setValue.subscribe(e.intf,(()=>e.updateDynamicInterfaces(e.intf))));const v=(0,l.KR)(!1),f=(0,u.A)(700,(()=>{c.value.editor.readonly||(e.switchSides(e.intf),r())})),g=e.intf.port&&"inout"!==e.intf.direction,m=(0,o.EW)((()=>{if("input"===e.intf.direction){if("left"===e.intf.side)return"right";if("right"===e.intf.side)return"down"}if("output"===e.intf.direction){if("left"===e.intf.side)return"down";if("right"===e.intf.side)return"right"}return"down"})),y=(0,o.EW)((()=>({"--input":"left"===e.intf.side,"--output":"right"===e.intf.side,"--connected":n.value,__readonly:c.value.editor.readonly}))),b=(0,o.EW)((()=>void 0!==e.intf.externalName));new d.lo("External name",e.intf.externalName).setPort(!1).componentName="TextInterface";const E=(0,l.KR)(!1),w=(0,l.KR)(!1),_=(0,l.KR)(null),C=[],k=(0,l.KR)(e.intf.externalName);return{arrowRotation:m,displayArrow:g,editExternalName:E,el:t,enableExternalNameEdit:t=>{C.splice(0,C.length),C.push(...h.value.obtainExposedNames()),C.splice(C.indexOf(e.intf.externalName),1),E.value=!0,t.preventDefault(),(0,o.dY)().then((()=>{_.value.focus(),_.value.select(),w.value=h.value.isIncorrectExternalName(e.intf.externalName,C)}))},endHover:r,endHoverWrapper:()=>{v.value=!1,c.value.editor.readonly||r()},externalNameInput:_,externalNameInputIncorrect:w,externalNameInputCallback:e=>{w.value=h.value.isIncorrectExternalName(e.target.value,C)},externalNameFocusOutCallback:()=>{E.value=!1,w.value=!1;const t=h.value.resolveNewExposedName(k.value);k.value=t,c.value.editor.exposeInterface(h.value.id,e.intf,t)},hovered:v,isConnected:n,inputExternalName:k,newClasses:y,onMouseDown:f,openSidebar:s,showComponent:i,isExposed:b,startHover:a,startHoverWrapper:()=>{v.value=!0,c.value.editor.readonly||a()}}}}),v=(0,n(66262).A)(h,[["render",function(e,t,n,l,d,c){const u=(0,o.g2)("Arrow");return(0,o.uX)(),(0,o.CE)("div",{id:e.intf.id,ref:"el",class:(0,i.C4)(["baklava-node-interface",e.newClasses])},[e.intf.port?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,i.C4)(["__port",{greyedout_arrow:e.highlighted,picked:e.picked,__square:e.isExposed}]),onMouseenter:t[8]||(t[8]=(...t)=>e.startHoverWrapper&&e.startHoverWrapper(...t)),onMouseleave:t[9]||(t[9]=(...t)=>e.endHoverWrapper&&e.endHoverWrapper(...t)),onPointerdown:t[10]||(t[10]=(0,a.D$)(((...t)=>e.onMouseDown&&e.onMouseDown(...t)),["left"]))},[e.isExposed&&(e.hovered||e.editExternalName)?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,i.C4)({__port_name_left:"left"===e.intf.side,__port_name_right:"right"===e.intf.side})},[e.editExternalName?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=t=>e.inputExternalName=t),ref:"externalNameInput",type:"text",spellcheck:"false",autocomplete:"off",class:(0,i.C4)(["__port_input",{__error:e.externalNameInputIncorrect}]),placeholder:"External name",onFocusout:t[1]||(t[1]=(...t)=>e.externalNameFocusOutCallback&&e.externalNameFocusOutCallback(...t)),onKeydown:[t[2]||(t[2]=(0,a.jR)((0,a.D$)((e=>{e.target.blur()}),["exact","stop"]),["enter"])),t[5]||(t[5]=(0,a.D$)((e=>e.stopPropagation()),["ctrl","stop"]))],onInput:t[3]||(t[3]=(...t)=>e.externalNameInputCallback&&e.externalNameInputCallback(...t)),onPointerdown:t[4]||(t[4]=(0,a.D$)((e=>e.stopPropagation()),["left","stop"]))},null,34)),[[a.Jo,e.inputExternalName]]):((0,o.uX)(),(0,o.CE)("span",{key:1,onPointerdown:t[6]||(t[6]=(0,a.D$)(((...t)=>e.enableExternalNameEdit&&e.enableExternalNameEdit(...t)),["left","stop"])),onKeydown:t[7]||(t[7]=(0,a.D$)((()=>{}),["stop"]))},(0,i.v_)(e.intf.externalName),33))],2)):(0,o.Q3)("",!0),e.displayArrow?((0,o.uX)(),(0,o.Wv)(u,{key:1,noninteractable:!0,color:"black",scale:"big",rotate:e.arrowRotation},null,8,["rotate"])):(0,o.Q3)("",!0)],34)):(0,o.Q3)("",!0),e.showComponent?((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.intf.component),{key:1,modelValue:e.intf.value,"onUpdate:modelValue":t[11]||(t[11]=t=>e.intf.value=t),node:e.node,intf:e.intf,onKeydown:t[12]||(t[12]=(0,a.D$)((()=>{}),["stop"])),tabindex:e.tabindexValue},null,40,["modelValue","node","intf","tabindex"])):((0,o.uX)(),(0,o.CE)("span",s,(0,i.v_)(e.intf.name),1))],10,r)}]])},53701:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(20641),i=n(53751),a=n(90033);const r={ref:"el"},s=["href"],l={class:"link_item"},d=["src"];var c=n(50953),u=n(63491);const p=(0,o.pM)({props:{node:{required:!0}},setup(e){const t=(0,c.KR)(null),{viewModel:n}=(0,u.if)();return{el:t,getIconPath:e=>n.value.cache[`./${e}`]??e,nodeRef:(0,c.KR)(e.node)}}}),h=(0,n(66262).A)(p,[["render",function(e,t,n,c,u,p){return(0,o.uX)(),(0,o.Wv)(i.eB,{name:"slide-fade"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.nodeRef.URLs,(n=>((0,o.uX)(),(0,o.CE)("a",{key:n.name,href:n.url,class:"__url",target:"_blank",draggable:"false",onPointerdown:t[0]||(t[0]=(0,i.D$)((()=>{}),["left","stop"]))},[(0,o.Lk)("div",l,[void 0!==n.icon?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.getIconPath(n.icon),draggable:"false"},null,8,d)):(0,o.Q3)("",!0),(0,o.Lk)("span",null,(0,a.v_)(n.name),1),t[1]||(t[1]=(0,o.Lk)("br",null,null,-1))])],40,s)))),128))],512)])),_:1})}],["__scopeId","data-v-28f02260"]])},75374:(e,t,n)=>{n.d(t,{A:()=>H});var o=n(20641),i=n(53751),a=n(90033);const r={key:0,class:"__content"},s={class:"__header"},l=["src"],d={class:"__node-name"},c=["href","onPointerover"],u=["src","alt"],p={key:0,class:"__id"},h={class:"__value"},v={key:0,class:"__title"},f={key:1,class:"__value"},g={class:"__category"},m={class:"__category-name"},y={key:1,class:"__replace"},b={key:0,class:"__replace_entry"},E={key:1,class:"__replace_entry"},w={key:2,class:"__replace_entry"},_={key:2,class:"__properties"},C={class:"__property-name"},k={class:"__markdown-content"},N=["innerHTML"],A={key:3,class:"__interface_groups"},x={class:"__group-assign"},I={class:"__error_outputs"};var S=n(50953),P=n(63491),L=n(41552),T=n.n(L),R=n(38601),W=n(1691),M=n(3972),O=n(34580),$=n(14121),G=n(96422),D=n(72208);const X=(0,o.pM)({components:{Cross:W.A,CustomInterface:R.A,CheckboxInterface:P.b,NodeSpecificationEditor:D.A,Tooltip:M.A},emits:["sidebar-open"],setup(e,{emit:t}){const n=O.Ay.getEditorManagerInstance(),i=(0,o.EW)((()=>n.baklavaView)),a=(0,o.EW)((()=>i.value.displayedGraph)),r=new(T().Converter)({smartIndentationFix:!0,simpleLineBreaks:!0}),s=(0,S.KR)(300),l=(0,o.EW)((()=>{const e=a.value.sidebar.nodeId;return a.value.nodes.find((t=>t.id===e))})),d=(0,o.EW)((()=>a.value.editor.nodeTypes.get(l.value.type).category)),c=(0,o.EW)((()=>`${d.value.split("/").join(" / ")}`)),u=(0,o.EW)((()=>a.value.editor.nodeTypes.get(l.value.type).subgraphId)),p=(0,o.EW)((()=>{let e=r.makeHtml(l.value?.description??"");return e.match(/<a href="[a-zA-Z0-9-$_.+!*'()/&?=:%]+">/gm)?.forEach((t=>{const n=t.split('"'),o=` tabindex="-1" target="_blank"${n[2]}`,i=[n[0],n[1],o].join('"');e=e.replace(t,i)})),e})),h=(0,o.EW)((()=>i.value.editor.getNodeIconPath(l.value?.type))),v=(0,o.EW)((()=>i.value.editor.getNodeURLs(l.value?.type))),f=e=>i.value.cache[`./${e}`]??e,g=(0,o.EW)((()=>f(h.value))),m=(0,o.EW)((()=>a.value.sidebar.visible));(0,o.wB)(l,(()=>{void 0===l.value&&(a.value.sidebar.visible=!1)})),(0,o.wB)(m,(e=>{e&&t("sidebar-open")}));const y=(0,S.KR)(null),b=(0,S.KR)(null),E=(0,S.KR)(null);b.value={top:0,left:0,visible:!1,text:""};const w=(0,o.EW)((()=>({width:`${s.value}px`}))),_=e=>{e.preventDefault(),s.value-=e.movementX},C=(0,o.EW)((()=>Object.values(l.value.inputs).filter((e=>!e.port)))),k=(0,o.EW)((()=>Object.values({...l.value.inputs,...l.value.outputs}).filter((e=>void 0!==e.interfaces)))),N=(0,S.KR)(""),A=(0,o.EW)((()=>({"--disabled":""!==N.value}))),x=(0,o.EW)((()=>{const e=(0,S.KR)([]);return a.value.sidebar.visible,k.value.forEach((t=>{const n=new P.b(t.name,!t.hidden).setPort(!1);n.events.setValue.subscribe(this,(()=>{const e=(0,$.Sb)(I.value,l.value.inputs,l.value.outputs);e.length?N.value=e.map((([e,t,n])=>`Reused ${t} - ${e} for interface group ${n}`)):N.value=""})),n.componentName="CheckboxInterface",n.intfG=t,e.value.push(n)})),e.value})),I=(0,o.EW)((()=>{const e=[];return x.value.forEach((t=>{t.value&&e.push(`${t.intfG.direction}_${t.intfG.name}`)})),e})),L=(0,o.EW)((()=>{const e=new P.aw("Assign",(()=>{x.value.forEach((e=>{l.value.toggleInterfaceGroup(e.intfG,e.value)})),N.value=""}));return e.componentName="ButtonInterface",e})),R=e=>{const t=(0,S.KR)([]);return(e??[]).forEach((e=>{const n=new P.aw(e,(()=>{const t=a.value.replaceNode(l.value,e);a.value.sidebar.nodeId=t.id}));n.componentName="ButtonInterface",t.value.push(n)})),t.value},W=(0,o.EW)((()=>{const e=new Set;return(l.value.extends??[]).forEach((t=>{const o=n.baklavaView.editor.parentNodes.get(t);void 0!==o&&o.extending?.forEach((t=>e.add(t)))})),e.delete(l.value.type),Array.from(e)})),M=(0,o.EW)((()=>R(l.value.extends))),D=(0,o.EW)((()=>R(l.value.extending))),X=(0,o.EW)((()=>R(W.value))),H=(0,o.EW)((()=>""===l.value.title||void 0===l.value.title?l.value.type:l.value.title));return{graph:a,node:l,styles:w,startResize:()=>{s.value=E.value.offsetWidth,window.addEventListener("mousemove",_),window.addEventListener("mouseup",(e=>{e.preventDefault(),window.removeEventListener("mousemove",_)}),{once:!0})},close:()=>{a.value.sidebar.visible=!1},displayedProperties:C,interfaceGroups:k,interfaceGroupsCheckboxes:x,interfaceGroupsButton:L,interfaceGroupsOutput:N,interfaceGroupsButtonClasses:A,nodeIconPath:g,nodeURLs:v,getIconPath:f,desc:p,tooltip:b,onPointerOver:(e,t)=>{b.value.text=e,b.value.visible=!0,(0,o.dY)().then((()=>{const e=t.clientX-t.offsetX+t.currentTarget.offsetWidth/2+y.value.$el.clientWidth;b.value.top=t.clientY-t.offsetY+t.currentTarget.offsetHeight,e>window.innerWidth?b.value.left=t.clientX-t.offsetX+t.currentTarget.offsetWidth/2-y.value.$el.clientWidth/2:b.value.left=t.clientX-t.offsetX+t.currentTarget.offsetWidth/2}))},onPointerLeave:()=>{b.value.visible=!1},tooltipRef:y,sidebarRef:E,toggleGroup:e=>{e.group.forEach((t=>{l.value.inputs[t].hidden=!e.value}))},getOptionName:G.BW,prettyCategory:c,replacementParents:M,replacementChildren:D,replacementSiblings:X,editorManager:n,displayedName:H,updateDynamicInterfaces:e=>{l.value.updateDynamicInterfaces(e)},subgraphId:u}}}),H=(0,n(66262).A)(X,[["render",function(e,t,n,S,P,L){const T=(0,o.g2)("Tooltip"),R=(0,o.g2)("Cross"),W=(0,o.g2)("CustomInterface"),M=(0,o.g2)("NodeSpecificationEditor");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bo)((0,o.bF)(T,{ref:"tooltipRef",left:e.tooltip.left,top:e.tooltip.top,text:e.tooltip.text},null,8,["left","top","text"]),[[i.aG,e.tooltip.visible]]),(0,o.Lk)("div",{class:(0,a.C4)(["baklava-sidebar prevent-select",{"--open":e.graph.sidebar.visible,"--hidehud":e.editorManager.editor.hideHud,"--preview":e.editorManager.editor.preview,"hidden-navbar":e.$isMobile}]),ref:"sidebarRef",style:(0,a.Tr)(e.styles)},[(0,o.Lk)("div",{class:"__resizer",onMousedown:t[0]||(t[0]=(...t)=>e.startResize&&e.startResize(...t))},null,32),e.node?((0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",s,[(0,o.bF)(R,{tabindex:"-1",class:"__close",onClick:e.close},null,8,["onClick"]),void 0!==e.nodeIconPath?((0,o.uX)(),(0,o.CE)("img",{key:0,class:"__node-icon",src:e.nodeIconPath},null,8,l)):(0,o.Q3)("",!0),(0,o.Lk)("div",d,(0,a.v_)(e.displayedName),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.nodeURLs,(n=>((0,o.uX)(),(0,o.CE)("a",{key:n.name,href:n.url,class:"__url",target:"_blank",draggable:"false",onPointerover:t=>e.onPointerOver(n.name,t),onPointerleave:t[1]||(t[1]=(...t)=>e.onPointerLeave&&e.onPointerLeave(...t)),tabindex:"-1"},[void 0!==n.icon?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.getIconPath(n.icon),alt:n.name,draggable:"false"},null,8,u)):(0,o.Q3)("",!0)],40,c)))),128))]),e.editorManager.baklavaView.settings.showIds?((0,o.uX)(),(0,o.CE)("div",p,[t[2]||(t[2]=(0,o.Lk)("div",{class:"__title"},"Node ID",-1)),(0,o.Lk)("div",h,(0,a.v_)(e.node.id),1),e.subgraphId?((0,o.uX)(),(0,o.CE)("div",v,"Subgraph ID")):(0,o.Q3)("",!0),e.subgraphId?((0,o.uX)(),(0,o.CE)("div",f,(0,a.v_)(e.subgraphId),1)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("div",g,[t[3]||(t[3]=(0,o.Lk)("div",{class:"__title"},"Category",-1)),(0,o.Lk)("div",m,(0,a.v_)(e.prettyCategory),1)],512),[[i.aG,e.prettyCategory]]),e.editorManager.editor.readonly?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",y,[e.replacementParents.length?((0,o.uX)(),(0,o.CE)("div",b,[t[4]||(t[4]=(0,o.Lk)("div",{class:"__replace_title"},"Generalize:",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.replacementParents,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"__replace_button"},[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.component),{intf:e,tabindex:"-1"},null,8,["intf"]))])))),128))])):(0,o.Q3)("",!0),e.replacementChildren.length?((0,o.uX)(),(0,o.CE)("div",E,[t[5]||(t[5]=(0,o.Lk)("div",{class:"__replace_title"},"Specialize:",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.replacementChildren,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"__replace_button"},[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.component),{intf:e,tabindex:"-1"},null,8,["intf"]))])))),128))])):(0,o.Q3)("",!0),e.replacementSiblings.length?((0,o.uX)(),(0,o.CE)("div",w,[t[6]||(t[6]=(0,o.Lk)("div",{class:"__replace_title"},"Choose other type:",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.replacementSiblings,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e,class:"__replace_button"},[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.component),{intf:e,tabindex:"-1"},null,8,["intf"]))])))),128))])):(0,o.Q3)("",!0)])),e.displayedProperties.length?((0,o.uX)(),(0,o.CE)("div",_,[t[7]||(t[7]=(0,o.Lk)("div",{class:"__title"},"Properties",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.displayedProperties,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"__property"},[(0,o.Lk)("div",C,(0,a.v_)(e.getOptionName(t.componentName)?`${t.name}:`:""),1),(0,o.bF)(W,{node:e.node,intf:t,toggleGroup:e.toggleGroup,updateDynamicInterfaces:e.updateDynamicInterfaces,tabindex:"-1"},null,8,["node","intf","toggleGroup","updateDynamicInterfaces"])])))),128))])):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("div",null,[t[8]||(t[8]=(0,o.Lk)("div",{class:"__title"}," Description ",-1)),(0,o.Lk)("div",k,[(0,o.Lk)("span",{innerHTML:e.desc,class:"node_description"},null,8,N)])],512),[[i.aG,e.desc]]),e.interfaceGroupsCheckboxes.length>0&&!e.editorManager.editor.readonly?((0,o.uX)(),(0,o.CE)("div",A,[t[9]||(t[9]=(0,o.Lk)("div",{class:"__title"},"Interface Groups",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.interfaceGroupsCheckboxes,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"__group"},[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.component),{intf:e},null,8,["intf"]))])))),128)),(0,o.Lk)("div",x,[((0,o.uX)(),(0,o.Wv)((0,o.$y)(e.interfaceGroupsButton.component),{intf:e.interfaceGroupsButton,class:(0,a.C4)(e.interfaceGroupsButtonClasses),tabindex:"-1"},null,8,["intf","class"]))])])):(0,o.Q3)("",!0),(0,o.bo)((0,o.Lk)("div",I,[t[10]||(t[10]=(0,o.Lk)("div",{class:"__title"},"Conflicts:",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.interfaceGroupsOutput,(e=>((0,o.uX)(),(0,o.CE)("p",null,(0,a.v_)(e),1)))),256))],512),[[i.aG,e.interfaceGroupsOutput.length]]),(0,o.bF)(M,{node:e.node,scrollHandle:e.sidebarRef},null,8,["node","scrollHandle"])])):(0,o.Q3)("",!0)],6)],64)}],["__scopeId","data-v-0792ce83"]])},96422:(e,t,n)=>{n.d(t,{BW:()=>i,bf:()=>r,q6:()=>a});var o=n(63491);function i(e){switch(e){case"InputInterface":case"TextAreaInterface":case"SelectInterface":case"ListInterface":case"TextInterface":case"HexInterface":return!0;default:return!1}}function a(e,t,n,i=void 0,a=!1,r=!0){if(r){const{graph:t}=(0,o.uU)();t.value.editNode(e)}const s=t.sidePosition;t.side=n,void 0!==i&&(t.sidePosition=i);const l=[...Object.values(e.inputs),...Object.values(e.outputs)].find((e=>e.id!==t.id&&e.sidePosition===t.sidePosition&&e.side===t.side));if(void 0!==l)if(void 0!==i&&a)l.sidePosition=s;else{const n=void 0===i?t:l,o=[...Object.values(e.inputs),...Object.values(e.outputs)].filter((e=>e.side===n.side&&!e.hidden)).map((e=>e.sidePosition));let a=0;for(;o.includes(a);)a+=1;n.sidePosition=a}}function r(e,t=!1){const{viewModel:n}=(0,o.if)();if(n.value.editor.isGraphNode(e.type)&&t)n.value.editor.unwrapSubgraph(e);else{const{graph:t}=(0,o.uU)();t.value.removeNode(e)}}},99064:(e,t,n)=>{n.d(t,{A:()=>de});var o=n(20641),i=n(90033),a=n(53751);const r={class:"selection-container"};var s=n(63491),l=n(50953),d=n(15531),c=n.n(d),u=n(34250),p=n(13773),h=n(92125),v=n(46171),f=n(42838),g=n.n(f),m=n(5828),y=n(38601);const b={key:0,class:"readonly item",style:{cursor:"default"}},E=["onClick"],w={class:"icon"},_={class:"text"},C=["href","onClick"],k={class:"icon"},N=["src","alt"],A={class:"text"},x=(0,o.pM)({extends:s.XF.ContextMenu,props:{urls:{required:!1,default:[]}},emits:["update:modelValue","click","sizeUpdate"],setup(e,t){const{el:n,styles:i,classes:a,itemsWithHoverProperty:r}=s.XF.ContextMenu.setup(e,t),{viewModel:d}=(0,s.if)(),c=(0,l.KR)(!0);(0,o.sV)((async()=>{await(0,o.dY)();const e=n.value.getBoundingClientRect();t.emit("sizeUpdate",e)}));const u=o=>{!0===e.modelValue&&(!1===c.value?(document.elementsFromPoint(o.clientX,o.clientY).includes(n.value)||(window.removeEventListener("wheel",u),window.removeEventListener("pointerdown",u),t.emit("update:modelValue",!1)),c.value=!0):c.value=!1)};return window.addEventListener("wheel",u),window.addEventListener("pointerdown",u),{el:n,styles:i,classes:a,itemsWithHoverProperty:r,onClick:e=>{t.emit("click",e.value),t.emit("update:modelValue",!1)},getIconPath:e=>d.value.cache[`./${e}`]??e}}});var I=n(66262);const S=(0,I.A)(x,[["render",function(e,t,n,r,s,l){return(0,o.uX)(),(0,o.Wv)(a.eB,{name:"slide-fade"},{default:(0,o.k6)((()=>[(0,o.bo)((0,o.Lk)("div",{ref:"el",class:(0,i.C4)(["baklava-context-menu",e.classes]),style:(0,i.Tr)(e.styles)},[0===e.itemsWithHoverProperty.length?((0,o.uX)(),(0,o.CE)("div",b,t[0]||(t[0]=[(0,o.Lk)("div",{class:"text"},[(0,o.Lk)("i",null,"No resources")],-1)]))):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.itemsWithHoverProperty,((t,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[void 0===t.url?((0,o.uX)(),(0,o.CE)("div",{key:`i-${n}`,class:(0,i.C4)(["item",{submenu:!!t.submenu,"--disabled":!!t.disabled}]),onClick:(0,a.D$)((n=>e.onClick(t)),["stop"])},[(0,o.Lk)("div",w,[void 0!==t.icon?((0,o.uX)(),(0,o.Wv)((0,o.$y)(t.icon),{key:0})):(0,o.Q3)("",!0)]),(0,o.Lk)("div",_,(0,i.v_)(t.label),1)],10,E)):((0,o.uX)(),(0,o.CE)("a",{key:t.name,href:t.url,class:"item",target:"_blank",draggable:"false",onClick:(0,a.D$)((n=>e.onClick(t)),["stop"])},[(0,o.Lk)("div",k,[void 0!==e.getIconPath(t.icon)?((0,o.uX)(),(0,o.CE)("img",{key:0,src:e.getIconPath(t.icon),alt:t.name,draggable:"false"},null,8,N)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",A,(0,i.v_)(t.name),1)],8,C)),t.endSection?((0,o.uX)(),(0,o.CE)("hr",{key:`hr-${n}`})):(0,o.Q3)("",!0)],64)))),256))],6),[[a.aG,e.modelValue]])])),_:1})}]]);var P=n(45825),L=n(81086),T=n(41426),R=n(96422),W=n(41857),M=n(34580),O=n(93617),$=n(323),G=n(8328);const D=["id","data-node-type"],X={class:"interface-cursor"},H=["src"],j=["innerHTML"],U=["src"],K=["innerHTML"],B={class:"__properties"},V={class:"__interfaces"},F={key:1,class:"baklava-node-interface --output"},z={key:1,class:"baklava-node-interface --input"},Q={__name:"CustomNode",props:{node:v.hZ,selected:Boolean,greyedOut:Boolean,hidden:Boolean,interfaces:Array},emits:["select"],setup(e,{emit:t}){const n=e,r=t,{viewModel:d}=(0,s.if)(),{graph:c}=(0,s.uU)(),u=(0,o.EW)((()=>d.value.movementStep)),p=(0,l.KR)(null),h=(0,l.KR)(null),v=(0,l.KR)(!1),f=(0,l.KR)(null),b=(0,l.KR)(""),E=(0,l.lW)(n,"node"),w=d.value.editor.getNodeURLs(n.node.type),_=(0,o.EW)((()=>d.value.editor.getNodeColor(E.value))),C=(0,o.EW)((()=>d.value.editor.getTextColor(_.value))),k=d.value.editor.getNodeCategory(n.node.type),N=d.value.editor.isGraphNode(n.node.type),A=(0,o.EW)((()=>d.value.editor.nodeHasRelatedGraphs(E.value))),x=(0,o.EW)((()=>d.value.editor.getPillText(E.value.type))),I=(0,o.EW)((()=>d.value.editor.getPillColor(E.value.type))),Q=(0,o.EW)((()=>d.value.editor.getTextColor(I.value))),Y=!d.value.editor.nodeURLsEmpty(),q=(0,o.EW)((()=>Object.values(n.node.inputs).filter((e=>!e.hidden)))),Z=(0,o.EW)((()=>Object.values(n.node.outputs).filter((e=>!e.hidden)))),J=(0,o.EW)((()=>Object.values(q.value).filter((e=>!e.port)))),ee=M.Ay.getEditorManagerInstance(),te=(0,$.A)();Object.entries(n.node.inputs).forEach((([e,t])=>{if(e.startsWith("property_")){let e=!0;(0,o.wB)(t,(async t=>{if(!te.isConnected())return void(e=!0);if(e||!ee.notifyWhenChanged)return void(e=!1);const o={graph_id:n.node.graphInstance.id,node_id:n.node.id,properties:[]};o.properties.push({id:t.id,new_value:t.value}),await te.notifyAboutChange("properties_on_change",o)}))}})),(0,o.wB)(n.node.position,(e=>{te.isConnected()&&te.notifyAboutChange("position_on_change",{graph_id:n.node.graphInstance.id,node_id:n.node.id,position:{x:e.x,y:e.y}})}));const ne=(0,l.KR)(!1),oe=(0,l.KR)(0),ie=(0,l.KR)(0),ae=(0,l.KR)("hidden"),re=(0,l.KR)(0),se=(0,o.EW)((()=>({"transform-origin":"0 0",transform:`scale(${1/c.value.scaling})`,visible:ae.value}))),le=(0,o.EW)((()=>{const e=[];if(e.push({value:"sidebar",label:"Details",icon:L.A.Sidebar,endSection:!0}),ee.baklavaView.settings.editableNodeTypes&&E.value.type!==M.dH&&(e.push({value:"configure",label:"Configure"},{value:"property",label:"Add property"},{value:"interface",label:"Add interface"},{value:"layer",label:"Set layer"},{value:"delete-property",label:"Delete property"},{value:"delete-interface",label:"Delete interface",endSection:!0}),N||e.push({value:"addSubgraph",label:"Add subgraph",icon:L.A.Subgraph},{value:"addAndEditSubgraph",label:"Add and edit subgraph",icon:L.A.Subgraph})),N&&e.push({value:"editSubgraph",label:"Edit Subgraph",icon:L.A.Subgraph}),A.value){const t=E.value,o=d.value.editor.nodeTypes.get(n.node.type),i=e=>e?.map((({id:e,name:t})=>[e,t]))??[];Object.entries({...Object.fromEntries(i(o.relatedGraphs)),...Object.fromEntries(i(t.relatedGraphs))}).forEach((([t,n])=>{e.push({value:`gotoRelatedGraph ${t}`,label:`Go to ${n} graph`,icon:L.A.Subgraph})}))}return e.length>1&&(e.at(-1).endSection=!0),e.push(...w),d.value.editor.readonly||(e.length>1&&(e.at(-1).endSection=!0),e.push({value:"rename",label:"Rename",icon:L.A.Pencil},{value:"disconnect",label:"Disconnect",icon:L.A.Disconnect},{value:"delete",label:"Delete",icon:L.A.Bin})),e})),de=()=>{const{sidebar:e}=d.value.displayedGraph;e.nodeId=n.node.id,e.visible=!0},ce=async e=>{if("delete"!==e&&"disconnect"!==e){const e={name:n.node.type,category:k,layer:n.node.layer,color:_};G.c.editedType=e.name,G.c.nodeData=e;let t=[...q.value,...Z.value];t=t.filter((e=>void 0!==e.direction));const o=t?.map((e=>({name:e?.name,type:e?.type,direction:e?.direction}))),i=J.value,a=i?.map((e=>({name:e?.name,type:e?.type,default:e?._value,min:e?.min,max:e?.max,values:e?.items,step:e?.step,readonly:e?.readonly,dtype:e?.dtype})));G.c.properties=a,G.c.interfaces=o}const t={name:n.node.type,category:k,layer:n.node.layer};switch(e.includes("gotoRelatedGraph")&&d.value.editor.switchToRelatedGraph(e.replace(/^gotoRelatedGraph /,"")),e){case"delete":(0,W.nb)(),c.value.selectedNodes.includes(n.node)||c.value.selectedNodes.push(n.node),c.value.selectedNodes.forEach((e=>(0,R.bf)(e))),c.value.selectedNodes=[],(0,W.wH)();break;case"rename":b.value=n.node.title,v.value=!0,await(0,o.dY)(),f.value.focus(),f.value.select();break;case"disconnect":{(0,W.nb)();let e=[...q.value,...Z.value];c.value.selectedNodes.forEach((t=>{e=e.concat(Object.entries(t.inputs).filter((([e,t])=>!t.hidden&&!e.startsWith("property_"))).map((([,e])=>e)),Object.values(t.outputs).filter((e=>!e.hidden)))})),c.value.connections.filter((t=>void 0!==e.find((e=>e===t.from||e===t.to)))).forEach((e=>{c.value.removeConnection(e)})),(0,W.wH)()}break;case"sidebar":de();break;case"editSubgraph":{const e=d.value.editor.switchToSubgraph(n.node);Array.isArray(e)&&e.length&&O.A.terminalLog("error","Dataflow is invalid",e);break}case"unwrap":(0,W.nb)(),(0,R.bf)(n.node,!0),(0,W.wH)();break;case"configure":G.x.configurationMenu.visible=!0,G.x.configurationMenu.addNode=!1,G.c.nodeData=t;break;case"property":G.x.propertyMenu=!0;break;case"interface":G.x.interfaceMenu=!0;break;case"layer":G.x.layerMenu=!0;break;case"addSubgraph":{const e=ee.addSubgraphToNode(n.node);Array.isArray(e)&&e.length&&O.A.terminalLog("error","Creating subgraph failed",e);break}case"addAndEditSubgraph":{let e=ee.addSubgraphToNode(n.node);Array.isArray(e)&&e.length&&O.A.terminalLog("error","Creating subgraph failed",e);const t=d.value.displayedGraph.nodes.filter((e=>e.type===n.node.type))[0];e=d.value.editor.switchToSubgraph(t),Array.isArray(e)&&e.length&&O.A.terminalLog("error","Switching to subgraph failed",e);break}case"delete-property":G.x.propertyListMenu=!0;break;case"delete-interface":G.x.interfaceListMenu=!0}},ue=e=>{const t=re.value+e.height+200-window.innerHeight;t>0&&(ie.value-=t),ae.value="visible"},pe=(0,o.EW)((()=>0===le.value.length&&Y||le.value.length>0)),he=(0,l.KR)(!1),ve=e=>{if(pe.value&&!1===ne.value&&!1===he.value){ne.value=!0;const t=e.currentTarget;oe.value=e.offsetX,ie.value=e.offsetY+t.offsetTop+20,re.value=e.clientY}},fe=(0,m.A)((0,l.lW)(n.node,"position"),n.node.id,(0,P.i)(u)),ge=(0,o.EW)((()=>({"--selected":n.selected,"--dragging":fe.dragging.value,"--two-column":!!n.node.twoColumn,"--greyed-out":n.greyedOut,"--hidden":n.hidden,__readonly:d.value.editor.readonly}))),me=(0,o.EW)((()=>({top:`${n.node.position?.y??0}px`,left:`${n.node.position?.x??0}px`,width:`${n.node.width??300}px`}))),ye=(0,o.EW)((()=>{const e=n.node.highlightedTitle??n.node.title,t=n.node.highlightedType??n.node.type;return""===e||n.node.title===n.node.type?t:`${e} <pre class="subtitle">${t}</pre>`})),be=e=>{r("select",e)};let Ee,we;const _e=()=>{document.removeEventListener("pointermove",fe.onPointerMove),document.removeEventListener("keyboard.escape",Ee),document.removeEventListener("pointerup",we)};Ee=()=>{_e()},we=()=>{fe.onPointerUp(),_e()};const Ce=()=>{c.value.findNodeById(n.node.id).title=b.value,v.value=!1},ke=()=>{p.value&&d.value.hooks.renderNode.execute({node:n.node,el:p.value})};(0,o.sV)(ke),(0,o.$u)(ke);const Ne=(0,T.A)(700,(()=>{de()})),Ae=()=>{const{sidebar:e}=d.value.displayedGraph;e.visible&&(e.nodeId=n.node.id),Ne()},xe=(0,o.EW)((()=>Object.values([...q.value,...Z.value]).filter((e=>"left"===e.side&&e.port)).sort(((e,t)=>e.sidePosition-t.sidePosition)))),Ie=(0,o.EW)((()=>Object.values([...q.value,...Z.value]).filter((e=>"right"===e.side&&e.port)).sort(((e,t)=>e.sidePosition-t.sidePosition)))),Se=e=>{if(!e.length)return[];const t=Math.max(xe.value.at(-1)?.sidePosition??0,Ie.value.at(-1)?.sidePosition??0);let n=0;const o=[];for(let i=0;i<=t;i+=1)e[n]?.sidePosition===i?(o.push(e[n]),n+=1):o.push(void 0);return o},Pe=(0,o.EW)((()=>Se(Ie.value))),Le=(0,o.EW)((()=>Se(xe.value)));(0,o.wB)(J,(()=>{J.value.forEach((e=>{void 0!==e.setDefaultComponent&&e.setDefaultComponent()}))}),{immediate:!0});const Te=d.value.editor.getNodeIconPath(n.node.type),Re=d.value.cache[`./${Te}`]??Te,We=(0,o.EW)((()=>{let e,t=d.value.editor.getStyleIcon(E.value.type);return"object"==typeof t&&null!==t&&(t=ee.getMetadataIcon(t)),void 0!==L.A[t]?e=L.A[t]:void 0!==d.value.cache[`./${t}`]&&(e=L.A.Placeholder,t=d.value.cache[`./${t}`]),{icon:e,name:t}}));let Me,Oe;const $e=(0,l.KR)(null),Ge=(0,l.KR)(null),De=(0,l.KR)({top:"0px",left:"0px",display:"none"}),Xe=(0,o.EW)((()=>d.value.editor.readonly?pe.value?{cursor:"pointer",backgroundColor:_.value,color:C.value}:{cursor:"default",backgroundColor:_.value,color:C.value}:{cursor:"drag",backgroundColor:_.value,color:C.value})),He=(0,o.EW)((()=>({cursor:"default",backgroundColor:I.value,color:Q.value}))),je=e=>e===Oe,Ue=e=>{let t;"right"===Oe.side?t=Ge.value:"left"===Oe.side&&(t=$e.value);let n=[...t.children].findIndex((t=>t.getBoundingClientRect().bottom>e.clientY));Me=n,-1===n&&(n=t.children.length-1,Me=t.children.length-1);const o=t.children[n];De.value={top:o.offsetTop+o.offsetHeight/2-2.5+"px",display:"block"},"right"===Oe.side?De.value.right="-0.7em":"left"===Oe.side&&(De.value.left="-0.7em")},Ke=()=>{(0,R.q6)(n.node,Oe,Oe.side,Me,!0),Oe=void 0,De.value={top:"0px",left:"0px",right:"0px",display:"none"},document.removeEventListener("pointermove",Ue),document.removeEventListener("pointerup",Ke)},Be=(e,t)=>{Oe=e,Ue(t),document.addEventListener("pointermove",Ue),document.addEventListener("pointerup",Ke)},Ve=(0,l.KR)(0),Fe=(0,l.KR)(0),ze=()=>{const e=[];if(void 0!==Oe){const t=void 0===Oe.externalName?{value:"SetExternalName",label:"Expose Interface"}:{value:"UnsetExternalName",label:"Privatize Interface"};e.push(t)}return e.push({value:"SpaceUp",label:"Space Up"},{value:"SpaceDown",label:"Space Down"},{value:"MoveUp",label:"Move Up"},{value:"MoveDown",label:"Move Down"}),e},Qe=(0,l.KR)(ze()),Ye=e=>{switch(e){case"SetExternalName":d.value.editor.exposeInterface(c.value.id,Oe);break;case"UnsetExternalName":d.value.editor.privatizeInterface(c.value.id,Oe);break;case"MoveUp":if(0===Oe.sidePosition){Oe=void 0;break}Me=Oe.sidePosition-1,Ke();break;case"MoveDown":Me=Oe.sidePosition+1,Ke();break;case"SpaceUp":case"SpaceDown":{const t="right"===Oe.side?Pe.value:Le.value,n="SpaceDown"===e?(e,t)=>e>t:(e,t)=>e>=t;Object.values(t).forEach((e=>{void 0!==e&&n(e.sidePosition,Oe.sidePosition)&&(e.sidePosition+=1)}));break}}},qe=(e,t)=>{d.value.editor.readonly||!1!==he.value||(Oe=e,Qe.value=ze(),"right"===Oe.side?(Ve.value=t.currentTarget.offsetLeft+162.5,Fe.value=t.currentTarget.offsetTop+12.5):"left"===Oe.side&&(Ve.value=t.currentTarget.offsetLeft-t.currentTarget.offsetWidth+162.5,Fe.value=t.currentTarget.offsetTop+12.5),he.value=!0)};(0,o.wB)(he,(()=>{!1===he.value&&(Oe=void 0)}));const Ze=e=>{e.group.forEach((t=>{n.node.inputs[t].hidden=!e.value}))},Je=e=>{n.node.updateDynamicInterfaces(e)},et=e=>{"left"===e.side?(0,R.q6)(n.node,e,"right"):(0,R.q6)(n.node,e,"left")};return(e,t)=>{const r=(0,o.gN)("click-outside"),s=(0,o.gN)("long-press"),u=(0,o.gN)("long-press-to-right");return(0,o.uX)(),(0,o.CE)("div",{id:E.value.id,ref_key:"nodeRef",ref:p,class:(0,i.C4)(["baklava-node",ge.value]),style:(0,i.Tr)(me.value),"data-node-type":E.value.type,onPointerdown:t[6]||(t[6]=(0,a.D$)((e=>be(e)),["left","exact"])),oncontextmenu:"return false;"},[(0,o.Lk)("div",X,[(0,o.Lk)("div",{class:"line",style:(0,i.Tr)(De.value)},null,4)]),(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{class:"__title",ref_key:"titleRef",ref:h,style:(0,i.Tr)(Xe.value),onPointerdown:[(0,a.D$)(Ae,["left","exact"]),t[4]||(t[4]=(0,a.D$)((e=>{return t=e,void(d.value.editor.readonly||(e=>{c.value.selectedNodes.includes(n.node)||be(e),fe.onPointerDown(e),document.addEventListener("pointermove",fe.onPointerMove),document.addEventListener("keyboard.escape",Ee),document.addEventListener("pointerup",we)})(t));var t}),["left"])),(0,a.D$)(ve,["right"])]},[void 0!==(0,l.R1)(Re)?((0,o.uX)(),(0,o.CE)("img",{key:0,class:"__title-icon",src:(0,l.R1)(Re)},null,8,H)):(0,o.Q3)("",!0),v.value?(0,o.bo)(((0,o.uX)(),(0,o.CE)("input",{key:2,type:"text",class:"baklava-input","onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),placeholder:"Node Name",ref_key:"renameField",ref:f,onKeydown:[t[1]||(t[1]=e=>e.stopPropagation()),(0,a.jR)(Ce,["enter"])]},null,544)),[[a.Jo,b.value],[r,Ce]]):((0,o.uX)(),(0,o.CE)("div",{key:1,class:"__title-label",innerHTML:(0,l.R1)(g()).sanitize(ye.value)},null,8,j)),void 0!==We.value.name&&null!==We.value.name?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[void 0!==We.value.icon?((0,o.uX)(),(0,o.Wv)((0,o.$y)(We.value.icon),{key:0,class:"__title-icon",imgURI:We.value.name},null,8,["imgURI"])):((0,o.uX)(),(0,o.CE)("img",{key:1,class:"__title-icon",src:We.value.name},null,8,U))],64)):(0,o.Q3)("",!0),(0,l.R1)(N)||A.value?((0,o.uX)(),(0,o.Wv)((0,l.R1)(L.A).Subgraph,{key:4,class:"__subgraph-icon"})):(0,o.Q3)("",!0),void 0!==x.value?((0,o.uX)(),(0,o.CE)("div",{key:5,class:"pill",style:(0,i.Tr)(He.value),innerHTML:(0,l.R1)(g()).sanitize(x.value)},null,12,K)):(0,o.Q3)("",!0),ne.value?((0,o.uX)(),(0,o.Wv)(S,{key:6,modelValue:ne.value,"onUpdate:modelValue":t[2]||(t[2]=e=>ne.value=e),x:oe.value,y:ie.value,items:le.value,urls:(0,l.R1)(w),style:(0,i.Tr)(se.value),onPointerdown:t[3]||(t[3]=(0,a.D$)((()=>{}),["left","stop"])),onClick:ce,onSizeUpdate:ue},null,8,["modelValue","x","y","items","urls","style"])):(0,o.Q3)("",!0)],36)),[[s,ve,"500"]]),(0,o.Lk)("div",{class:"__content",onPointerdown:(0,a.D$)(ve,["right"])},[(0,o.Lk)("div",B,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(J.value,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id},[(0,o.eW)((0,i.v_)((0,l.R1)(R.BW)(e.componentName)?`${e.name}:`:"")+" ",1),(0,o.bF)(y.A,{node:E.value,intf:e,toggleGroup:Ze,updateDynamicInterfaces:Je},null,8,["node","intf"])])))),128))]),(0,o.Lk)("div",V,[(0,o.Lk)("div",{class:"__outputs",ref_key:"rightSocketsRefs",ref:Ge},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Pe.value,(e=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(y.A,{key:e.id,onPointerdown:[(0,a.D$)((t=>Be(e,t)),["left","shift"]),(0,a.D$)((t=>qe(e,t)),["right","exact"])],node:E.value,intf:e,highlighted:n.interfaces?.includes(e),picked:je(e),switchSides:et},null,8,["onPointerdown","node","intf","highlighted","picked"])),[[u,void 0,"500"]]):((0,o.uX)(),(0,o.CE)("div",F," "))],64)))),256))],512),(0,o.Lk)("div",{class:"__inputs",ref_key:"leftSocketsRefs",ref:$e},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Le.value,(e=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e?(0,o.bo)(((0,o.uX)(),(0,o.Wv)(y.A,{key:e.id,onPointerdown:[(0,a.D$)((t=>Be(e,t)),["left","shift"]),(0,a.D$)((t=>qe(e,t)),["right"])],node:E.value,intf:e,highlighted:n.interfaces?.includes(e),picked:je(e),switchSides:et},null,8,["onPointerdown","node","intf","highlighted","picked"])),[[u,void 0,"500"]]):((0,o.uX)(),(0,o.CE)("div",z," "))],64)))),256))],512)]),he.value?((0,o.uX)(),(0,o.Wv)(S,{key:0,modelValue:he.value,"onUpdate:modelValue":t[5]||(t[5]=e=>he.value=e),x:Ve.value,y:Fe.value,items:Qe.value,style:(0,i.Tr)(se.value),onClick:Ye},null,8,["modelValue","x","y","items","style"])):(0,o.Q3)("",!0)],32)],46,D)}}},Y=(0,I.A)(Q,[["__scopeId","data-v-09ce9074"]]);var q=n(62789),Z=n(35334),J=n(13859),ee=n(274),te=n(5419),ne=n(80768),oe=n(51645),ie=n(86585),ae=n(29567),re=n(21370),se=n(15995);const le=(0,o.pM)({extends:s.xn,props:{loading:{required:!0,type:Boolean}},components:{CustomNode:Y,Panel:re.A,ParentMenu:se.IM,PipelineManagerConnection:q.A,TemporaryConnection:Z.A,NodePalette:J.A,RectangleSelection:te.A,WelcomeMenu:se.s$,Zoom:ie.A,Return:ae.A},emits:["setLoad"],setup(e,{emit:t}){const{el:i,counter:a,nodes:r,connections:d,selectedNodes:v,nodeContainerStyle:f,keyDown:g,keyUp:m}=s.xn.setup(e),y=(0,l.KR)([]),{graph:b}=(0,s.uU)(),E=(0,h.A)(),w=(0,ee.n)(),_=M.Ay.getEditorManagerInstance(),C=(0,l.KR)([]),k=(0,l.KR)([]),N=(0,o.EW)((()=>e.viewModel.editor.readonly)),A=(0,o.EW)((()=>e.viewModel.editor.hideHud)),x=(0,l.KR)(null),I=[],S=(0,o.EW)((()=>b.value.scaling)),P=(0,o.EW)((()=>e.viewModel.editor.searchQuery)),L=(0,l.KR)([]);let T=0;const R=(0,o.EW)((()=>({"--scale":S.value,cursor:E.dragging.value?"move":"default"}))),W=(0,o.EW)((()=>e.viewModel.editor.isInSubgraph())),G=(0,o.EW)((()=>e.viewModel.editor.preview)),D=()=>{e.viewModel.displayedGraph.selectedNodes=[]},X=()=>{b.value.nodes.forEach((e=>{if(b.value.selectedNodes.includes(e))return;const t=x.value.boundingRect;(0,ne.A)(b.value,e,t)&&b.value.selectedNodes.push(e)}))};let H=0;const j=e=>{E.onPointerMove(e),w.onMouseMove(e),x.value.onPointerMove(e),x.value.selecting&&(b.value.selectedNodes=[],b.value.nodes.forEach((e=>{const t=x.value.boundingRect;(0,ne.A)(b.value,e,t)&&b.value.selectedNodes.push(e)})))},U=e=>{E.onPointerUp(e),w.onMouseUp(),new Date-T<100&&e.target===i.value&&D(),1===H&&(document.removeEventListener("pointerup",U),document.removeEventListener("pointermove",j)),H-=1},K=e=>{new Date-T>=100&&e.target===i.value&&X(),x.value.onPointerUp(),document.removeEventListener("pointerup",K),document.removeEventListener("pointermove",j)},B=()=>{b.value.selectedNodes=I.value,X(),x.value.onPointerUp(),document.removeEventListener("pointerup",B),document.removeEventListener("pointermove",j)};document.addEventListener("pointerdown",(e=>{0!==e.button||e.shiftKey||((e=>{H+=1,e.target===i.value&&E.onPointerDown(e),w.onMouseDown(e),T=new Date})(e),document.addEventListener("pointerup",U),document.addEventListener("pointermove",j)),N.value||(2===e.button&&e.ctrlKey?((e=>{x.value.onPointerDown(e),I.value=b.value.selectedNodes})(e),document.addEventListener("pointerup",B),document.addEventListener("pointermove",j)):2===e.button&&((e=>{e.target===i.value&&(D(),x.value.onPointerDown(e)),T=new Date})(e),document.addEventListener("pointerup",K),document.addEventListener("pointermove",j)))}));const V=()=>{C.value.splice(0,C.value.length)};(0,o.wB)(d.value,(()=>{V()})),(0,o.wB)(w?.temporaryConnection,(()=>{if(void 0!==(w??null)&&null!==w?.temporaryConnection)if(w?.temporaryConnection?.value?.from)for(let e=0;e<r.value.length;e+=1)[...Object.values(r.value[e].outputs)||[],...Object.values(r.value[e].inputs)||[]].forEach((e=>{var t;e.port&&e!==w.temporaryConnection.value.from&&(b.value.checkConnection(w.temporaryConnection.value.from,e).connectionAllowed||(t=e,k.value.includes(t)||k.value.push(t)))}));else k.value.splice(0,k.value.length)}));const F=(0,o.EW)((()=>e.viewModel.ignoredLayers)),z=(0,o.EW)((()=>e.viewModel.layers)),Q=(0,o.EW)((()=>{const e=new Set;return z.value.forEach((t=>{t.nodeInterfaces&&F.value.has(t.name)&&t.nodeInterfaces.forEach(e.add,e)})),e})),Y=(0,o.EW)((()=>{const e=new Set;return z.value.forEach((t=>{t.nodeLayers&&F.value.has(t.name)&&t.nodeLayers.forEach(e.add,e)})),e})),q=(0,o.EW)((()=>r.value.filter((e=>!Y.value.has(e.layer))))),Z=(0,o.EW)((()=>r.value.filter((e=>Y.value.has(e.layer))))),J=(0,o.EW)((()=>Z.value.map((e=>e.id)))),te=(0,o.EW)((()=>d.value.filter((e=>!(e.from.type?.some((e=>Q.value.has(e)))||e.to.type?.some((e=>Q.value.has(e)))||J.value.includes(e.from.nodeId)||J.value.includes(e.to.nodeId)))))),ie=(0,o.EW)((()=>q.value.filter((t=>e.viewModel.displayedGraph.selectedNodes.includes(t))))),ae=(0,$.A)();(0,o.wB)(q,(async(e,t)=>{if(!ae.isConnected())return;if(!_.notifyWhenChanged)return;const n=Object.values(e).map((e=>e.id)),o=Object.values(t).map((e=>e.id)),i=[];Object.values(e).forEach((e=>{o.includes(e.id)||i.push(e.save())}));const a=[];Object.values(t).forEach((e=>{n.includes(e.id)||a.push(e.id)}));const r={graph_id:b.value.id,nodes:{added:i,deleted:a}};await ae.notifyAboutChange("nodes_on_change",r)})),(0,o.wB)(te,(async(e,t)=>{if(!ae.isConnected())return;if(!_.notifyWhenChanged)return;const n=Object.values(e).map((e=>e.id)),o=Object.values(t).map((e=>e.id)),i=[];Object.values(e).forEach((e=>{o.includes(e.id)||i.push({id:e.id,from:e.from.id,to:e.to.id})}));const a=[];Object.values(t).forEach((e=>{n.includes(e.id)||a.push({from:e.from.id,to:e.to.id})}));const r={graph_id:b.value.id,connections:{added:i,deleted:a}};await ae.notifyAboutChange("connections_on_change",r)})),(0,o.wB)(ie,(async(e,t)=>{if(!ae.isConnected())return;if(!_.notifyWhenChanged)return;const n=Object.values(e).map((e=>e.id)),o=Object.values(t).map((e=>e.id)),i=[];Object.values(e).forEach((e=>{o.includes(e.id)||i.push(e.id)}));const a=[];Object.values(t).forEach((e=>{n.includes(e.id)||a.push(e.id)}));const r={graph_id:b.value.id,nodes:{selected:i,unselected:a}};await ae.notifyAboutChange("nodes_on_highlight",r)}));const re=(0,o.EW)((()=>r.value.map((e=>e.title))));(0,o.wB)([P,re],(()=>{if(void 0===P.value||""===P.value)return L.value=[],void q.value.forEach((e=>{e.highlightedTitle=e.title,e.highlightedType=e.type}));const e=(t=P.value,q.value.filter((e=>{const{type:n}=e,o=c().single(t,e.title),i=c().single(t,n);return null!==o&&o.score>-50||null!==i&&i.score>-50?(e.highlightedTitle=c().highlight(o,"<span>","</span>"),e.highlightedType=c().highlight(i,"<span>","</span>"),!0):(e.highlightedTitle=e.title,e.highlightedType=e.type,!1)})));var t;const n=q.value.filter((t=>!e.includes(t)));L.value=n}));const se=void 0!=={NODE_ENV:"production",VUE_APP_STATIC:"true",VUE_APP_VERBOSE:"false",VUE_APP_GRAPH_DEVELOPMENT_MODE:"false",BASE_URL:""}.VUE_APP_SPECIFICATION_PATH,le=void 0!=={NODE_ENV:"production",VUE_APP_STATIC:"true",VUE_APP_VERBOSE:"false",VUE_APP_GRAPH_DEVELOPMENT_MODE:"false",BASE_URL:""}.VUE_APP_DATAFLOW_PATH;async function de(e){let t,n,o=M.Ay.validateSpecification(e);return o.length?(O.A.terminalLog("error","Specification is invalid",o),_.specificationVersion!==e.version&&O.A.terminalLog("error","Mismatched specification version",`Specification version (${e.version}) differs from the current version (${_.specificationVersion}). It may result in unexpected behaviour. Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.`),o):(({errors:o,warnings:t,info:n}=await _.updateEditorSpecification(e)),Array.isArray(t)&&t.length&&O.A.terminalLog("warning","Issue when loading specification",t),Array.isArray(o)&&o.length?(O.A.terminalLog("error","Specification is invalid",o),Array.isArray(n)&&n.length&&O.A.terminalLog("error","Mismatched specification version",`${n} Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.`)):Array.isArray(n)&&n.length&&O.A.terminalLog("info","Specification loaded",n),o)}async function ce(e){const{errors:t,warnings:n,info:o}=await _.loadDataflow(e);if(Array.isArray(n)&&n.length&&O.A.terminalLog("warning","Issue when loading dataflow",n),Array.isArray(t)&&t.length){const e="Dataflow is invalid";O.A.terminalLog("error",e,t),Array.isArray(o)&&o.length&&O.A.terminalLog("error","Mismatched dataflow version",`${o} Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.`)}else Array.isArray(o)&&o.length&&O.A.terminalLog("info","Dataflow loaded",o);return t}(0,o.sV)((async()=>{window.addEventListener("message",(async e=>{const t=e.data??{};if(t.jsonrpc??=p.JSONRPC,(0,p.isJSONRPCResponse)(t)){if(e.source===window)return;return void oe.Ay.client.receive(t)}if(t.id??=oe.Ay.client.createID(),!(0,p.isJSONRPCRequest)(t))return;let n="register_external_frontend"===t.method?ae.registerFrontendApplication(e.source,t):null;n??=e.data.method in oe.D7?await oe.Ay.server.receive(t):await oe.Ay.requestAdvanced(t,{externalApp:ae.externalApp}),n&&e.source.postMessage(JSON.parse(JSON.stringify(n)))})),O.A.setShowNotification(!1),_.updateMetadata({});const t=window.location.search.replace(/&amp;/g,"&"),i=new URLSearchParams(t);if(i.has("preview")){const t="true"===i.get("preview");e.viewModel.editor.preview=t}let a;if(i.has("spec")){e.viewModel.editor.events.setLoad.emit(!0),await(0,o.dY)();const[t,n]=await(0,M.sA)(i.get("spec"));!1===t?(O.A.terminalLog("error",n),O.A.terminalLog("error",`Failed to load the specification file from: ${i.get("spec")}`)):a=n}else se&&(a=n(63359)({NODE_ENV:"production",VUE_APP_STATIC:"true",VUE_APP_VERBOSE:"false",VUE_APP_GRAPH_DEVELOPMENT_MODE:"false",BASE_URL:""}.VUE_APP_SPECIFICATION_PATH));if(void 0!==a){if(i.has("include")&&(void 0===a.include&&(a.include=[]),a.include.push(i.get("include"))),(await de(a)).length)return O.A.restoreShowNotification(),void e.viewModel.editor.events.setLoad.emit(!1);let t;if(i.has("graph")){const[e,n]=await(0,M.sA)(i.get("graph"));!1===e?(O.A.terminalLog("error",n),O.A.terminalLog("error",`Failed to load the graph file from: ${i.get("graph")}`)):t=n}else le&&(t=n(63359)({NODE_ENV:"production",VUE_APP_STATIC:"true",VUE_APP_VERBOSE:"false",VUE_APP_GRAPH_DEVELOPMENT_MODE:"false",BASE_URL:""}.VUE_APP_DATAFLOW_PATH));t&&await ce(t)}O.A.restoreShowNotification(),e.viewModel.editor.events.setLoad.emit(!1)}));const ue=async t=>{e.viewModel.editor.events.setLoad.emit(!0);const n=()=>e.viewModel.editor.events.setLoad.emit(!1),o=O.A.showToast;if(t.length>2)return o("error",`Up to two files supported, inserted: ${t.length}`),void n();let i;try{const e=async e=>JSON.parse(await e.text());i=await Promise.all(Array.from(t).map(e))}catch(e){return o("error","Dropped file is not in JSON format"),void n()}const a=e=>Boolean(e.nodes||e.include||e.includeGraphs),r=e=>Boolean(e.graphs&&!a(e)),s=i.map((e=>!a(e)&&!r(e)));if(s.every(Boolean))return 1===i.length?o("error","Provided file is not of Pipeline Manager format"):o("error","Neither of provided files is of Pipeline Manager format"),void n();i=i.filter(((e,t)=>!s[t])),s.some(Boolean)&&o("warning","One of the objects is not of Pipeline Manager format");const l=i.map(a),d=i.map(r);let c,u;l.every(Boolean)?(i.length>1&&o("warning","Two specifications provided, using the first one."),[c]=i):d.every(Boolean)?(i.length>1&&o("warning","Two dataflows provided, using the first one."),[u]=i):l.some(Boolean)&&d.some(Boolean)&&(l[0]?[c,u]=i:[u,c]=i);let p=!0;c&&(ae.isConnected()?(O.A.showToast("warning","Specification is managed by an external application."),p=!1):p=!(await de(c)).length),p&&u&&await ce(u),n()};e.viewModel.editor.events.setLoad=new u.Hx,e.viewModel.editor.events.setLoad.subscribe("editor",(e=>{t("setLoad",e)}));const pe=(0,o.EW)((()=>_.baklavaView.welcome&&!_.baklavaView.editor.readonly&&!r.value.length&&!_.editor.isInSubgraph()));return{el:i,counter:a,selectedNodes:v,nodeContainerStyle:f,onRightPointerUp:K,onDrop:async e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy";const t=[];e.dataTransfer.items?[...e.dataTransfer.items].filter((e=>"file"===e.kind)).forEach((e=>t.push(e.getAsFile()))):t.push(...e.dataTransfer.files),await ue(t)},nodes:r,keyDown:g,keyUp:m,selectNode:(t,n)=>{(n&&!n.ctrlKey||!n&&!e.viewModel.commandHandler.pressedKeys.includes("Control"))&&D(),e.viewModel.displayedGraph.selectedNodes.push(t)},rectangleSelection:x,greyedOutNodes:L,temporaryConnection:w.temporaryConnection,temporaryConnectionRender:w.render,mouseWheel:E.onMouseWheel,dragging:E.dragging,changeHoveredConnections:e=>{const t=document.elementsFromPoint(e.clientX,e.clientY),n=y.value.filter((e=>e.containsPoint(t))),o=d.value.filter((e=>n.filter((t=>t.connection===e)).length>0)),i=d.value.filter((e=>o.filter((t=>t.from===e.from)).length>0));d.value.forEach((e=>{var t;i.includes(e)?(t=e,C.value.includes(t)||C.value.push(t)):(e=>{const t=C.value.indexOf(e);t>=0&&C.value.splice(t,1)})(e)}))},highlightConnections:C,connRefs:y,clearHighlight:V,readonly:N,hideHud:A,scale:S,visibleConnections:te,visibleNodes:q,ignoredNodes:Z,highlightInterfaces:k,editorStyle:R,zoomIn:E.onZoomIn,zoomOut:E.onZoomOut,center:()=>{_.centerZoom()},returnFromSubgraph:()=>{_.returnFromSubgraph()},isInSubgraph:W,preview:G,showWelcome:pe,loadFiles:ue}}}),de=(0,I.A)(le,[["render",function(e,t,n,s,l,d){const c=(0,o.g2)("background"),u=(0,o.g2)("NodePalette"),p=(0,o.g2)("CustomNode"),h=(0,o.g2)("PipelineManagerConnection"),v=(0,o.g2)("TemporaryConnection"),f=(0,o.g2)("RectangleSelection"),g=(0,o.g2)("Zoom"),m=(0,o.g2)("Return"),y=(0,o.g2)("WelcomeMenu"),b=(0,o.g2)("ParentMenu"),E=(0,o.g2)("Panel");return(0,o.uX)(),(0,o.CE)("div",{ref:"el",tabindex:"-1",class:(0,i.C4)(["baklava-editor",{"baklava-ignore-mouse":!!e.temporaryConnection||e.dragging,"--temporary-connection":!!e.temporaryConnection}]),style:(0,i.Tr)(e.editorStyle),onWheel:t[5]||(t[5]=(0,a.D$)(((...t)=>e.mouseWheel&&e.mouseWheel(...t)),["self"])),onKeydown:t[6]||(t[6]=(...t)=>e.keyDown&&e.keyDown(...t)),onKeyup:t[7]||(t[7]=(...t)=>e.keyUp&&e.keyUp(...t)),onMouseleave:t[8]||(t[8]=t=>!e.readonly&&e.onRightPointerUp),onDrop:t[9]||(t[9]=(0,a.D$)((t=>!e.readonly&&e.onDrop(t)),["prevent"])),onDragenter:t[10]||(t[10]=(0,a.D$)((()=>{}),["prevent"])),onDragover:t[11]||(t[11]=(0,a.D$)((()=>{}),["prevent"])),oncontextmenu:"return false;"},[(0,o.RG)(e.$slots,"background",{},(()=>[(0,o.bF)(c)])),e.readonly||e.hideHud?(0,o.Q3)("",!0):(0,o.RG)(e.$slots,"palette",{key:0},(()=>[(0,o.bF)(u)])),(0,o.Lk)("div",{class:"node-container",style:(0,i.Tr)(e.nodeContainerStyle),onWheel:t[0]||(t[0]=(...t)=>e.mouseWheel&&e.mouseWheel(...t))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.visibleNodes,(t=>((0,o.uX)(),(0,o.Wv)(p,{key:t.id+e.counter.toString(),node:t,selected:e.selectedNodes.includes(t),greyedOut:e.greyedOutNodes.includes(t),interfaces:e.highlightInterfaces,onSelect:n=>e.selectNode(t,n)},null,8,["node","selected","greyedOut","interfaces","onSelect"])))),128)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.ignoredNodes,(t=>((0,o.uX)(),(0,o.Wv)(p,{key:t.id+e.counter.toString(),node:t,hidden:!0},null,8,["node"])))),128))],36),((0,o.uX)(),(0,o.CE)("svg",{class:"connections-container",onMouseenter:t[1]||(t[1]=(...t)=>e.changeHoveredConnections&&e.changeHoveredConnections(...t)),onMousemove:t[2]||(t[2]=(...t)=>e.changeHoveredConnections&&e.changeHoveredConnections(...t)),onMouseleave:t[3]||(t[3]=(...t)=>e.clearHighlight&&e.clearHighlight(...t)),onWheel:t[4]||(t[4]=(...t)=>e.mouseWheel&&e.mouseWheel(...t))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.visibleConnections,(t=>((0,o.uX)(),(0,o.Wv)(h,{key:t.id+e.counter.toString(),connection:t,ref_for:!0,ref:"connRefs",isHighlighted:e.highlightConnections.includes(t)},null,8,["connection","isHighlighted"])))),128)),e.temporaryConnection&&e.temporaryConnectionRender?((0,o.uX)(),(0,o.Wv)(v,{key:0,name:"temporaryConnection","temporary-connection":e.temporaryConnection,connection:e.temporaryConnection},null,8,["temporary-connection","connection"])):(0,o.Q3)("",!0)],32)),(0,o.Lk)("div",r,[(0,o.bF)(f,{ref:"rectangleSelection"},null,512)]),(0,o.bF)(g,{onZoomIn:e.zoomIn,onZoomOut:e.zoomOut,onCenter:e.center,floating:!e.hideHud},null,8,["onZoomIn","onZoomOut","onCenter","floating"]),e.preview&&e.isInSubgraph?((0,o.uX)(),(0,o.Wv)(m,{key:1,onClick:e.returnFromSubgraph},null,8,["onClick"])):(0,o.Q3)("",!0),(0,o.bo)((0,o.bF)(E,{blur:!1,class:"welcome-container-panel"},{default:(0,o.k6)((()=>[(0,o.bF)(b,null,{default:(0,o.k6)((()=>[(0,o.bF)(y,{loadFiles:e.loadFiles},null,8,["loadFiles"])])),_:1})])),_:1},512),[[a.aG,e.showWelcome]])],38)}]])}}]);
//# sourceMappingURL=index-7574f2c7.aa5096de.js.map