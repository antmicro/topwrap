{"version":3,"file":"js/index-7574f2c7.ebecb2a1.js","mappings":"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","sources":["webpack://pipeline-manager/./src/custom/CustomInterface.vue","webpack://pipeline-manager/./src/custom/CustomInterface.vue?418c","webpack://pipeline-manager/./src/custom/ContextMenu.vue","webpack://pipeline-manager/./src/custom/ContextMenu.vue?2c86","webpack://pipeline-manager/./src/custom/CustomGraphTemplate.js","webpack://pipeline-manager/./src/custom/Editor.js","webpack://pipeline-manager/./src/custom/CustomGraph.js","webpack://pipeline-manager/./src/custom/LinkMenu.vue","webpack://pipeline-manager/./src/custom/LinkMenu.vue?8fc7","webpack://pipeline-manager/./src/custom/CustomSidebar.vue","webpack://pipeline-manager/./src/custom/CustomSidebar.vue?9ce8","webpack://pipeline-manager/./src/custom/CustomGraphNode.js","webpack://pipeline-manager/./src/custom/Editor.vue","webpack://pipeline-manager/./src/custom/CustomNode.vue","webpack://pipeline-manager/./src/custom/CustomNode.vue?145c","webpack://pipeline-manager/./src/custom/Editor.vue?366e","webpack://pipeline-manager/./src/custom/CustomNode.js"],"sourcesContent":["<!--\nCopyright (c) 2022-2024 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!--\nInterface that is used to display inputs, outputs and properties of a node.\n\nThe custom implementations introduces wrapper functions that prevent the user\nfrom creating and deleting connections or altering nodes' values if the editor is read-only.\n-->\n\n<template>\n    <div\n        :id=\"intf.id\"\n        ref=\"el\"\n        class=\"baklava-node-interface\"\n        :class=\"newClasses\"\n    >\n        <div\n            class=\"__port\"\n            v-if=\"intf.port\"\n            @mouseenter=\"startHoverWrapper\"\n            @mouseleave=\"endHoverWrapper\"\n            @pointerdown.left=\"onMouseDown\"\n            :class=\"{ greyedout_arrow: highlighted, picked: picked, '__square': isExposed }\"\n        >\n            <div\n                v-if=\"isExposed && (hovered || editExternalName)\"\n                :class=\"{\n                    '__port_name_left': intf.side === 'left',\n                    '__port_name_right': intf.side === 'right'\n                }\"\n            >\n                <input\n                    v-if=\"editExternalName\"\n                    v-model=\"inputExternalName\"\n                    ref=\"externalNameInput\"\n                    type=\"text\"\n                    spellcheck=\"false\"\n                    autocomplete=\"off\"\n                    class=\"__port_input\"\n                    :class=\"{ '__error': externalNameInputIncorrect }\"\n                    placeholder=\"External name\"\n                    @focusout=\"externalNameFocusOutCallback\"\n                    @keydown.enter.exact.stop=\"(e) => { e.target.blur(); }\"\n                    @input=\"externalNameInputCallback\"\n                    @pointerdown.left.stop=\"(e) => e.stopPropagation()\"\n                    @keydown.ctrl.stop=\"(e) => e.stopPropagation()\"\n                />\n                <span\n                    v-else\n                    @pointerdown.left.stop=\"enableExternalNameEdit\"\n                    @keydown.stop\n                >\n                    {{ intf.externalName }}\n                </span>\n            </div>\n            <Arrow\n                v-if=\"displayArrow\"\n                :noninteractable=\"true\"\n                color=\"black\"\n                scale=\"big\"\n                :rotate=\"arrowRotation\"\n            />\n        </div>\n\n        <div\n            @mouseenter=\"startPropertyHover\"\n            @mouseleave=\"endPropertyHover\"\n        >\n            <!-- @keydown.stop is added so that events are not bubbled up to the editor -->\n            <component\n                :is=\"intf.component\"\n                v-if=\"showComponent\"\n                v-model=\"intf.value\"\n                :node=\"node\"\n                :intf=\"intf\"\n                @keydown.stop\n                :tabindex=\"tabindexValue\"\n                @click=\"setValue\"\n                @input=\"setValue\"\n            />\n            <span v-else>\n                {{ intf.name }}\n            </span>\n            <div\n                v-if=\"isExposed && (propertyHovered || editExternalName) && !intf.port && !sidebar\"\n                class=\"__property_name\"\n            >\n                <input\n                    v-if=\"editExternalName\"\n                    v-model=\"inputExternalName\"\n                    ref=\"externalNameInput\"\n                    type=\"text\"\n                    spellcheck=\"false\"\n                    autocomplete=\"off\"\n                    class=\"__property_input\"\n                    :class=\"{ '__error': externalNameInputIncorrect }\"\n                    placeholder=\"External name\"\n                    @focusout=\"externalNameFocusOutCallback\"\n                    @keydown.enter.exact.stop=\"(e) => { e.target.blur(); }\"\n                    @input=\"externalNameInputCallback\"\n                    @pointerdown.left.stop=\"(e) => e.stopPropagation()\"\n                    @keydown.ctrl.stop=\"(e) => e.stopPropagation()\"\n                />\n                <span\n                    v-else\n                    @pointerdown.left.stop=\"enableExternalNameEdit\"\n                    @keydown.stop\n                >\n                    {{ intf.externalName }}\n                </span>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport {\n    defineComponent, ref, computed, nextTick,\n} from 'vue';\nimport {\n    Components, useViewModel, useGraph, TextInterface,\n} from '@baklavajs/renderer-vue';\nimport Arrow from '../icons/Arrow.vue';\nimport doubleClick from '../core/doubleClick';\nimport { DYNAMIC_INTERFACE_SUFFIX } from '../core/interfaceParser';\nimport { ir } from '../core/interfaceRegistry.ts';\n\nexport default defineComponent({\n    extends: Components.NodeInterface,\n    props: {\n        highlighted: Boolean,\n        picked: Boolean,\n        switchSides: {},\n        toggleGroup: { default: () => {}, required: false },\n        updateDynamicInterfaces: { default: () => {}, required: false },\n        sidebar: { default: false, required: false },\n        tabindexValue: { default: -1, required: false },\n    },\n    components: {\n        Arrow,\n    },\n    setup(props) {\n        const {\n            el, isConnected, showComponent, startHover, endHover, openSidebar,\n        } =\n            Components.NodeInterface.setup(props);\n\n        const { viewModel } = useViewModel();\n        const { graph } = useGraph();\n\n        props.intf.events.beforeSetValue.unsubscribe(props.intf);\n        props.intf.events.beforeSetValue.subscribe(props.intf, (value, prevent) => {\n            if (viewModel.value.editor.readonly) {\n                prevent();\n            }\n\n            if (\n                (props.intf.min !== undefined && value < props.intf.min) ||\n                (props.intf.max !== undefined && value > props.intf.max)\n            ) {\n                prevent();\n            }\n        });\n\n        if (props.intf.group) {\n            props.toggleGroup(props.intf);\n            props.intf.events.setValue.unsubscribe(props.intf);\n            props.intf.events.setValue.subscribe(props.intf, () => props.toggleGroup(props.intf));\n        }\n\n        if (props.intf.name.endsWith(DYNAMIC_INTERFACE_SUFFIX)) {\n            props.updateDynamicInterfaces(props.intf);\n            props.intf.events.setValue.unsubscribe(props.intf);\n            props.intf.events.setValue.subscribe(props.intf, () =>\n                props.updateDynamicInterfaces(props.intf),\n            );\n        }\n\n        const hovered = ref(false);\n        const startHoverWrapper = () => {\n            hovered.value = true;\n            if (!viewModel.value.editor.readonly) {\n                startHover();\n            }\n        };\n\n        const endHoverWrapper = () => {\n            hovered.value = false;\n            if (!viewModel.value.editor.readonly) {\n                endHover();\n            }\n        };\n\n        const propertyHovered = ref(false);\n        const startPropertyHover = () => {\n            propertyHovered.value = true;\n        };\n\n        const endPropertyHover = () => {\n            propertyHovered.value = false;\n        };\n\n        /* eslint-disable vue/no-mutating-props,no-param-reassign */\n        const onMouseDown = doubleClick(700, () => {\n            if (!viewModel.value.editor.readonly) {\n                props.switchSides(props.intf);\n                endHover();\n            }\n        });\n\n        const displayArrow = props.intf.port && props.intf.direction !== 'inout';\n        const arrowRotation = computed(() => {\n            if (props.intf.direction === 'input') {\n                if (props.intf.side === 'left') {\n                    return 'right';\n                }\n                if (props.intf.side === 'right') {\n                    return 'down';\n                }\n            }\n            if (props.intf.direction === 'output') {\n                if (props.intf.side === 'left') {\n                    return 'down';\n                }\n                if (props.intf.side === 'right') {\n                    return 'right';\n                }\n            }\n            return 'down';\n        });\n\n        const newClasses = computed(() => ({\n            '--input': props.intf.side === 'left',\n            '--output': props.intf.side === 'right',\n            '--connected': isConnected.value,\n            __readonly: viewModel.value.editor.readonly,\n        }));\n\n        const isExposed = computed(() =>\n            props.intf.externalName !== undefined,\n        );\n\n        // External name editing\n        const externalNameComponent = new TextInterface('External name', props.intf.externalName).setPort(false);\n        externalNameComponent.componentName = 'TextInterface';\n\n        const editExternalName = ref(false);\n        const externalNameInputIncorrect = ref(false);\n        const externalNameInput = ref(null);\n        const externalNames = [];\n\n        const inputExternalName = ref(props.intf.externalName);\n\n        /**\n         * Update the list of external names of the interfaces in the current graph.\n         */\n        const updateExternalNames = () => {\n            externalNames.splice(0, externalNames.length);\n            externalNames.push(...graph.value.obtainExposedNames());\n            externalNames.splice(externalNames.indexOf(props.intf.externalName), 1);\n        };\n\n        const enableExternalNameEdit = (e) => {\n            // Get the list of external names of the interfaces in the subgraph\n            updateExternalNames();\n\n            editExternalName.value = true;\n            e.preventDefault();\n\n            // Wait for the next tick to focus the input, so that it is rendered first\n            nextTick().then(() => {\n                externalNameInput.value.focus();\n                externalNameInput.value.select();\n                externalNameInputIncorrect.value = graph.value.isIncorrectExternalName(\n                    props.intf.externalName,\n                    externalNames,\n                );\n            });\n        };\n\n        const externalNameInputCallback = (e) => {\n            externalNameInputIncorrect.value = graph.value.isIncorrectExternalName(\n                e.target.value,\n                externalNames,\n            );\n        };\n\n        const externalNameFocusOutCallback = () => {\n            editExternalName.value = false;\n            externalNameInputIncorrect.value = false;\n            if (inputExternalName.value === props.intf.externalName) return;\n\n            const newExternalName = graph.value.resolveNewExposedName(inputExternalName.value);\n            inputExternalName.value = newExternalName;\n\n            viewModel.value.editor.exposeInterface(\n                graph.value.id,\n                props.intf,\n                newExternalName,\n            );\n        };\n\n        const setValue = () => {\n            if (!props.intf.value) return;\n            if (!(isExposed.value || ir.isRegistered(props.intf.id))) return;\n\n            const { editor } = viewModel.value;\n            const allNodes = Array.from(editor.graphs).map((g) => g.nodes).flat();\n            const allProperties = allNodes.map((n) => Object.entries(n.inputs)).flat()\n                .filter(([key, _]) => key.startsWith('property_'));\n            const exposedProperties = allProperties.map(([_, value]) => value)\n                .filter((prop) => prop.id === props.intf.id);\n\n            // eslint-disable-next-line no-return-assign\n            exposedProperties.forEach((prop) => prop.value = props.intf.value);\n        };\n\n        return {\n            arrowRotation,\n            displayArrow,\n            editExternalName,\n            el,\n            enableExternalNameEdit,\n            endHover,\n            endHoverWrapper,\n            externalNameInput,\n            externalNameInputIncorrect,\n            externalNameInputCallback,\n            externalNameFocusOutCallback,\n            hovered,\n            isConnected,\n            inputExternalName,\n            newClasses,\n            onMouseDown,\n            openSidebar,\n            showComponent,\n            isExposed,\n            startHover,\n            startHoverWrapper,\n            propertyHovered,\n            startPropertyHover,\n            endPropertyHover,\n            setValue,\n        };\n    },\n});\n</script>\n","import { render } from \"./CustomInterface.vue?vue&type=template&id=627f6fce\"\nimport script from \"./CustomInterface.vue?vue&type=script&lang=js\"\nexport * from \"./CustomInterface.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<!--\nCopyright (c) 2022-2024 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!--\nInterface that is used to display inputs, outputs and properties of a node.\n\nThe custom implementations introduces wrapper functions that prevent the user\nfrom creating and deleting connections or altering nodes' values if the editor is read-only.\n-->\n\n<template>\n    <transition name=\"slide-fade\">\n        <div\n            v-show=\"modelValue\"\n            ref=\"el\"\n            class=\"baklava-context-menu\"\n            :class=\"classes\"\n            :style=\"styles\"\n        >\n            <template v-if=\"itemsWithHoverProperty.length === 0\">\n                <div\n                    class=\"readonly item\"\n                    style=\"cursor: default\"\n                >\n                    <div class=\"text\"><i>No resources</i></div>\n                </div>\n            </template>\n            <template v-for=\"(item, index) in itemsWithHoverProperty\">\n                <div\n                    v-if=\"item.url === undefined\"\n                    :key=\"`i-${index}`\"\n                    class=\"item\"\n                    :class=\"{\n                        submenu: !!item.submenu,\n                        '--disabled': !!item.disabled,\n                        hoverbox: !!item.tooltipMsg\n                    }\"\n                    @click.stop=\"(!!item.disabled) ? null : onClick(item)\"\n                    @pointerover=\"onPointerOver(item)\"\n                    @pointerleave=\"onPointerLeave(item)\"\n                >\n                    <div class=\"icon\">\n                        <component v-if=\"item.icon !== undefined\" :is=\"item.icon\"></component>\n                    </div>\n                    <div class=\"text\">{{ item.label }}</div>\n                    <div :class=\"'tooltip'\">\n                        <span> {{ item.tooltipMsg }}</span>\n                    </div>\n                </div>\n                <a\n                    v-else\n                    :key=\"item.name\"\n                    :href=\"item.url\"\n                    class=\"item\"\n                    target=\"_blank\"\n                    draggable=\"false\"\n                    @click.stop=\"onClick(item)\"\n                >\n                    <div class=\"icon\">\n                        <img\n                            v-if=\"getIconPath(item.icon) !== undefined\"\n                            :src=\"getIconPath(item.icon)\"\n                            :alt=\"item.name\"\n                            draggable=\"false\"\n                        />\n                    </div>\n                    <div class=\"text\">{{ item.name }}</div>\n                </a>\n                <hr v-if=\"item.endSection\" :key=\"`hr-${index}`\" />\n            </template>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport {\n    defineComponent, ref, onMounted, nextTick,\n} from 'vue';\nimport { Components, useViewModel } from '@baklavajs/renderer-vue';\n\nexport default defineComponent({\n    extends: Components.ContextMenu,\n    props: {\n        urls: {\n            required: false,\n            default: [],\n        },\n    },\n    emits: ['update:modelValue', 'click', 'sizeUpdate', 'onpointerover', 'onpointerleave'],\n    setup(props, context) {\n        const {\n            el,\n            styles,\n            classes,\n            itemsWithHoverProperty,\n        } = // eslint-disable-line object-curly-newline\n            Components.ContextMenu.setup(props, context);\n\n        const { viewModel } = useViewModel();\n        const getIconPath = (name) => viewModel.value.cache[`./${name}`] ?? name;\n\n        const justOpened = ref(true);\n\n        onMounted(async () => {\n            await nextTick();\n            const size = el.value.getBoundingClientRect();\n            context.emit('sizeUpdate', size);\n        });\n\n        const closeContextMenu = (ev) => {\n            if (props.modelValue === true) {\n                // We need a counter so that this event is not fired right when the menu is opened\n                if (justOpened.value === false) {\n                    const elements = document.elementsFromPoint(ev.clientX, ev.clientY);\n                    // We only need to fire closing event if the click was\n                    // outside of the context menu. Otherwise `onClick` is fired.\n                    if (!elements.includes(el.value)) {\n                        window.removeEventListener('wheel', closeContextMenu);\n                        window.removeEventListener('pointerdown', closeContextMenu);\n                        context.emit('update:modelValue', false);\n                    }\n                    justOpened.value = true;\n                } else {\n                    justOpened.value = false;\n                }\n            }\n        };\n\n        window.addEventListener('wheel', closeContextMenu);\n        window.addEventListener('pointerdown', closeContextMenu);\n\n        const onClick = (item) => {\n            context.emit('click', item.value);\n            context.emit('update:modelValue', false);\n        };\n\n        const onPointerOver = (item) => {\n            if (item.onPointerEmit) {\n                context.emit('pointerover', item);\n            }\n        };\n\n        const onPointerLeave = (item) => {\n            if (item.onPointerEmit) {\n                context.emit('pointerleave', item);\n            }\n        };\n\n        return {\n            el,\n            styles,\n            classes,\n            itemsWithHoverProperty,\n            onClick,\n            getIconPath,\n            onPointerOver,\n            onPointerLeave,\n        };\n    },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n\n.dropdown-wrapper {\n    user-select: none;\n    position: absolute;\n    flex-direction: column;\n    top: 100%;\n    left: 0;\n    display: none;\n    background-color: #181818;\n    border: 2px solid #737373;\n\n    & > div:hover {\n        background-color: #2A2A2A;\n    }\n}\n\n.tooltip {\n    @extend .dropdown-wrapper;\n    border-radius: 15px;\n    background-color: $gray-600;\n    border: 1px solid $gray-200;\n    padding: $spacing-s;\n    top: 0;\n    left: 100%;\n    transform: translate(10px);\n    pointer-events: none;\n    white-space: nowrap;\n    color: #fff;\n    display: none;\n}\n\n.hoverbox:hover {\n    & > .tooltip {\n        display: flex;\n        z-index: 11;\n    }\n}\n\n</style>\n","import { render } from \"./ContextMenu.vue?vue&type=template&id=02cc508d&scoped=true\"\nimport script from \"./ContextMenu.vue?vue&type=script&lang=js\"\nexport * from \"./ContextMenu.vue?vue&type=script&lang=js\"\n\nimport \"./ContextMenu.vue?vue&type=style&index=0&id=02cc508d&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-02cc508d\"]])\n\nexport default __exports__","/*\n * Copyright (c) 2022-2025 Antmicro <www.antmicro.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { GraphTemplate as BaklavaGraphTemplate } from '@baklavajs/core';\n\nexport default class GraphTemplate extends BaklavaGraphTemplate {\n    _name = '';\n\n    constructor(state, editor) {\n        super(state, editor);\n        if (state.name) this.name = state.name;\n    }\n}\n","/*\n * Copyright (c) 2022-2024 Antmicro <www.antmicro.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n */\n\n/*\n * Custom pipeline editor - Implements logic for adding, removing, editing nodes and\n * connections between them.\n * Inherits from baklavajs/core/src/editor.ts\n */\n\n/* eslint-disable max-classes-per-file */\n\nimport { Editor, Graph } from '@baklavajs/core';\n\nimport { useGraph } from '@baklavajs/renderer-vue';\n\nimport { nextTick } from 'vue';\nimport createPipelineManagerGraph from './CustomGraph.js';\nimport LayoutManager from '../core/LayoutManager.js';\nimport { suppressHistoryLogging } from '../core/History.ts';\nimport CreateCustomGraphNodeType, { prepareSubgraphInstance } from './CustomGraphNode.js';\nimport { ir } from '../core/interfaceRegistry.ts';\n\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-underscore-dangle */\nexport default class PipelineManagerEditor extends Editor {\n    preview = false;\n\n    _hideHud = false;\n\n    get hideHud() {\n        return this._hideHud || this.preview;\n    }\n\n    set hideHud(val) {\n        this._hideHud = val;\n    }\n\n    _readonly = false;\n\n    get readonly() {\n        return this._readonly || this.preview;\n    }\n\n    set readonly(val) {\n        this._readonly = val;\n    }\n\n    allowLoopbacks = false;\n\n    nodeIcons = new Map();\n\n    nodeColors = new Map();\n\n    baseURLs = new Map();\n\n    baseIconUrls = new Map();\n\n    nodeURLs = new Map();\n\n    nodeStyles = new Map();\n\n    layoutManager = new LayoutManager();\n\n    subgraphStack = [];\n\n    parentNodes = new Map();\n\n    // node types created in visual-editor\n    additionalNodeTypes = new Set();\n\n    subgraphStackGraphTypeEnum = {\n        SUBGRAPH: 'subgraph',\n        RELATEDGRAPH: 'relatedGraph',\n    };\n\n    editorManager = null;\n\n    newRootGraph = undefined;\n\n    registerGraph(graph) {\n        const customGraph = createPipelineManagerGraph(graph);\n        super.registerGraph(customGraph);\n    }\n\n    /**\n     * Saves the state (nodes, connections, layout) of the current graph and its subgraphs.\n     * @return {Object} State of the current graph and its subgraphs.\n     * @throws {Error} Throws if there are issues switching to a subgraph.\n     */\n    save() {\n        const subgraphStackFrames = [];\n        while (this.isInSubgraph()) {\n            if (this._graph.graphNode === undefined) {\n                subgraphStackFrames.push({\n                    type: this.subgraphStackGraphTypeEnum.RELATEDGRAPH,\n                    frame: this._graph.id,\n                });\n            } else {\n                subgraphStackFrames.push({\n                    type: this.subgraphStackGraphTypeEnum.SUBGRAPH,\n                    frame: this._graph.graphNode,\n                });\n            }\n            this.backFromSubgraph();\n        }\n\n        // Save all changes done to subgraphs before saving.\n        let currentGraphId = this._graph.id;\n        let currentGraphState = this.graph.save();\n        currentGraphState.panning = this._graph.panning;\n        currentGraphState.scaling = this._graph.scaling;\n\n        if (this.newRootGraph !== undefined) {\n            currentGraphId = this.newRootGraph.id;\n            currentGraphState = this.newRootGraph.save();\n        }\n\n        const dataflowState = { graphs: [] };\n\n        // Subgraphs are stored in state.subgraphs; there is no need to store it\n        // in nodes themselves.\n        const recurrentSubgraphSave = (node) => {\n            if (node.subgraph !== undefined) {\n                dataflowState.graphs.push(node.graphState);\n                node.graphState.nodes.forEach(recurrentSubgraphSave);\n            }\n            delete node.graphState;\n        };\n        currentGraphState.nodes.forEach(recurrentSubgraphSave);\n        this.nodeTypes.forEach((node, _) => {\n            node.relatedGraphs?.forEach(({ id }) => {\n                const graphObject = Array.from(this.graphs).find((el) => id === el.id);\n                if (graphObject && !dataflowState.graphs.find((el) => el.id === graphObject.id)) {\n                    dataflowState.graphs.push(graphObject.save());\n                }\n            });\n        });\n\n        currentGraphState.nodes.forEach((node) => {\n            node.color = this.getNodeColor(node);\n        });\n\n        /* eslint-enable no-unused-vars */\n        if (dataflowState.graphs.length) {\n            dataflowState.entryGraph = currentGraphId;\n        }\n\n        dataflowState.graphs = [currentGraphState, ...dataflowState.graphs];\n\n        subgraphStackFrames.reverse().forEach(({ frame, type }) => {\n            switch (type) {\n                case this.subgraphStackGraphTypeEnum.RELATEDGRAPH:\n                    this.switchToRelatedGraph(frame);\n                    break;\n                case this.subgraphStackGraphTypeEnum.SUBGRAPH:\n                    this.switchToSubgraph(frame);\n                    break;\n                default:\n                    break;\n            }\n        });\n\n        return dataflowState;\n    }\n\n    /**\n     * Cleans all graphs in the editor.\n     * @param Determines whether the cleaning process should be stored in history\n     */\n    deepCleanEditor(suppressHistory = true) {\n        this.subgraphStack.forEach(this.backFromSubgraph.bind(this));\n        this.cleanEditor(suppressHistory);\n        this.graphName = undefined;\n    }\n\n    /**\n     * Cleans up the current graph current graph editor.\n     * @param {bool} suppressHistory Determines whether the cleaning process should\n     * be stored in history.\n     */\n    cleanEditor(suppressHistory = true) {\n        while (this.isInSubgraph()) {\n            this.backFromSubgraph();\n        }\n        const graphInstance = this._graph;\n\n        suppressHistoryLogging(suppressHistory);\n        for (let i = graphInstance.connections.length - 1; i >= 0; i -= 1) {\n            graphInstance.removeConnection(graphInstance.connections[i]);\n        }\n        for (let i = graphInstance.nodes.length - 1; i >= 0; i -= 1) {\n            graphInstance.removeNode(graphInstance.nodes[i]);\n        }\n        suppressHistoryLogging(false);\n    }\n\n    unregisterGraphs() {\n        [...this.graphs]\n            .filter((graph) => graph !== this._graph)\n            .forEach((graph) => this.unregisterGraph(graph));\n        this.subgraphStack = [];\n    }\n\n    unregisterNodes() {\n        this.nodeTypes.forEach((_, nodeKey) => {\n            this.unregisterNodeType(nodeKey);\n        });\n    }\n\n    registerNodeType(type, options) {\n        if (this.events.beforeRegisterNodeType.emit({ type, options }).prevented) {\n            return;\n        }\n\n        const nodeInstance = new type(); // eslint-disable-line new-cap\n        this._nodeTypes.set(nodeInstance.type, {\n            type,\n            category: options?.category ?? 'default',\n            title: options?.title ?? nodeInstance.title,\n            isCategory: options?.isCategory ?? false,\n            color: options?.color,\n            subgraphId: options?.subgraphId,\n            relatedGraphs: options?.relatedGraphs,\n            style: options?.style,\n            pill: options?.pill,\n        });\n\n        this.events.registerNodeType.emit({ type, options });\n    }\n\n    /**\n     * Loads the dataflow into the editor.\n     *\n     * @param state dataflow to load\n     * @param {bool} preventCentering determines whether to center the graph after loading\n     * @param {bool} loadOnly determines whether to load the graph only without adjusting\n     * the graph rendering. Can be used when validating graphs without their browser\n     * representation.\n     * @param templateName {string|null} name of the template, if the graph is a template\n     * @returns list of errors that occurred during loading\n     */\n    async load(\n        state, preventCentering = false, loadOnly = false, templateName = null,\n    ) {\n        // All subgraphs should be unregistered to avoid conflicts later when trying to\n        // load into subgraph (in that case there may be two subgraphs with the same ID, one\n        // of them from the previous session).\n        this.unregisterGraphs();\n        ir.clearRegistry();\n\n        // Load the node state as it is, wait until vue renders new nodes so that\n        // node dimensions can be retrieved from DOM elements and then update the\n        // location based on autolayout results. The editor is set to readonly\n        // during loading to prevent any changes that may happen between graph load\n        // and layout computation\n        const readonlySetting = this.readonly;\n        this.readonly = true;\n        const errors = [];\n\n        if (!state.graphs.length) {\n            return ['No graphs found'];\n        }\n\n        let entryGraph;\n        if (state.entryGraph) {\n            entryGraph = state.graphs.find(\n                (graph) => graph.id === state.entryGraph,\n            );\n\n            if (!entryGraph) {\n                return [`No entry graph found of id '${state.entryGraph}'`];\n            }\n        } else {\n            entryGraph = state.graphs[0]; // eslint-disable-line prefer-destructuring\n        }\n        const { panning, scaling } = entryGraph;\n\n        const usedSubgraphs = new Set();\n\n        this.nodeColors.clear();\n        state.graphs.forEach((graph) => {\n            graph.nodes.forEach((n) => {\n                if (n.subgraph !== undefined) {\n                    const fittingTemplate = state.graphs.filter(\n                        (template) => template.id === n.subgraph,\n                    );\n                    if (fittingTemplate.length !== 1) {\n                        errors.push([`Expected exactly one template with ID ${n.name}, got ${fittingTemplate.length}`]);\n                    }\n                    usedSubgraphs.add(n.subgraph);\n\n                    const { subgraphId } = this.nodeTypes.get(n.name) ?? {};\n                    const isInstantiated = n.subgraph !== subgraphId;\n                    if (isInstantiated || subgraphId === undefined) {\n                        [n.graphState] = fittingTemplate;\n                    }\n                }\n                n.relatedGraphs\n                    ?.filter(({ id }) => state.graphs.find((el) => el.id === id) === undefined)\n                    .forEach(({ id }) => errors.push([`The related graph of id ${id} is not defined`]));\n                this.setNodeColor(n.id, n.color);\n            });\n        });\n\n        try {\n            if (errors.length) return errors;\n\n            state.graphs?.forEach((graph) => {\n                if (!usedSubgraphs.has(graph.id) && entryGraph.id !== graph.id) {\n                    const graphObject = new Graph(this);\n                    errors.push(...graphObject.load(graph));\n                    this.registerGraph(graphObject);\n                }\n            });\n\n            if (!errors.length) {\n                let graphToLoad;\n                if (!templateName) {\n                    state = this.hooks.load.execute(state);\n                    graphToLoad = entryGraph;\n                } else {\n                    // eslint-disable-next-line new-cap\n                    const graphNode = new (this._nodeTypes.get(templateName)).type();\n                    const {\n                        state: preparedSubgraphState, errors: prepareSubgraphErrors,\n                    } = prepareSubgraphInstance(graphNode.template);\n                    errors.push(...prepareSubgraphErrors);\n                    graphToLoad = preparedSubgraphState;\n                }\n                if (!errors.length) errors.push(...this._graph.load(graphToLoad));\n            }\n        } catch (err) {\n            // If anything goes wrong during dataflow loading, the editor is cleaned and an\n            // appropriate error is returned.\n            this.cleanEditor();\n            this.readonly = readonlySetting;\n            return [err.toString()];\n        }\n        if (Array.isArray(errors) && errors.length && process.env.VUE_APP_GRAPH_DEVELOPMENT_MODE !== 'true') {\n            this.cleanEditor();\n            this.readonly = readonlySetting;\n            return errors;\n        }\n        this.events.loaded.emit();\n        this.graphName = entryGraph.name;\n        this.readonly = readonlySetting;\n\n        // If the editor is run outside of a browser, then\n        // all functionality that is after this line will fail,\n        // as it changes the way the graph is rendered in the browser\n        if (typeof window === 'undefined' || loadOnly) return errors;\n\n        const dfs = (subgraph, path) => {\n            if (subgraph?.nodes !== undefined) {\n                for (let i = 0; i < subgraph.nodes.length; i += 1) {\n                    if (subgraph.nodes[i].subgraph !== undefined) {\n                        if (subgraph.nodes[i].subgraph.id === entryGraph.id) {\n                            return [...path, subgraph.nodes[i]];\n                        }\n                        const returnedPath = dfs(\n                            subgraph.nodes[i].subgraph,\n                            [...path, subgraph.nodes[i]],\n                        );\n                        if (returnedPath.length) {\n                            return returnedPath;\n                        }\n                    }\n                }\n            }\n            return [];\n        };\n\n        // Finding a path to the defined entry and switching to it sequentially\n        const path = dfs(this._graph, []);\n\n        try {\n            path.forEach((node) => {\n                this.switchToSubgraph(node);\n            });\n        } catch (err) {\n            errors.push(err.toString());\n        }\n\n        if (this.layoutManager.layoutEngine.activeAlgorithm !== 'NoLayout') {\n            await nextTick();\n            await this.applyAutolayout(false);\n        }\n\n        // We need graph switched and sidebar rendered for autozoom\n        await nextTick();\n        if (panning !== undefined) {\n            this._graph.panning = panning;\n        }\n        if (scaling !== undefined) {\n            this._graph.scaling = scaling;\n        }\n        if (!preventCentering && scaling === undefined && panning === undefined) {\n            this.centerZoom();\n        }\n        return errors;\n    }\n\n    privatizeInterface(graphId, intf) {\n        if (intf.externalName === undefined) return;\n\n        let graph = [...this.graphs].find((g) => g.id === graphId);\n        let graphNode = graph.graphNode; // eslint-disable-line prefer-destructuring\n\n        intf.externalName = undefined;\n        if (graphNode === undefined) return;\n\n        const { graphIds, sharedInterface } = ir.getRegisteredInterface(intf.id);\n        const graphIdIdx = graphIds.findIndex((id) => id === graphNode.graph.id);\n        graphIds.splice(graphIdIdx, graphIds.length - graphIdIdx);\n\n        graphNode.updateExposedInterfaces(undefined, undefined, true);\n\n        // Update all graphs that used this exposed interface\n        for (let i = graphIdIdx + 1; i < graphIds.length; i += 1) {\n            graph = [...this.graphs].find((g) => g.id === graphIds[graphIdIdx]);\n            graphNode = graph.graphNode; // eslint-disable-line prefer-destructuring\n            graphNode.updateExposedInterfaces(undefined, undefined, true);\n        }\n\n        // If sharedInterface is the same as the interface that is privatized, it means\n        // that the interface is not shared anymore and its entry should be deleted.\n        if (sharedInterface === intf) {\n            ir.deleteRegisteredInterface(intf.id);\n        }\n    }\n\n    /**\n     * Exposes passed interface under the `name` name. The node that has the interface has to\n     * be in the graph with the `graphId` ID.\n     *\n     * @param {string} graphId graph which has the node with the interface\n     * @param {Object} intf interface to expose\n     * @param {string} name name under which the interface will be exposed. If set to `undefined`,\n     * external name will be inferred from the name of the interface.\n     */\n    exposeInterface(graphId, intf, name = undefined) {\n        const graph = [...this.graphs].find((g) => g.id === graphId);\n        const graphNode = graph.graphNode; // eslint-disable-line prefer-destructuring\n        intf.externalName = name ?? graph.resolveNewExposedName(intf.name);\n        if (graphNode === undefined) return;\n        // After changing the external name, the interface has to be updated in the\n        // graph node to reflect the changes in the graph.\n        graphNode.updateExposedInterfaces();\n    }\n\n    /**\n     * Iterates over all nodes of the currently displayed graph\n     * to find all exposed properties in the graph.\n     *\n     * @returns {Array} list of exposed properties in displayed graph\n     */\n    getExposedProperties() {\n        return this._graph.nodes\n            .map((n) => Object.values(n.inputs)).flat()\n            .filter((intf) => !intf.port && intf.externalName);\n    }\n\n    /**\n     * Calculates the width, height of the editor and the width of the sidebar.\n     * It is assumed that the view is rendered in the browser,\n     * otherwise an error will be thrown.\n     *\n     * @returns {Object} object with calculated sizes\n     */\n    static editorSize() {\n        if (typeof document === 'undefined') {\n            throw new Error('The editor is in browserless mode. Cannot obtain editor size.');\n        }\n\n        const terminalHeight =\n            document.getElementsByClassName('terminal-wrapper')[0]?.offsetHeight ?? 0;\n        const navbarHeight = document.getElementsByClassName('wrapper')[0]?.offsetHeight ?? 0;\n        const nodePalette = document.getElementsByClassName('baklava-node-palette');\n        let sideBarWidth = 0;\n        if (nodePalette.length !== 0) {\n            const paletteRect = nodePalette[0].getBoundingClientRect();\n            sideBarWidth = Math.max(paletteRect.right, 0);\n        }\n\n        const editorHeight = window.innerHeight - terminalHeight - navbarHeight;\n        const editorWidth = window.innerWidth - sideBarWidth;\n\n        return {\n            editorWidth,\n            editorHeight,\n            sideBarWidth,\n        };\n    }\n\n    /**\n     * Centers the currently displayed graph in the editor.\n     * The function calculates the scaling and panning values to center the graph\n     * in the editor and sets them in the graph.\n     * The function assumes that the editor is rendered in the browser,\n     * otherwise an error will be thrown.\n     */\n    centerZoom() {\n        if (!Array.isArray(this._graph.nodes) || this._graph.nodes.length === 0) return;\n        if (typeof document === 'undefined') {\n            throw new Error('The editor is in browserless mode. Cannot obtain editor size.');\n        }\n\n        const {\n            editorWidth,\n            editorHeight,\n            sideBarWidth,\n        } = PipelineManagerEditor.editorSize();\n\n        const {\n            graphHeight,\n            graphWidth,\n            leftmostX,\n            topmostY,\n        } = this._graph.size();\n\n        const margin = 100;\n\n        const scalingY = editorHeight / (graphHeight + 2 * margin);\n        const scalingX = editorWidth / (graphWidth + 2 * margin);\n\n        if (scalingX > scalingY) {\n            const graphCenter = (graphWidth + 2 * margin) / 2;\n            const editorCenter = (editorWidth / 2) * (1 / scalingY);\n\n            const translationX = editorCenter - graphCenter;\n\n            this._graph.panning = {\n                x: -(leftmostX - margin - translationX - sideBarWidth / scalingY),\n                y: -(topmostY - margin),\n            };\n            this._graph.scaling = scalingY;\n        } else {\n            const graphCenter = (graphHeight + 2 * margin) / 2;\n            const editorCenter = (editorHeight / 2) * (1 / scalingX);\n\n            const translationY = editorCenter - graphCenter;\n\n            this._graph.panning = {\n                x: -(leftmostX - margin - sideBarWidth / scalingX),\n                y: -(topmostY - margin - translationY),\n            };\n            this._graph.scaling = scalingX;\n        }\n    }\n\n    nodeURLsEmpty() {\n        return this.nodeURLs.size === 0;\n    }\n\n    getNodeURLs(nodeName) {\n        const urls = this.nodeURLs.get(nodeName) || {};\n\n        const fullUrls = [];\n        Object.entries(urls).forEach(([urlName, url]) => {\n            const t = { ...this.baseURLs.get(urlName) };\n            t.url += url;\n            fullUrls.push(t);\n        });\n\n        return fullUrls;\n    }\n\n    getNodeIconPath(nodeName) {\n        return this.nodeIcons.get(nodeName) || undefined;\n    }\n\n    getPillText(nodeName) {\n        const nodeType = this.nodeTypes.get(nodeName);\n        if (nodeType?.pill !== undefined) return nodeType.pill?.text;\n        if (nodeType?.style !== undefined) return this.getNodeStyle(nodeType.style)?.pill?.text;\n        return undefined;\n    }\n\n    getNodeCategory(nodeName) {\n        return this.nodeTypes.get(nodeName).category || undefined;\n    }\n\n    getNodeColor(node) {\n        const nodeColor = this.nodeColors.get(node.id);\n        if (nodeColor !== undefined) return nodeColor;\n\n        const nodeType = this.nodeTypes.get(node.type);\n        if (nodeType?.color !== undefined) return nodeType.color;\n        if (nodeType?.style !== undefined) return this.getNodeStyle(nodeType.style)?.color;\n        return undefined;\n    }\n\n    setNodeColor(nodeId, color) {\n        if (color !== undefined) {\n            this.nodeColors.set(nodeId, color);\n        }\n    }\n\n    getStyleIcon(nodeName) {\n        const nodeType = this.nodeTypes.get(nodeName);\n        if (nodeType?.style !== undefined) return this.getNodeStyle(nodeType.style)?.icon;\n        return undefined;\n    }\n\n    getNodeStyle(style) {\n        if (!Array.isArray(style)) {\n            style = [style];\n        }\n\n        return Object.assign({}, ...style\n            .map((styleName) => this.nodeStyles.get(styleName))\n            .filter((value) => value !== undefined));\n    }\n\n    getPillColor(nodeName) {\n        const nodeType = this.nodeTypes.get(nodeName);\n        const pill = nodeType?.pill !== undefined\n            ? nodeType.pill\n            : this.getNodeStyle(nodeType.style).pill;\n        if (pill !== undefined) return pill.color ?? '#ffffff';\n        return undefined;\n    }\n\n    /* eslint-disable class-methods-use-this */\n    getTextColor(color) {\n        if (!color) {\n            return 'white';\n        }\n        // calculate lightness\n        const rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(color);\n        const r = parseInt(rgb[1], 16) / 255;\n        const g = parseInt(rgb[2], 16) / 255;\n        const b = parseInt(rgb[3], 16) / 255;\n        const lightness = (Math.max(r, g, b) + Math.min(r, g, b)) / 2;\n\n        if (lightness > 0.5) {\n            return 'black';\n        }\n\n        return 'white';\n    }\n\n    isGraphNode(nodeName) {\n        if (!this.nodeTypes.has(nodeName)) return false;\n        return this.nodeTypes.get(nodeName).subgraphId !== undefined;\n    }\n\n    nodeHasRelatedGraphs(node) {\n        return (node.relatedGraphs ?? this.nodeTypes.get(node.type)?.relatedGraphs) !== undefined;\n    }\n\n    addGraphTemplate(template, graphNode) {\n        if (this.events.beforeAddGraphTemplate.emit(template).prevented) {\n            return;\n        }\n        this._graphTemplates.push(template);\n        this.graphTemplateEvents.addTarget(template.events);\n        this.graphTemplateHooks.addTarget(template.hooks);\n\n        const customGraphNodeType = CreateCustomGraphNodeType(template, graphNode);\n        this.registerNodeType(customGraphNodeType, {\n            category: graphNode.category,\n            title: graphNode.title,\n            isCategory: graphNode.isCategory,\n            color: graphNode.color,\n            style: graphNode.style,\n            pill: graphNode.pill,\n            subgraphId: graphNode.subgraphId,\n            relatedGraphs: graphNode?.relatedGraphs,\n        });\n\n        this.events.addGraphTemplate.emit(template);\n    }\n\n    switchGraph(subgraphNode) {\n        if (this._switchGraph === undefined) {\n            const { switchGraph } = useGraph();\n            this._switchGraph = switchGraph;\n        }\n        // disable history logging for the switch - don't push nodes being created here\n        suppressHistoryLogging(true);\n\n        if (subgraphNode.subgraph === undefined) {\n            throw Error(\n                `Node \"${subgraphNode.name}\" does contain a subgraph.`,\n            );\n        }\n        this._graph = subgraphNode.subgraph;\n        this._switchGraph(subgraphNode.subgraph);\n        this.graphName = this._graph.name;\n\n        suppressHistoryLogging(false);\n        nextTick().then(() => {\n            const graph = this.graph.save();\n            this.layoutManager.registerGraph(graph);\n            this.layoutManager\n                .computeLayout(graph)\n                .then(this.updateNodesPosition.bind(this))\n                .then(() => {\n                    nextTick().then(() => {\n                        if (\n                            !this._graph.wasCentered\n                        ) {\n                            this.centerZoom();\n                            this._graph.wasCentered = true;\n                        }\n                    });\n                });\n        });\n    }\n\n    /**\n    * Switch to a subgraph by obtaining the current graph from the subgraph node\n    * and pushing the subgraph node to the stack.\n    *\n    * @param {Node} subgraphNode A subgraph node containing a subgraph,\n    * to which a layout should be switched.\n    * */\n    switchToSubgraph(subgraphNode) {\n        if (subgraphNode && subgraphNode.subgraph) {\n            this.subgraphStack.push(subgraphNode.graph);\n            this.switchGraph(subgraphNode);\n        }\n    }\n\n    /**\n    * Switch to a given graph object.\n    *\n    * @param {object} targetGraph A graph object to which the layout should be switched\n    * @param {bool} subgraphStack Determines whether the graph should be added to subgraph stack\n    * */\n    switchToGraph(targetGraph, subgraphStack = false) {\n        if (!targetGraph) return;\n\n        if (this._switchGraph === undefined) {\n            const { switchGraph } = useGraph();\n            this._switchGraph = switchGraph;\n        }\n        // disable history logging for the switch - don't push nodes being created here\n        suppressHistoryLogging(true);\n\n        if (subgraphStack) {\n            this.subgraphStack.push(this._graph);\n        } else if (this.subgraphStack.length > 0) {\n            this.subgraphStack.pop();\n        }\n        this._graph = targetGraph;\n        this._switchGraph(this._graph);\n        this.graphName = this._graph.name;\n\n        nextTick().then(() => {\n            const graph = this.graph.save();\n            this.layoutManager.registerGraph(graph);\n            this.layoutManager\n                .computeLayout(graph)\n                .then(this.updateNodesPosition.bind(this))\n                .then(() => {\n                    nextTick().then(() => {\n                        if (\n                            !this._graph.wasCentered\n                        ) {\n                            this.centerZoom();\n                            this._graph.wasCentered = true;\n                        }\n                    });\n                });\n        });\n\n        suppressHistoryLogging(false);\n    }\n\n    /**\n    * Switch to a related by matching the ID to a loaded graph instancce\n    * and pushing the current graph to the stack.\n    *\n    * @param {relatedGraphID} An ID of the graph, to which a layout should be switched.\n    * */\n    switchToRelatedGraph(relatedGraphID) {\n        if (this.editorManager?.baklavaView.displayedGraph.id === relatedGraphID) return;\n        const relatedGraph = Array.from(this.graphs).find((item) => item.id === relatedGraphID);\n        this.switchToGraph(relatedGraph, true);\n    }\n\n    /**\n     * Switches back from a displayed graph.\n     * The function changes the currently displayed graph and propagates changes in interfaces\n     * back to the graph node.\n     *\n     * It also updates the graph node's interfaces to match the ones in the graph.\n     * It checks for existing interface nodes, checks which were added, removed and changed\n     * and updates the graph node's interfaces accordingly.\n     */\n    backFromSubgraph() {\n        const newGraph = this.subgraphStack.pop(); // eslint-disable-line no-unused-vars\n\n        suppressHistoryLogging(true);\n\n        this._graph = newGraph;\n        this._switchGraph(this._graph);\n        this.graphName = this._graph.name;\n\n        suppressHistoryLogging(false);\n    }\n\n    /**\n    * Changes top level graph to one of the other graphs in the editor.\n    *\n    * @param {string} graphId ID of the new top level graph.\n    * */\n    changeTopLevelGraph(graphId) {\n        const rootGraph = Array.from(this.graphs).find((graph) => graph.id === graphId);\n        this.newRootGraph = rootGraph;\n    }\n\n    findInterface(intfId) {\n        for (let i = 0; i < this.graph.nodes.length; i += 1) {\n            const foundIntf = Object.values(this.graph.nodes[i].inputs).concat(\n                Object.values(this.graph.nodes[i].outputs),\n            ).find(\n                (intf) => intf.id === intfId,\n            );\n            if (foundIntf) return foundIntf;\n        }\n        return null;\n    }\n\n    unwrapSubgraph(node) {\n        const subgraphNodes = Object.values(node.subgraph._nodes);\n        // Calculate center point of subgraph nodes\n        const meanX = subgraphNodes.map((n) => n.position.x).reduce(\n            (sum, value) => sum + value, 0,\n        ) / subgraphNodes.length;\n        const meanY = subgraphNodes.map((n) => n.position.y).reduce(\n            (sum, value) => sum + value, 0,\n        ) / subgraphNodes.length;\n        // Remove selections\n        this.graph.selectedNodes = [];\n        // Create, reposition and select subgraph nodes\n        subgraphNodes.forEach((subgraphNode) => {\n            const state = subgraphNode.save();\n            const addedNode = this.graph.addNode(subgraphNode);\n            if (addedNode) {\n                // Set position relative to removed node\n                addedNode.position.x += node.position.x - meanX;\n                addedNode.position.y += node.position.y - meanY;\n                this.graph.selectedNodes.push(addedNode);\n                // Reset connections count\n                Object.values(addedNode.inputs).concat(\n                    Object.values(addedNode.outputs),\n                ).forEach(\n                    (intf) => { intf.connectionCount = 0; },\n                );\n                addedNode.load(state);\n            }\n        });\n\n        const subgraphNodeConnections = this.graph.connections.filter(\n            (c) => c.from.nodeId === node.id || c.to.nodeId === node.id,\n        );\n        this.graph.removeNode(node);\n        Object.values(node.subgraph.connections).concat(\n            subgraphNodeConnections,\n        ).forEach((connection) => {\n            if (connection.from.name === 'Connection' || connection.to.name === 'Connection') { return; }\n\n            // Finding interfaces in newly added nodes that correspond to the ones in the connection\n            const fromInterface = this.findInterface(connection.from.id);\n            const toInterface = this.findInterface(connection.to.id);\n\n            if (fromInterface && toInterface) {\n                const createdConnection = this.graph.addConnection(fromInterface, toInterface);\n                (connection.anchors ?? []).forEach((anchor, index) => {\n                    let newAnchor;\n                    // Only anchors from within the graph node should be shifted\n                    if (node.subgraph.connections.includes(connection)) {\n                        newAnchor = {\n                            x: anchor.x + node.position.x - meanX,\n                            y: anchor.y + node.position.y - meanY,\n                        };\n                    } else {\n                        newAnchor = {\n                            x: anchor.x,\n                            y: anchor.y,\n                        };\n                    }\n\n                    this.graph.addAnchor(newAnchor, createdConnection, index);\n                });\n            }\n        });\n    }\n\n    isInSubgraph() {\n        return this.subgraphStack.length > 0;\n    }\n\n    async applyAutolayout(resetLocations = true) {\n        const state = this.graph.save();\n        if (resetLocations) {\n            state.nodes.forEach((node) => {\n                node.position = undefined;\n            });\n        }\n        this.layoutManager.registerGraph(state);\n        const updatedGraph = await this.layoutManager.computeLayout(state);\n        this.updateNodesPosition(updatedGraph);\n    }\n\n    updateNodesPosition(updatedGraph) {\n        updatedGraph.nodes.forEach((updatedState) => {\n            const node = this.graph.nodes.filter(\n                (nodeInstance) => updatedState.id === nodeInstance.id,\n            )[0];\n            node.position = updatedState.position;\n        });\n    }\n\n    updateCurrentSubgraphName(name) {\n        this._graph.name = name;\n    }\n}\n","/*\n * Copyright (c) 2022-2024 Antmicro <www.antmicro.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Implements custom version of baklava's Graph object\n */\n\nimport { DummyConnection, Connection } from '@baklavajs/core';\nimport { v4 as uuidv4 } from 'uuid';\nimport { BaklavaEvent } from '@baklavajs/events';\nimport { toRaw } from 'vue';\nimport { startTransaction, commitTransaction } from '../core/History.ts';\nimport { updateInterfacePosition } from './CustomNode.js';\nimport GraphTemplate from './CustomGraphTemplate.js';\n\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-underscore-dangle */\nexport default function createPipelineManagerGraph(graph) {\n    // Add an event for adding an anchor to the graph\n    graph.events.addAnchor = new BaklavaEvent();\n    graph.events.removeAnchor = new BaklavaEvent();\n\n    // Add an event for editing node\n    graph.events.editNode = new BaklavaEvent();\n\n    // Graph node that represents the graph itself. Root graph does not have a node graph assigned.\n    graph.graphNode = undefined;\n\n    graph.checkConnection = function checkConnection(from, to) {\n        if (!from || !to) {\n            return { connectionAllowed: false, error: 'Invalid from and to references.' };\n        }\n\n        const fromNode = this.findNodeById(from.nodeId);\n        const toNode = this.findNodeById(to.nodeId);\n\n        if (fromNode && toNode && fromNode === toNode && !this.editor.allowLoopbacks) {\n            return { connectionAllowed: false, error: 'Loopbacks are not allowed.' };\n        }\n\n        // reverse connection so that 'from' is input and 'to' is output\n        if (\n            (from.direction === 'input' && to.direction === 'output') ||\n            (from.direction === 'input' && to.direction === 'inout') ||\n            (from.direction === 'inout' && to.direction === 'output')\n        ) {\n            const tmp = from;\n            from = to;\n            to = tmp;\n        }\n\n        if (from.isInput && from.direction !== 'inout') {\n            return {\n                connectionAllowed: false,\n                error: 'Connections are only allowed from output or inout interfaces.',\n            };\n        }\n\n        if (!to.isInput) {\n            return {\n                connectionAllowed: false,\n                error: 'Connections are only allowed to input or inout interfaces.',\n            };\n        }\n\n        if (this.connections.some((c) => c.from === from && c.to === to)) {\n            return { connectionAllowed: false, error: 'Duplicate connections are not allowed.' };\n        }\n\n        if (from.maxConnectionsCount > 0 && from.connectionCount + 1 > from.maxConnectionsCount) {\n            return {\n                connectionAllowed: false,\n                error: `Too many connections from an input interface '${from.id}', maximum of '${from.maxConnectionsCount}' are allowed.`,\n            };\n        }\n\n        if (\n            (to.maxConnectionsCount === 0 || to.maxConnectionsCount === undefined) &&\n            to.connectionCount > 0\n        ) {\n            return {\n                connectionAllowed: false,\n                error: `By default only one connection to an input interface '${to.id}' allowed.`,\n            };\n        }\n\n        if (to.maxConnectionsCount > 0 && to.connectionCount + 1 > to.maxConnectionsCount) {\n            return {\n                connectionAllowed: false,\n                error: `Too many connections to an output interface '${to.id}', maximum of '${to.maxConnectionsCount}' are allowed.`,\n            };\n        }\n\n        if (from.type && to.type) {\n            const fromTypes =\n                typeof from.type === 'string' || from.type instanceof String\n                    ? [from.type]\n                    : from.type;\n            const toTypes =\n                typeof to.type === 'string' || to.type instanceof String ? [to.type] : to.type;\n\n            const commonType = fromTypes.find((t) => toTypes.includes(t));\n\n            if (commonType === undefined) {\n                return {\n                    connectionAllowed: false,\n                    error: `No common types between interfaces. Interface '${from.id}' supports types '${fromTypes}' and interface '${to.id}' supports types '${toTypes}'.`,\n                };\n            }\n        }\n\n        if (this.events.checkConnection.emit({ from, to }).prevented) {\n            return {\n                connectionAllowed: false,\n                error: `Connection between an input interface '${from.id}' and an output interface '${to.id}' was prevented`,\n            };\n        }\n\n        const hookResults = this.hooks.checkConnection.execute({ from, to });\n        if (hookResults.some((hr) => !hr.connectionAllowed)) {\n            return {\n                connectionAllowed: false,\n                errors: `Connection between an input interface '${from.id}' and an output interface '${to.id}' was prevented`,\n            };\n        }\n\n        // List of connections that are removed once the dummyConnection is created\n        const connectionsInDanger = [];\n        return {\n            connectionAllowed: true,\n            dummyConnection: new DummyConnection(from, to),\n            connectionsInDanger,\n        };\n    };\n\n    /**\n     * Adds an anchor to the connection and creates an event that\n     * the anchor was added, which is used by history system.\n     *\n     * @param anchor anchor to be added\n     * @param connection connection to which the anchor is added\n     * @param position position of the anchor in the connection\n     */\n    graph.addAnchor = function addAnchor(anchor, connection, position) {\n        const anchorToAdd = {\n            x: anchor.x,\n            y: anchor.y,\n            id: uuidv4(),\n        };\n        if (connection.anchors === undefined) connection.anchors = [];\n\n        connection.anchors.splice(position, 0, anchorToAdd);\n        graph.events.addAnchor.emit([connection, (position * 3 + 1)]);\n    };\n\n    // Replaces given instance of a node with a node of type `newNodeName`\n    // All properties that are common preserve their values\n    // All connections that were connected to the interfaces that are common\n    // for those two nodes are preserved as well.\n    graph.replaceNode = function replaceNode(oldNode, newNodeName) {\n        const oldPosition = oldNode.position;\n        const newNode = this.editor.nodeTypes.get(newNodeName);\n        const newNodeInstance = new newNode.type(); // eslint-disable-line new-cap\n\n        // Restoring a custom title of the node\n        if (oldNode.title !== oldNode.type) {\n            newNodeInstance.title = oldNode.title;\n        }\n\n        // Restoring properties and interfaces\n        Object.entries({ ...oldNode.inputs, ...oldNode.outputs }).forEach(([name, intf]) => {\n            if (intf.direction !== undefined) {\n                if (Object.prototype.hasOwnProperty.call(newNodeInstance.inputs, name)) {\n                    updateInterfacePosition(\n                        newNodeInstance,\n                        newNodeInstance.inputs[name],\n                        intf.side,\n                        intf.sidePosition,\n                        false,\n                        false,\n                    );\n                }\n                if (Object.prototype.hasOwnProperty.call(newNodeInstance.outputs, name)) {\n                    updateInterfacePosition(\n                        newNodeInstance,\n                        newNodeInstance.outputs[name],\n                        intf.side,\n                        intf.sidePosition,\n                        false,\n                        false,\n                    );\n                }\n                // If the new node has the same property of the same type as it could be overridden\n            } else if (\n                Object.prototype.hasOwnProperty.call(newNodeInstance.inputs, name) &&\n                newNodeInstance.inputs[name].componentName === intf.componentName\n            ) {\n                newNodeInstance.inputs[name].value = intf.value;\n            }\n        });\n\n        // Restoring connections\n        const interfaces = [...Object.values(oldNode.inputs), ...Object.values(oldNode.outputs)];\n        const connections = this.connections.filter(\n            (c) => interfaces.includes(c.from) || interfaces.includes(c.to),\n        );\n\n        const connectionsToRestore = [];\n\n        Object.entries({ ...oldNode.inputs, ...oldNode.outputs }).forEach(([name, intf]) => {\n            if (intf.direction === undefined) return;\n\n            // Rewiring connections to new interfaces\n            connections.forEach((conn) => {\n                if (Object.prototype.hasOwnProperty.call(newNodeInstance.inputs, name)) {\n                    if (conn.from === intf) {\n                        const newConn = new Connection(newNodeInstance.inputs[name], conn.to);\n                        newConn.anchors = conn.anchors;\n                        connectionsToRestore.push(newConn);\n                    } else if (conn.to === intf) {\n                        const newConn = new Connection(conn.from, newNodeInstance.inputs[name]);\n                        newConn.anchors = conn.anchors;\n                        connectionsToRestore.push(newConn);\n                    }\n                }\n\n                if (Object.prototype.hasOwnProperty.call(newNodeInstance.outputs, name)) {\n                    if (conn.from === intf) {\n                        const newConn = new Connection(newNodeInstance.outputs[name], conn.to);\n                        newConn.anchors = conn.anchors;\n                        connectionsToRestore.push(newConn);\n                    } else if (conn.to === intf) {\n                        const newConn = new Connection(conn.from, newNodeInstance.outputs[name]);\n                        newConn.anchors = conn.anchors;\n                        connectionsToRestore.push(newConn);\n                    }\n                }\n            });\n        });\n\n        newNodeInstance.position = oldPosition;\n\n        startTransaction();\n\n        this.removeNode(oldNode);\n        this.addNode(newNodeInstance);\n        connectionsToRestore.forEach((conn) => this.internalAddConnection(conn));\n\n        commitTransaction();\n\n        return newNodeInstance;\n    };\n\n    graph.addNode = function addNode(node, graphLoadingState, nodeId) {\n        if (this.events.beforeAddNode.emit(node).prevented) {\n            return;\n        }\n        this.nodeEvents.addTarget(node.events);\n        this.nodeHooks.addTarget(node.hooks);\n        node.registerGraph(this);\n\n        if (node.template !== undefined) {\n            const newState = JSON.parse(JSON.stringify(node.template.save()));\n            newState.id ??= uuidv4();\n            node.template = new GraphTemplate(newState, this.editor);\n        }\n\n        this._nodes.push(node);\n        // when adding the node to the array, it will be made reactive by Vue.\n        // However, our current reference is the non-reactive version.\n        // Therefore, we need to get the reactive version from the array.\n        node = this.nodes.find((n) => n.id === node.id);\n        node.onPlaced(graphLoadingState, nodeId);\n        this.events.addNode.emit(node);\n        return node; // eslint-disable-line consistent-return\n    };\n\n    graph.destroy = function destroy() {\n        // Remove possibility of removing graphs - this ignores changes made by\n        // default switchGraph (unregistering from editor and removing nodes) and\n        // allows to later reuse this instance\n\n        // TODO: This causes memory leaks, as when reloading a graph, all non-destroyed\n        // graphs linger are are completely unnaccessible\n    };\n\n    graph.load = function load(state) {\n        const errors = [];\n\n        // Clear current state\n        for (let i = this.connections.length - 1; i >= 0; i -= 1) {\n            this.removeConnection(this.connections[i]);\n        }\n        for (let i = this.nodes.length - 1; i >= 0; i -= 1) {\n            this.removeNode(this.nodes[i]);\n        }\n\n        // Load state\n        this.id = state.id ?? uuidv4();\n        this.name = state.name ?? undefined;\n\n        const specOrGenerated = (mapping, id) => {\n            if (!mapping) return id;\n            return mapping.has(id) ? `'${mapping.get(id)}'` : `'${id}' (generated)`;\n        };\n\n        const nodesErrors = [];\n        state.nodes.forEach((n) => {\n            const nodeInformation = this.editor.nodeTypes.get(n.name);\n\n            if (!nodeInformation) {\n                nodesErrors.push(`Node type ${n.name} is not registered`);\n            } else {\n                const node = new nodeInformation.type(); // eslint-disable-line new-cap\n\n                // The node state may not have an id, so we it has to be assigned manually\n                // if needed\n                n.id ??= uuidv4();\n\n                if (n.subgraph && n.graphState) {\n                    // Remove new graphs except current one since they become dangling after\n                    // CustomGraphNode.load\n                    const graphsBefore = new Set([...this.editor.graphs].map(toRaw));\n\n                    this.addNode(node, state.graphLoadingState, n.id);\n\n                    // TODO: Destroy graphs properly\n                    [...this.editor.graphs]\n                        .map(toRaw)\n                        .filter((g) => !graphsBefore.has(g))\n                        .filter((g) => g !== node.subgraph)\n                        .forEach((g) => this.editor.unregisterGraph(g));\n                } else if (n.subgraph && !state.graphLoadingState) {\n                    // Root graph\n                    // Preserve interfaces IDs to keep connections valid\n                    const interfacesEntries = n.interfaces\n                        .filter((intf) => intf.id)\n                        .map((intf) => [intf.name, intf.id]);\n\n                    const graphLoadingState = {\n                        newToSpecNodeIds: new Map([[n.id, n.id]]),\n                        newInterfaceIds: new Map([[n.id, new Map(interfacesEntries)]]),\n                        newToSpecConnIds: new Map(),\n                        newToSpecIntfIds: new Map(),\n                    };\n\n                    this.addNode(node, graphLoadingState, n.id);\n                } else {\n                    this.addNode(node, state.graphLoadingState, n.id);\n                }\n                const nodeErrors = node.load(n);\n                if (Array.isArray(nodeErrors) && nodeErrors.length) {\n                    nodesErrors.push(`Node '${node.type}' with id ${specOrGenerated(state.graphLoadingState?.newToSpecNodeIds, n.id)} is invalid:`, ...nodeErrors.map((e) => `    ${e}`));\n                }\n            }\n        });\n        if (nodesErrors.length) errors.push('Node errors:', ...nodesErrors.map((e) => `    ${e}`));\n\n        // Assigning ids to connections that do not have them\n        state.connections.forEach((c) => {\n            c.id ??= uuidv4();\n        });\n\n        const connectionsErrors = [];\n        state.connections.forEach((c) => {\n            const connectionErrors = [];\n            const fromIf = this.findNodeInterface(c.from);\n            const toIf = this.findNodeInterface(c.to);\n            const otherExists = state.connections.some(\n                (conn) => conn.id === c.id && (conn.from !== c.from || conn.to !== c.to),\n            );\n\n            if (otherExists) connectionErrors.push(`ID is already taken.`);\n\n            const reportIfMissing = (direction, intf, id) => {\n                if (intf) return;\n                connectionErrors.push(`Missing ${direction} ${specOrGenerated(state.graphLoadingState?.newToSpecIntfIds, id)}`);\n            };\n\n            reportIfMissing('src', fromIf, c.from);\n            reportIfMissing('dst', toIf, c.to);\n\n            if (connectionErrors.length) {\n                const reportIfFound = (direction, intf) => {\n                    if (!intf) return;\n                    const node = this.nodes.find(({ id }) => id === intf.nodeId);\n                    const intfIdLabel =\n                        specOrGenerated(state.graphLoadingState?.newToSpecIntfIds, intf.id);\n                    const nodeIdLabel =\n                        specOrGenerated(state.graphLoadingState?.newToSpecNodeIds, node.id);\n                    connectionErrors.push(`Found   ${direction} ${intfIdLabel} '${intf.name}' in node '${node.type}' with id ${nodeIdLabel}`);\n                };\n\n                reportIfFound('src', fromIf);\n                reportIfFound('dst', toIf);\n\n                const connIdLabel =\n                    specOrGenerated(state.graphLoadingState?.newToSpecConnIds, c.id);\n                connectionsErrors.push(`Connection ${connIdLabel} is invalid:`, ...connectionErrors.map((e) => `    ${e}`));\n            } else {\n                // Manually adding connections instead of using `addConnection` from baklavajs\n                // as we want to get a feedback message from `checkConnection` function\n                // which is suppressed in baklavajs functionality\n                const checkConnectionResult = this.checkConnection(fromIf, toIf);\n                if (!checkConnectionResult.connectionAllowed) {\n                    errors.push(\n                        `Could not create connection of id '${c.id}'. ${checkConnectionResult.error}`,\n                    );\n                } else {\n                    checkConnectionResult.connectionsInDanger.forEach((connectionToRemove) => {\n                        const instance = this.connections.find(\n                            (conn) => conn.id === connectionToRemove.id,\n                        );\n                        if (instance) {\n                            this.removeConnection(instance);\n                        }\n                    });\n\n                    const conn = new Connection(\n                        checkConnectionResult.dummyConnection.from,\n                        checkConnectionResult.dummyConnection.to,\n                    );\n\n                    c.anchors?.forEach((anchor, index) => {\n                        graph.addAnchor(anchor, conn, index);\n                    });\n                    this.internalAddConnection(conn);\n                }\n            }\n        });\n\n        if (connectionsErrors.length) errors.push('Connection errors:', ...connectionsErrors.map((e) => `    ${e}`));\n\n        this.hooks.load.execute(state);\n        return errors;\n    };\n\n    graph.size = function size() {\n        const sizes = this.nodes.map((node) => {\n            const HTMLelement = document.getElementById(node.id);\n            return {\n                width: HTMLelement.offsetWidth,\n                height: HTMLelement.offsetHeight,\n                position: node.position,\n            };\n        });\n        const margin = 100;\n\n        const rightmostX = Math.max(...sizes.map((node) => node.position.x + node.width)) + margin;\n        const leftmostX = Math.min(...sizes.map((node) => node.position.x)) - margin;\n\n        const bottommostY =\n            Math.max(...sizes.map((node) => node.position.y + node.height)) + margin;\n        const topmostY = Math.min(...sizes.map((node) => node.position.y)) - margin;\n\n        const graphWidth = rightmostX - leftmostX;\n        const graphHeight = bottommostY - topmostY;\n\n        return {\n            graphHeight,\n            graphWidth,\n            rightmostX,\n            leftmostX,\n            bottommostY,\n            topmostY,\n        };\n    };\n\n    graph.save = function save() {\n        const state = {\n            id: this.id,\n            name: this.name !== '' ? this.name : undefined,\n            nodes: this.nodes.map((n) => n.save()),\n            connections: this.connections.map((c) => ({\n                id: c.id,\n                from: c.from.id,\n                to: c.to.id,\n                anchors: c.anchors?.map((anchor) => ({\n                    x: anchor.x,\n                    y: anchor.y,\n                })),\n            })),\n            scaling: this.scaling,\n            panning: this.panning,\n        };\n        return this.hooks.save.execute(state);\n    };\n\n    graph.removeSelectedNodes = function removeSelectedNodes() {\n        for (let i = this.selectedNodes.length - 1; i >= 0; i -= 1) {\n            this.removeNode(this.selectedNodes[i]);\n        }\n    };\n\n    graph.removeNode = function removeNode(node) {\n        if (this.nodes.includes(node)) {\n            if (this.events.beforeRemoveNode.emit(node).prevented) {\n                return;\n            }\n            const interfaces = [...Object.values(node.inputs), ...Object.values(node.outputs)];\n            this.connections\n                .filter((c) => interfaces.includes(c.from) || interfaces.includes(c.to))\n                .forEach((c) => this.removeConnection(c));\n            this._nodes.splice(this.nodes.indexOf(node), 1);\n            this.events.removeNode.emit(node);\n            node.onDestroy();\n            this.nodeEvents.removeTarget(node.events);\n            this.nodeHooks.removeTarget(node.hooks);\n        }\n    };\n\n    graph.removeNodeOnly = function removeNodeOnly(node) {\n        this._nodes.splice(this.nodes.indexOf(node), 1);\n        this.events.removeNode.emit(node);\n        node.onDestroy();\n        this.nodeEvents.removeTarget(node);\n        this.nodeHooks.removeTarget(node);\n    };\n\n    graph.editNode = function editNode(node) {\n        this.events.editNode.emit(node);\n    };\n\n    graph.obtainExposedNames = function obtainExposedNames() {\n        const exposedNames = [];\n        this._nodes.forEach((node) => {\n            Object.values({ ...node.inputs, ...node.outputs }).forEach((intf) => {\n                if (intf.externalName !== undefined) {\n                    exposedNames.push(intf.externalName);\n                }\n            });\n        });\n        return exposedNames;\n    };\n\n    graph.isIncorrectExternalName = function isIncorrectExternalName(name, exposedNames) {\n        if (this.graphNode === undefined) return false;\n\n        const sameExposedNames = exposedNames.filter((n) => n === name).length;\n\n        // Extract interface names from graph node\n        const interfaces = [\n            ...Object.keys(this.graphNode.inputs),\n            ...Object.keys(this.graphNode.outputs),\n        ].map((intf) => intf.split('_'))\n            .filter((intf) => intf[0] !== 'property')\n            .map((intf) => intf[1]);\n\n        const sameInterfaceNames = interfaces.filter((n) => n === name).length;\n        return name.length === 0 || sameExposedNames !== 0 || sameInterfaceNames !== 0;\n    };\n\n    graph.resolveNewExposedName = function resolveNewExposedName(name) {\n        const exposedNames = this.obtainExposedNames();\n\n        // Check if the external name is taken and add a suffix if it is\n        let suffix = 1;\n        let tmpName = name;\n        while (this.isIncorrectExternalName(tmpName, exposedNames)) {\n            tmpName = `${name}_${suffix}`;\n            suffix += 1;\n        }\n        return tmpName;\n    };\n\n    return graph;\n}\n","<!--\nCopyright (c) 2022-2023 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!--\nInterface that is used to display inputs, outputs and properties of a node.\n\nThe custom implementations introduces wrapper functions that prevent the user\nfrom creating and deleting connections or altering nodes' values if the editor is read-only.\n-->\n\n<template>\n    <transition name=\"slide-fade\">\n        <div ref=\"el\">\n                <a\n                    v-for=\"url in nodeRef.URLs\"\n                    :key=\"url.name\"\n                    :href=\"url.url\"\n                    class=\"__url\"\n                    target=\"_blank\"\n                    draggable=\"false\"\n                    @pointerdown.left.stop\n                >\n                    <div class=\"link_item\">\n                        <img\n                            v-if=\"url.icon !== undefined\"\n                            :src=\"getIconPath(url.icon)\"\n                            draggable=\"false\"\n                        />\n                        <span>{{ url.name }}</span>\n                        <br>\n                    </div>\n                </a>\n        </div>\n    </transition>\n</template>\n\n<script>\nimport { defineComponent, ref } from 'vue';\nimport { useViewModel } from '@baklavajs/renderer-vue';\n\nexport default defineComponent({\n    props: {\n        node: {\n            required: true,\n        },\n    },\n    setup(props) {\n        const el = ref(null);\n        const { viewModel } = useViewModel();\n        const getIconPath = (name) => viewModel.value.cache[`./${name}`] ?? name;\n        const nodeRef = ref(props.node);\n\n        return {\n            el,\n            getIconPath,\n            nodeRef,\n        };\n    },\n});\n</script>\n\n<style lang='scss' scoped>\na {\n    color: white;\n    text-decoration: none;\n    word-wrap: normal;\n    width: 100%;\n\n     > .link_item {\n        border: 1px solid #737373;\n        border-bottom: 0px solid;\n        > img {\n            display: inline-block;\n            vertical-align: middle;\n            margin: 1em 1em 1em 1em;\n            width: auto;\n            height: 100%;\n            max-height: 1.75em;\n        }\n\n        > span {\n            vertical-align: middle;\n            font-size: $fs-small;\n        }\n        &:hover > span {\n            color: $green;\n        }\n    }\n}\n\n</style>\n","import { render } from \"./LinkMenu.vue?vue&type=template&id=28f02260&scoped=true\"\nimport script from \"./LinkMenu.vue?vue&type=script&lang=js\"\nexport * from \"./LinkMenu.vue?vue&type=script&lang=js\"\n\nimport \"./LinkMenu.vue?vue&type=style&index=0&id=28f02260&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-28f02260\"]])\n\nexport default __exports__","<!--\nCopyright (c) 2022-2024 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!-- eslint-disable vue/no-multiple-template-root -->\n<template>\n    <Tooltip\n        ref=\"tooltipRef\"\n        :left=\"tooltip.left\"\n        :top=\"tooltip.top\"\n        :text=\"tooltip.text\"\n        v-show=\"tooltip.visible\"\n    />\n    <div\n        class=\"baklava-sidebar prevent-select\"\n        ref=\"sidebarRef\"\n        :class=\"{\n            '--open': graph.sidebar.visible,\n            '--hidehud': editorManager.editor.hideHud,\n            '--preview': editorManager.editor.preview,\n            'hidden-navbar': $isMobile,\n        }\"\n        :style=\"styles\"\n    >\n        <div class=\"__resizer\" @mousedown=\"startResize\" />\n        <div v-if=\"node\" class=\"__content\">\n            <div class=\"__header\">\n                <Cross tabindex=\"-1\" class=\"__close\" @click=\"close\" />\n                <img\n                    class=\"__node-icon\"\n                    v-if=\"nodeIconPath !== undefined\"\n                    :src=\"nodeIconPath\"\n                />\n                <div class=\"__node-name\">\n                    {{ displayedName }}\n                </div>\n                <a\n                    v-for=\"url in nodeURLs\"\n                    :key=\"url.name\"\n                    :href=\"url.url\"\n                    class=\"__url\"\n                    target=\"_blank\"\n                    draggable=\"false\"\n                    @pointerover=\"(ev) => onPointerOver(url.name, ev)\"\n                    @pointerleave=\"onPointerLeave\"\n                    tabindex=\"-1\"\n                >\n                    <img\n                        v-if=\"url.icon !== undefined\"\n                        :src=\"getIconPath(url.icon)\"\n                        :alt=\"url.name\"\n                        draggable=\"false\"\n                    />\n                </a>\n            </div>\n            <div v-if=\"editorManager.baklavaView.settings.showIds\" class=\"__id\">\n                <div class=\"__title\">Node ID</div>\n                <div class=\"__value\">\n                    {{ node.id }}\n                </div>\n                <div v-if=\"subgraphId\" class=\"__title\">Subgraph ID</div>\n                <div v-if=\"subgraphId\" class=\"__value\">\n                    {{ subgraphId }}\n                </div>\n            </div>\n            <div v-show=\"prettyCategory\" class=\"__category\">\n                <div class=\"__title\">Category</div>\n                <div class=\"__category-name\">\n                    {{ prettyCategory }}\n                </div>\n            </div>\n            <div v-if=\"!editorManager.editor.readonly\" class=\"__replace\">\n                <div class=\"__replace_entry\" v-if=\"replacementParents.length\">\n                    <div class=\"__replace_title\">Generalize:</div>\n                    <div\n                        v-for=\"parent in replacementParents\"\n                        :key=\"parent\"\n                        class=\"__replace_button\"\n                    >\n                        <component :is=\"parent.component\" :intf=\"parent\" tabindex=\"-1\" />\n                    </div>\n                </div>\n                <div class=\"__replace_entry\" v-if=\"replacementChildren.length\">\n                    <div class=\"__replace_title\">Specialize:</div>\n                    <div v-for=\"child in replacementChildren\" :key=\"child\" class=\"__replace_button\">\n                        <component :is=\"child.component\" :intf=\"child\" tabindex=\"-1\" />\n                    </div>\n                </div>\n                <div class=\"__replace_entry\" v-if=\"replacementSiblings.length\">\n                    <div class=\"__replace_title\">Choose other type:</div>\n                    <div\n                        v-for=\"sibling in replacementSiblings\"\n                        :key=\"sibling\"\n                        class=\"__replace_button\"\n                    >\n                        <component :is=\"sibling.component\" :intf=\"sibling\" tabindex=\"-1\" />\n                    </div>\n                </div>\n            </div>\n            <div class=\"__properties\" v-if=\"displayedProperties.length\">\n                <div class=\"__title\">Properties</div>\n                <div v-for=\"input in displayedProperties\" :key=\"input.id\" class=\"__property\">\n                    <div class=\"__property-name\">\n                        {{ getOptionName(input.componentName) ? `${input.name}:` : '' }}\n                    </div>\n                    <CustomInterface\n                        :node=\"node\"\n                        :intf=\"input\"\n                        :toggleGroup=\"toggleGroup\"\n                        :updateDynamicInterfaces=\"updateDynamicInterfaces\"\n                        sidebar=true\n                        tabindex=\"-1\"\n                    />\n                </div>\n            </div>\n\n            <div v-show=\"desc\">\n                <div class=\"__title\">\n                    Description\n                </div>\n                <div class=\"__markdown-content\" >\n                    <span v-html=\"desc\" class=\"node_description\"></span>\n                </div>\n            </div>\n\n            <div\n                class=\"__interface_groups\"\n                v-if=\"interfaceGroupsCheckboxes.length > 0 && !editorManager.editor.readonly\"\n            >\n                <div class=\"__title\">Interface Groups</div>\n                <div\n                    v-for=\"intfG in interfaceGroupsCheckboxes\"\n                    :key=\"intfG.id\"\n                    class=\"__group\"\n                >\n                    <component :is=\"intfG.component\" :intf=\"intfG\"></component>\n                </div>\n                <div class=\"__group-assign\">\n                    <component\n                        :is=\"interfaceGroupsButton.component\"\n                        :intf=\"interfaceGroupsButton\"\n                        :class=\"interfaceGroupsButtonClasses\"\n                        tabindex=\"-1\"\n                    ></component>\n                </div>\n            </div>\n            <div v-show=\"interfaceGroupsOutput.length\" class=\"__error_outputs\">\n                <div class=\"__title\">Conflicts:</div>\n                <!-- eslint-disable vue/require-v-for-key -->\n                <p v-for=\"output in interfaceGroupsOutput\">\n                    {{ output }}\n                </p>\n            </div>\n            <NodeSpecificationEditor :node=\"node\" :scrollHandle=\"sidebarRef\" />\n        </div>\n    </div>\n</template>\n\n<script>\nimport { computed, defineComponent, watch, ref, nextTick } from 'vue'; // eslint-disable-line object-curly-newline\nimport { CheckboxInterface, ButtonInterface } from '@baklavajs/renderer-vue'; // eslint-disable-line object-curly-newline\nimport showdown from 'showdown';\nimport CustomInterface from './CustomInterface.vue';\nimport Cross from '../icons/Cross.vue';\nimport Tooltip from '../components/Tooltip.vue';\nimport EditorManager from '../core/EditorManager';\n\nimport { validateInterfaceGroupsNames } from '../core/interfaceParser';\nimport { getOptionName } from './CustomNode.js';\nimport NodeSpecificationEditor from '../components/NodeSpecificationEditor.vue';\n\nexport default defineComponent({\n    components: {\n        Cross,\n        CustomInterface,\n        CheckboxInterface,\n        NodeSpecificationEditor,\n        Tooltip,\n    },\n    emits: ['sidebar-open'],\n    setup(_props, { emit }) {\n        const editorManager = EditorManager.getEditorManagerInstance();\n        const viewModel = computed(() => editorManager.baklavaView);\n        const graph = computed(() => viewModel.value.displayedGraph);\n\n        const converter = new showdown.Converter({\n            smartIndentationFix: true,\n            simpleLineBreaks: true,\n        });\n\n        const width = ref(300);\n\n        const node = computed(() => {\n            const id = graph.value.sidebar.nodeId;\n            return graph.value.nodes.find((x) => x.id === id);\n        });\n\n        const category = computed(() => graph.value.editor.nodeTypes.get(node.value.type).category);\n        const prettyCategory = computed(() => `${\n            category.value\n                .split(/(?<!\\\\)\\//)\n                .map((x) => x.replace('\\\\/', '/'))\n                .join(' / ')\n        }`);\n\n        const subgraphId = computed(() => graph.value.editor.nodeTypes.get(\n            node.value.type,\n        ).subgraphId);\n\n        const desc = computed(() => {\n            let html = converter.makeHtml(node.value?.description ?? '');\n            const aTagRe = /<a href=\"[a-zA-Z0-9-$_.+!*'()/&?=:%]+\">/gm;\n            html.match(aTagRe)?.forEach((match) => {\n                const hrefParts = match.split('\"');\n                // Forces the link to open in a new tab instead of closing the pipeline manager\n                const newEnd = ` tabindex=\"-1\" target=\"_blank\"${hrefParts[2]}`;\n                const newHref = [hrefParts[0], hrefParts[1], newEnd].join('\"');\n                html = html.replace(match, newHref);\n            });\n            return html;\n        });\n\n        const nodeIcon = computed(() => viewModel.value.editor.getNodeIconPath(node.value?.type));\n        const nodeURLs = computed(() => viewModel.value.editor.getNodeURLs(node.value?.type));\n\n        const getIconPath = (name) => viewModel.value.cache[`./${name}`] ?? name;\n        const nodeIconPath = computed(() => getIconPath(nodeIcon.value));\n        const sidebarVisible = computed(() => graph.value.sidebar.visible);\n\n        watch(node, () => {\n            if (node.value === undefined) {\n                graph.value.sidebar.visible = false;\n            }\n        });\n        watch(sidebarVisible, (newValue) => {\n            if (newValue) emit('sidebar-open');\n        });\n\n        const tooltipRef = ref(null);\n        const tooltip = ref(null);\n        const sidebarRef = ref(null);\n\n        tooltip.value = {\n            top: 0,\n            left: 0,\n            visible: false,\n            text: '',\n        };\n\n        const onPointerOver = (name, ev) => {\n            tooltip.value.text = name;\n            tooltip.value.visible = true;\n\n            // We need to wait for the next frame to get the tooltips width first to get its width\n            nextTick().then(() => {\n                const right = ev.clientX - ev.offsetX + ev.currentTarget.offsetWidth / 2 +\n                    tooltipRef.value.$el.clientWidth;\n\n                tooltip.value.top = ev.clientY - ev.offsetY + ev.currentTarget.offsetHeight;\n\n                // If the tooltip is out of user view port it is moved to the left\n                if (right > window.innerWidth) {\n                    tooltip.value.left = ev.clientX - ev.offsetX + ev.currentTarget.offsetWidth / 2\n                        - tooltipRef.value.$el.clientWidth / 2;\n                } else {\n                    tooltip.value.left = ev.clientX - ev.offsetX + ev.currentTarget.offsetWidth / 2;\n                }\n            });\n        };\n\n        const toggleGroup = (intf) => {\n            intf.group.forEach((name) => {\n                node.value.inputs[name].hidden = !intf.value;\n            });\n        };\n\n        const updateDynamicInterfaces = (intf) => {\n            node.value.updateDynamicInterfaces(intf);\n        };\n\n        const onPointerLeave = () => {\n            tooltip.value.visible = false;\n        };\n\n        const styles = computed(() => ({\n            width: `${width.value}px`,\n        }));\n\n        const close = () => {\n            graph.value.sidebar.visible = false;\n        };\n\n        const onMouseMove = (ev) => {\n            ev.preventDefault();\n            width.value -= ev.movementX;\n        };\n\n        const startResize = () => {\n            width.value = sidebarRef.value.offsetWidth;\n            window.addEventListener('mousemove', onMouseMove);\n            window.addEventListener(\n                'mouseup',\n                (ev) => {\n                    ev.preventDefault();\n                    window.removeEventListener('mousemove', onMouseMove);\n                },\n                { once: true },\n            );\n        };\n\n        const displayedProperties = computed(() =>\n            Object.values(node.value.inputs).filter((intf) => !intf.port),\n        );\n\n        const interfaceGroups = computed(() =>\n            Object.values({ ...node.value.inputs, ...node.value.outputs }).filter(\n                (ni) => ni.interfaces !== undefined,\n            ),\n        );\n\n        const interfaceGroupsOutput = ref('');\n        const interfaceGroupsButtonClasses = computed(() => ({\n            '--disabled': interfaceGroupsOutput.value !== '',\n        }));\n\n        const interfaceGroupsCheckboxes = computed(() => {\n            const checkboxes = ref([]);\n            // So that interfaces are recomputed when this value changes\n            graph.value.sidebar.visible; // eslint-disable-line no-unused-expressions\n\n            interfaceGroups.value.forEach((intfG) => {\n                const checkbox = new CheckboxInterface(intfG.name, !intfG.hidden).setPort(false);\n                checkbox.events.setValue.subscribe(this, () => {\n                    const errors = validateInterfaceGroupsNames(\n                        enabledInterfaceGroups.value, // eslint-disable-line no-use-before-define\n                        node.value.inputs,\n                        node.value.outputs,\n                    );\n\n                    if (errors.length) {\n                        interfaceGroupsOutput.value = errors.map(\n                            ([parsedIntfName, intfDirection, groupName]) =>\n                                `Reused ${intfDirection} - ${parsedIntfName} for interface group ${groupName}`,\n                        );\n                    } else {\n                        interfaceGroupsOutput.value = '';\n                    }\n                });\n                checkbox.componentName = 'CheckboxInterface';\n                checkbox.intfG = intfG;\n                checkboxes.value.push(checkbox);\n            });\n\n            return checkboxes.value;\n        });\n\n        const enabledInterfaceGroups = computed(() => {\n            const enabledInterfaceGroupsCheckboxes = [];\n\n            interfaceGroupsCheckboxes.value.forEach((intf) => {\n                if (intf.value) {\n                    enabledInterfaceGroupsCheckboxes.push(\n                        `${intf.intfG.direction}_${intf.intfG.name}`,\n                    );\n                }\n            });\n            return enabledInterfaceGroupsCheckboxes;\n        });\n\n        const interfaceGroupsButton = computed(() => {\n            const checkbox = new ButtonInterface('Assign', () => {\n                interfaceGroupsCheckboxes.value.forEach((intf) => {\n                    node.value.toggleInterfaceGroup(intf.intfG, intf.value);\n                });\n                interfaceGroupsOutput.value = '';\n            });\n            checkbox.componentName = 'ButtonInterface';\n            return checkbox;\n        });\n\n        const replacementButtons = (list) => {\n            const buttons = ref([]);\n\n            (list ?? []).forEach((eName) => {\n                const button = new ButtonInterface(eName, () => {\n                    if (editorManager.baklavaView.editor.parentNodes.has(eName)) {\n                        const newNode = graph.value.replaceNode(node.value, eName);\n                        graph.value.sidebar.nodeId = newNode.id;\n                    }\n                });\n                button.componentName = 'ButtonInterface';\n                buttons.value.push(button);\n            });\n            return buttons.value;\n        };\n\n        const nodeSiblings = computed(() => {\n            const siblings = new Set();\n            (node.value.extends ?? []).forEach((eName) => {\n                const extended = editorManager.baklavaView.editor.parentNodes.get(eName);\n                if (extended !== undefined) {\n                    extended.extending?.forEach((e) => siblings.add(e));\n                }\n            });\n            siblings.delete(node.value.type);\n            return Array.from(siblings);\n        });\n\n        const replacementParents = computed(() => replacementButtons(node.value.extends));\n        const replacementChildren = computed(() => replacementButtons(node.value.extending));\n        const replacementSiblings = computed(() => replacementButtons(nodeSiblings.value));\n\n        const displayedName = computed(() => {\n            if (node.value.title === '' || node.value.title === undefined) {\n                return node.value.type;\n            }\n            return node.value.title;\n        });\n\n        return {\n            graph,\n            node,\n            styles,\n            startResize,\n            close,\n            displayedProperties,\n            interfaceGroups,\n            interfaceGroupsCheckboxes,\n            interfaceGroupsButton,\n            interfaceGroupsOutput,\n            interfaceGroupsButtonClasses,\n            nodeIconPath,\n            nodeURLs,\n            getIconPath,\n            desc,\n            tooltip,\n            onPointerOver,\n            onPointerLeave,\n            tooltipRef,\n            sidebarRef,\n            toggleGroup,\n            getOptionName,\n            prettyCategory,\n            replacementParents,\n            replacementChildren,\n            replacementSiblings,\n            editorManager,\n            displayedName,\n            updateDynamicInterfaces,\n            subgraphId,\n        };\n    },\n});\n</script>\n<style lang=\"scss\" scoped>\n.prevent-select {\n    -webkit-user-select: none; /* Safari */\n    -ms-user-select: none; /* IE 10 and IE 11 */\n    user-select: none; /* Standard syntax */\n\n    & > .__content {\n        -webkit-user-select: text; /* Safari */\n        -ms-user-select: text; /* IE 10 and IE 11 */\n        user-select: text; /* Standard syntax */\n    }\n}\n</style>\n","import { render } from \"./CustomSidebar.vue?vue&type=template&id=f928b04a&scoped=true\"\nimport script from \"./CustomSidebar.vue?vue&type=script&lang=js\"\nexport * from \"./CustomSidebar.vue?vue&type=script&lang=js\"\n\nimport \"./CustomSidebar.vue?vue&type=style&index=0&id=f928b04a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f928b04a\"]])\n\nexport default __exports__","/*\n * Copyright (c) 2022-2024 Antmicro <www.antmicro.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n *\n */\n\nimport { NodeInterface, Graph } from '@baklavajs/core';\nimport { v4 as uuidv4 } from 'uuid';\nimport { parseInterfaces } from '../core/interfaceParser.js';\nimport { updateInterfacePosition } from './CustomNode.js';\nimport {\n    CustomNode,\n    newProperty,\n    parseProperties,\n    createProperties,\n    createBaklavaInterfaces,\n    updateSubgraphInterfaces,\n    updateSubgraphProperties,\n} from '../core/NodeFactory.js';\nimport { ir } from '../core/interfaceRegistry.ts';\n\n/**\n  * Function used to update properties of the graph node based on its specification.\n  *\n  * @param {Object} graphNode graph node object\n  *\n  * @returns properties ready to be loaded\n  */\nfunction prepareProperties(graphNode) {\n    const properties = graphNode.properties ?? [];\n\n    const parsedProperties = parseProperties(properties);\n    if (Array.isArray(parsedProperties) && parsedProperties.length) {\n        return parsedProperties.map((error) => `Node ${graphNode.name} invalid. ${error}`);\n    }\n    return createProperties(parsedProperties);\n}\n\n/**\n  * Function used to update interfaces of the graph node based on its specification.\n  * This includes only interfaces of the node, not external interfaces of the subgraph.\n  *\n  * @param {Object} graphNode graph node object\n  *\n  * @returns interfaces ready to be loaded\n  */\nfunction prepareInterfaces(graphNode) {\n    const interfaces = graphNode.interfaces ?? [];\n\n    const parsedInterfaces = parseInterfaces(interfaces, [], []);\n    if (Array.isArray(parsedInterfaces) && parsedInterfaces.length) {\n        return parsedInterfaces.map((error) => `Node ${graphNode.name} invalid. ${error}`);\n    }\n    return createBaklavaInterfaces(parsedInterfaces);\n}\n\n/**\n * The function uses its internal static template to create a new graph state\n * based on the template. It creates a new graph node ID and maps all interfaces\n * to new IDs. The function is used to create a new graph state that can be loaded\n * by the graph node.\n *\n * @param {object} template - Graph template\n * @param {object} opts\n * @param {object|undefined} [opts.graphLoadingState] - Information about loaded graphs.\n * @param {string|undefined} [opts.newSubgraphNodeId] - New ID of the subgraph node.\n * @param {'resolved'|'spec'} opts.mode - New ID of the subgraph node.\n *\n * @returns {any} graph state ready to be loaded\n */\nexport function prepareSubgraphInstance(\n    template,\n    { graphLoadingState, newSubgraphNodeId, mode } = {},\n) {\n    // eslint-disable-next-line no-param-reassign\n    mode ??= 'resolved';\n\n    const errors = [];\n\n    // Ensure subgraph nodes have IDs to distinguish instances in nested layers\n    const predicate = (node) => node.subgraph !== undefined && node.id === undefined;\n    if (template.nodes.some(predicate)) errors.push('Node defining a nested graph in a subgraph template should have their own ID');\n    if (errors.length) return { errors };\n\n    const isRoot = graphLoadingState === undefined;\n    // eslint-disable-next-line no-param-reassign\n    graphLoadingState ??= {\n        // New subgraph node ID -> Specification subgraph node ID\n        newToSpecNodeIds: new Map(),\n        // Subgraph node ID -> (Exposed Interface name -> New Interface ID)\n        newInterfaceIds: new Map(),\n        // New connection ID -> Specification connection ID\n        newToSpecConnIds: new Map(),\n        // New interface ID -> Specification interface ID\n        newToSpecIntfIds: new Map(),\n    };\n\n    /* Nodes */\n\n    const { newToSpecNodeIds } = graphLoadingState;\n    const specSubgraphNodeId = newToSpecNodeIds.get(newSubgraphNodeId);\n\n    const createNewNodeId = (node) => {\n        const newId = uuidv4();\n        if (node.id) newToSpecNodeIds.set(newId, node.id);\n        return newId;\n    };\n\n    const addNewNodeId = (node) => ({ ...node, id: createNewNodeId(node) });\n\n    /* Interfaces and connections */\n\n    const connections = template.connections.map((c) => {\n        const newId = uuidv4();\n        if (c.id) graphLoadingState.newToSpecConnIds.set(newId, c.id);\n        return { ...c, id: newId };\n    });\n    const { newInterfaceIds } = graphLoadingState;\n\n    const getOrGenerate = (map, key, factory = uuidv4) => {\n        if (!map.has(key)) map.set(key, factory());\n        return map.get(key);\n    };\n\n    const getOrGenerateInterfaceId = (node, intf) => {\n        // Exposed interface - generate and store\n        // Note: All interfaces in a subgraph node are treated as exposed,\n        // therefore all of them are looked up in the subgraph.\n        // This may be subject to change in future\n        const nodeId = node.subgraph !== undefined ? node.id : specSubgraphNodeId;\n        const idMap = getOrGenerate(newInterfaceIds, nodeId, () => new Map());\n\n        // Regular interface\n        const nonExposed = node.subgraph === undefined && intf.externalName === undefined;\n        // Exposed interface is not indicated in the nested subgraph node\n        const exposedNotInSubgraphNode = !isRoot\n            && intf.externalName !== undefined\n            && (specSubgraphNodeId === undefined || !idMap.has(intf.externalName));\n\n        return (nonExposed || exposedNotInSubgraphNode)\n            ? uuidv4()\n            : getOrGenerate(idMap, intf.externalName ?? intf.name);\n    };\n\n    const createNewInterfaceId = (oldId, node) => {\n        const interfaces = mode === 'resolved'\n            ? Object.values(node.inputs).concat(Object.values(node.outputs))\n            : node.interfaces;\n\n        const intf = interfaces.find((i) => i.id === oldId);\n\n        const newId = getOrGenerateInterfaceId(node, intf);\n        if (intf.id) graphLoadingState.newToSpecIntfIds.set(newId, intf.id);\n\n        // Side-effect: modify connections to have new interface IDs\n        /* eslint-disable no-param-reassign */\n        connections.filter((c) => c.from === oldId).forEach((c) => { c.from = newId; });\n        connections.filter((c) => c.to === oldId).forEach((c) => { c.to = newId; });\n        /* eslint-enable no-param-reassign */\n\n        return newId;\n    };\n\n    const addNewId = (intf, node) => ({ ...intf, id: createNewInterfaceId(intf.id, node) });\n\n    const mapNodeInterfaces = (interfaces, node) => Object.entries(interfaces)\n        .reduce((acc, [name, intf]) => ({ ...acc, [name]: addNewId(intf, node) }), {});\n\n    const addNewInterfaceIds = mode === 'resolved'\n        ? (node) => ({\n            ...node,\n            inputs: mapNodeInterfaces(node.inputs, node),\n            outputs: mapNodeInterfaces(node.outputs, node),\n        }) : (node) => ({\n            ...node,\n            interfaces: node.interfaces.map((intf) => addNewId(intf, node)),\n        });\n\n    // Apply changes\n\n    return {\n        state: {\n            id: uuidv4(),\n            name: template.name,\n            nodes: template.nodes.map(addNewInterfaceIds).map(addNewNodeId),\n            connections,\n            graphLoadingState,\n        },\n        errors,\n    };\n}\n\nexport default function CreateCustomGraphNodeType(template, graphNode) {\n    const [nodeInputs, newNodeOutputs] = prepareInterfaces(graphNode);\n    const properties = prepareProperties(graphNode);\n    const newNodeInputs = {\n        ...nodeInputs,\n        ...properties,\n    };\n\n    return class CustomGraphNodeType extends CustomNode {\n        type = graphNode.name;\n\n        title = graphNode.name;\n\n        template = template;\n\n        nodeInterfaces = { ...newNodeInputs, ...newNodeOutputs };\n\n        constructor() {\n            super(\n                graphNode.name,\n                graphNode.layer,\n                newNodeInputs,\n                newNodeOutputs,\n                graphNode.twoColumn ?? template.editor.editorManager.baklavaView.twoColumn ?? false,\n                graphNode.description ?? '',\n                graphNode.extends ?? [],\n                graphNode.extending ?? [],\n                graphNode.siblings ?? [],\n                graphNode.width ?? 300,\n                graphNode.relatedGraphs,\n            );\n        }\n\n        save() {\n            const state = super.save();\n            state.subgraph = this.subgraph.id;\n            state.graphState = this.subgraph.save();\n            return state;\n        }\n\n        /* eslint-disable no-param-reassign */\n        load(state) {\n            this.hooks.beforeLoad.execute(state);\n\n            const out = parseInterfaces(state.interfaces ?? [], [], []);\n            if (Array.isArray(out) && out.length) {\n                return out;\n            }\n            let { inputs, outputs } = out;\n\n            inputs = Object.values(inputs);\n            outputs = Object.values(outputs);\n\n            if (state.graphState !== undefined) {\n                delete state.graphState.interfaces;\n                delete state.subgraph;\n\n                // Loading the subgraph of the graph node first, before creating\n                // interfaces based on the nodes in the subgraph. Thanks to that\n                // the originally exposed interfaces (coming from regular nodes)\n                // are found first.\n                const errors = this.subgraph.load(state.graphState);\n                if (errors.length) {\n                    return errors;\n                }\n            }\n\n            this.updateExposedInterfaces(inputs, outputs);\n            // Default position should be undefined instead of (0, 0) so that it can be set\n            // by autolayout\n            this.position = state.position;\n            this.title = state.instanceName ?? '';\n\n            const errors = super.load(state);\n\n            this.events.loaded.emit(this);\n            return errors;\n        }\n\n        /**\n         * Function used to update exposed interfaces and properties of the graph node based on the\n         * nodes inside the graph, their interfaces and their external names.\n         *\n         * @param {Array} inputs inputs of the graph node. If not provided, the function\n         * will use the current inputs of the graph node.\n         * @param {Array} outputs outputs of the graph node. If not provided, the function\n         * will use the current outputs of the graph node.\n         * @param {boolean} privatize whether to check for privatized (removed) interfaces\n         */\n        updateExposedInterfaces(inputs = undefined, outputs = undefined, privatize = false) {\n            // Update interfaces based on subgraph interfaces and their external names\n            const evaluatedIntf = updateSubgraphInterfaces(\n                this.subgraph.nodes,\n                inputs ?? Object.values(this.inputs),\n                outputs ?? Object.values(this.outputs),\n            );\n            if (Array.isArray(evaluatedIntf) && evaluatedIntf.length) {\n                throw new Error(\n                    `Internal error occurred while exposing an interface.\\n` +\n                    `Reason: ${evaluatedIntf.join('. ')}`,\n                );\n            }\n            const evaluatedProp = updateSubgraphProperties(\n                this.subgraph.nodes,\n                inputs ?? Object.values(this.inputs),\n            );\n\n            // After resolving exposed interfaces, the graph node is updated accordingly.\n            this.updateInterfaces(evaluatedIntf.inputs, evaluatedIntf.outputs, privatize);\n            this.updateProperties(evaluatedProp);\n        }\n\n        /**\n         * Function called when the node is created using the nodePalette\n         *\n         * @param {Object|undefined} graphLoadingState Information about loaded graphs.\n         * @param {string|undefined} nodeId New ID of the subgraph node.\n         */\n        onPlaced(graphLoadingState, nodeId) {\n            this.initialize(graphLoadingState, nodeId);\n        }\n\n        /**\n         * Creates a new graph node instance based on the template, loads its graph state\n         * and updates exposed interfaces based on the nodes in the subgraph.\n         *\n         * @param {Object|undefined} graphLoadingState  Information about loaded graphs.\n         * @param {string|undefined} nodeId New ID of the subgraph node.\n         */\n        initialize(graphLoadingState, nodeId) {\n            if (this.subgraph) {\n                this.subgraph.destroy();\n            }\n            const graph = new Graph(this.template.editor);\n\n            const { state, errors } = prepareSubgraphInstance(\n                this.template,\n                { graphLoadingState, newSubgraphNodeId: nodeId },\n            );\n            if (!errors.length) errors.push(...graph.load(state));\n            if (errors.length) {\n                throw new Error(\n                    `Internal error occurred while initializing ${graph.type} graph. ` +\n                    `Reason: ${errors.join('. ')}`,\n                );\n            }\n\n            graph.template = this.template;\n            this.subgraph = graph;\n            graph.graphNode = this;\n\n            this.updateExposedInterfaces([], []);\n\n            this._title = this.template.name; // eslint-disable-line no-underscore-dangle\n            this.events.update.emit(null);\n        }\n\n        /**\n         * Function used to check which interfaces had been privatized from within\n         * the subgraph and need to be removed as a result.\n         *\n         * @param {Array} newInterfaces interfaces to be added to the graph node\n         * @param {Array} currentInterfaces interfaces already in the graph node\n         */\n        privatizeInterfaces(newInterfaces, currentInterfaces) {\n            Object.entries(currentInterfaces).forEach(([nodeKey, nodeIntf]) => {\n                // If current interface cannot be found in `newInterfaces`, it means that\n                // it was removed.\n                if (newInterfaces.find((intf) => intf.id === nodeIntf.id) === undefined) {\n                    // Only remove subgraph interfaces, not properties or node interfaces\n                    if (!Object.keys(this.nodeInterfaces).some((key) => key === nodeKey)) {\n                        const container = nodeIntf.direction === 'output' ? 'output' : 'input';\n                        this.removeInterface(container, nodeKey);\n                    }\n                }\n            });\n        }\n\n        /**\n         * Function used to update interfaces of the graph node. It makes use of InterfaceRegistry\n         * object to create interfaces that share part of the state of the exposed interfaces.\n         *\n         * @param {Array} newInputs inputs to be added to the graph node\n         * @param {Array} newOutputs outputs to be added to the graph node\n         * @param {boolean} privatize whether to check for privatized (removed) interfaces\n         */\n        updateInterfaces(newInputs, newOutputs, privatize = false) {\n            const newInterfaces = [...newInputs, ...newOutputs];\n            const currentInterfaces = { ...this.inputs, ...this.outputs };\n\n            if (privatize) {\n                this.privatizeInterfaces(newInterfaces, currentInterfaces);\n            }\n\n            newInterfaces.forEach((nodeIntf) => {\n                // If new interface cannot be found in the current interfaces, it means that\n                // it has to be created\n                const foundIntf = Object.values(currentInterfaces).find(\n                    (intf) => intf.id === nodeIntf.id,\n                );\n\n                if (foundIntf === undefined) {\n                    const ni = new NodeInterface(nodeIntf.name);\n                    Object.assign(ni, nodeIntf);\n                    ir.pushGraphIdToRegistry(ni.id, this.subgraph.id);\n                    ir.createSharedInterface(ni);\n\n                    const container = nodeIntf.direction === 'output' ? 'output' : 'input';\n                    this.addInterface(container, `${nodeIntf.direction}_${nodeIntf.name}`, ni);\n                } else {\n                    Object.assign(foundIntf, nodeIntf);\n                }\n            });\n\n            Object.values(currentInterfaces).forEach((nodeIntf) => {\n                updateInterfacePosition(this, nodeIntf, nodeIntf.side, undefined, false, false);\n            });\n        }\n\n        /**\n         * Function used to update interfaces of the graph node. It makes use of InterfaceRegistry\n         * object to create interfaces that share part of the state of the exposed interfaces.\n         *\n         * @param {Array} newInputs inputs to be added to the graph node\n         * @param {Array} newOutputs outputs to be added to the graph node\n         * @param {boolean} privatize whether to check for privatized (removed) interfaces\n         */\n        updateProperties(newProperties, privatize = false) {\n            if (privatize) {\n                this.privatizeInterfaces(newProperties, this.inputs);\n            }\n\n            newProperties.forEach((property) => {\n                const foundProperty = Object.values(this.inputs).find(\n                    (prop) => prop.id === property.id,\n                );\n\n                if (foundProperty === undefined) {\n                    const np = newProperty(property);\n                    Object.assign(np, property);\n                    this.addInput(`property_${property.name}`, np);\n                } else {\n                    Object.assign(foundProperty, property);\n                }\n            });\n        }\n    };\n}\n","<!--\nCopyright (c) 2022-2025 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!--\nDefines the main editor component - canvas in which the pipeline is drawn and\nedited by a user\n\nInherits from baklavajs/rendered-vue/src/editor/Editor.vue\n\nMinimap component is removed whatsoever as they are not used.\nHovered connections are calculated and rendered with an appropriate `isHighlighted` value.\n-->\n\n<template>\n    <div\n        ref=\"el\"\n        tabindex=\"-1\"\n        class=\"baklava-editor\"\n        :class=\"{\n            'baklava-ignore-mouse': !!temporaryConnection || dragging,\n            '--temporary-connection': !!temporaryConnection,\n        }\"\n        :style=\"editorStyle\"\n        @wheel.self=\"mouseWheel\"\n        @keydown=\"keyDown\"\n        @keyup=\"keyUp\"\n        @mouseleave=\"!readonly && onRightPointerUp\"\n        @drop.prevent=\"!readonly && onDrop($event)\"\n        @dragenter.prevent\n        @dragover.prevent\n        oncontextmenu=\"return false;\"\n    >\n        <slot name=\"background\">\n            <background />\n        </slot>\n\n        <template v-if=\"!validating\">\n            <slot\n                name=\"palette\"\n                v-if=\"!(readonly || hideHud)\"\n            >\n                <Palette />\n            </slot>\n\n            <div\n                class=\"node-container\"\n                :style=\"nodeContainerStyle\"\n                @wheel=\"mouseWheel\"\n                @mouseenter=\"changeHoveredConnections\"\n                @mousemove=\"changeHoveredConnections\"\n                @mouseleave=\"clearHighlight\"\n            >\n                <CustomNode\n                    v-for=\"node in visibleNodes\"\n                    :key=\"node.id + counter.toString()\"\n                    :node=\"node\"\n                    :selected=\"selectedNodes.includes(node)\"\n                    :greyedOut=\"greyedOutNodes.includes(node)\"\n                    :interfaces=\"highlightInterfaces\"\n                    @select=\"(ev) => selectNode(node, ev)\"\n                />\n                <CustomNode\n                    v-for=\"node in ignoredNodes\"\n                    :key=\"node.id + counter.toString()\"\n                    :node=\"node\"\n                    :hidden=\"true\"\n                />\n            </div>\n\n            <svg\n                class=\"connections-container\"\n                @mouseenter=\"changeHoveredConnections\"\n                @mousemove=\"changeHoveredConnections\"\n                @mouseleave=\"clearHighlight\"\n                @wheel=\"mouseWheel\"\n            >\n                <PipelineManagerConnection\n                    v-for=\"connection in visibleConnections\"\n                    :key=\"connection.id + counter.toString()\"\n                    :connection=\"connection\"\n                    ref=\"connRefs\"\n                    :isHighlighted=\"highlightConnections.includes(connection)\"\n                />\n                <TemporaryConnection\n                    name=\"temporaryConnection\"\n                    :temporary-connection=\"temporaryConnection\"\n                    v-if=\"temporaryConnection && temporaryConnectionRender\"\n                    :connection=\"temporaryConnection\"\n                />\n            </svg>\n\n            <div class=\"selection-container\">\n                <RectangleSelection ref=\"rectangleSelection\"/>\n            </div>\n\n            <Zoom @zoom-in=\"zoomIn\" @zoom-out=\"zoomOut\" @center=\"center\" :floating=\"!hideHud\" />\n\n            <Return v-if=\"preview && isInSubgraph\" @click=\"returnFromSubgraph\" />\n\n            <Panel v-show=\"showWelcome\" :blur=\"false\" class=\"welcome-container-panel\">\n                <ParentMenu>\n                    <WelcomeMenu :loadFiles=\"loadFiles\" />\n                </ParentMenu>\n            </Panel>\n        </template>\n    </div>\n</template>\n\n<script>\n/* eslint-disable object-curly-newline */\nimport { EditorComponent, useGraph } from '@baklavajs/renderer-vue';\nimport { defineComponent, ref, computed, watch, onMounted } from 'vue';\nimport fuzzysort from 'fuzzysort';\nimport { BaklavaEvent } from '@baklavajs/events';\nimport { isJSONRPCRequest, isJSONRPCResponse, JSONRPC } from 'json-rpc-2.0';\nimport usePanZoom from './panZoom';\n\nimport CustomNode from './CustomNode.vue';\nimport PipelineManagerConnection from './connection/PipelineManagerConnection.vue';\nimport TemporaryConnection from './connection/TemporaryConnection.vue';\nimport Palette from '../components/Palette.vue';\nimport { useTemporaryConnection } from './temporaryConnection';\nimport NotificationHandler from '../core/notifications';\nimport EditorManager, { loadJsonFromRemoteLocation } from '../core/EditorManager';\nimport RectangleSelection from './RectangleSelection.vue';\nimport nodeInsideSelection from './rectangleSelection.js';\nimport getExternalApplicationManager from '../core/communication/ExternalApplicationManager';\nimport jsonRPC, { frontendEndpoints } from '../core/communication/rpcCommunication';\nimport Zoom from '../components/Zoom.vue';\nimport Return from '../components/Return.vue';\nimport Panel from '../components/Panel.vue';\nimport { ParentMenu, WelcomeMenu } from '../components/menu';\nimport { loadingScreen } from '../core/utils';\n\nexport default defineComponent({\n    extends: EditorComponent,\n    props: {\n        loading: {\n            required: true,\n            type: Boolean,\n        },\n    },\n    components: {\n        CustomNode,\n        Panel,\n        ParentMenu,\n        PipelineManagerConnection,\n        TemporaryConnection,\n        Palette,\n        RectangleSelection,\n        WelcomeMenu,\n        Zoom,\n        Return,\n    },\n    emits: ['setLoad'],\n    setup(props, { emit }) {\n        const {\n            el,\n            counter,\n            nodes,\n            connections,\n            selectedNodes,\n            nodeContainerStyle,\n            keyDown,\n            keyUp,\n        } = EditorComponent.setup(props);\n\n        const connRefs = ref([]);\n        const { graph } = useGraph();\n\n        const panZoom = usePanZoom();\n        const temporaryConnection = useTemporaryConnection();\n        const editorManager = EditorManager.getEditorManagerInstance();\n\n        const highlightConnections = ref([]);\n        const highlightInterfaces = ref([]);\n\n        const readonly = computed(() => props.viewModel.editor.readonly);\n        const hideHud = computed(() => props.viewModel.editor.hideHud);\n\n        const rectangleSelection = ref(null);\n        const selectedNodesCtrlBackup = [];\n        const scale = computed(() => graph.value.scaling);\n\n        const searchQuery = computed(() => props.viewModel.editor.searchQuery);\n        const greyedOutNodes = ref([]);\n\n        let pressStartTime = 0;\n        const longPressMilisThreshold = 100;\n\n        const editorStyle = computed(() => ({\n            '--scale': scale.value,\n            cursor: panZoom.dragging.value ? 'move' : 'default',\n        }));\n\n        const isInSubgraph = computed(() => props.viewModel.editor.isInSubgraph());\n\n        const preview = computed(() => props.viewModel.editor.preview);\n\n        const unselectAllNodes = () => {\n            /* eslint-disable vue/no-mutating-props,no-param-reassign */\n            props.viewModel.displayedGraph.selectedNodes = [];\n        };\n\n        const setLoad = new BaklavaEvent();\n        setLoad.subscribe('editor', (value) => {\n            emit('setLoad', value);\n        });\n        props.viewModel.editor.events.setLoad = setLoad;\n\n        const appendSelectMultipleNodes = () => {\n            graph.value.nodes.forEach((node) => {\n                if (graph.value.selectedNodes.includes(node)) {\n                    return;\n                }\n\n                const selectionBoundingRect = rectangleSelection.value.boundingRect;\n\n                if (nodeInsideSelection(graph.value, node, selectionBoundingRect)) {\n                    graph.value.selectedNodes.push(node);\n                }\n            });\n        };\n\n        const selectNode = (node, event) => {\n            // If select was triggered by event check if CTRL is pressed,\n            // otherwise use default method\n            if ((event && !(event.ctrlKey)) || (!event && !props.viewModel.commandHandler.pressedKeys.includes('Control'))) {\n                unselectAllNodes();\n            }\n\n            props.viewModel.displayedGraph.selectedNodes.push(node);\n        };\n\n        const selectMultipleNodes = () => {\n            graph.value.selectedNodes = [];\n            graph.value.nodes.forEach((node) => {\n                const selectionBoundingRect = rectangleSelection.value.boundingRect;\n\n                if (nodeInsideSelection(graph.value, node, selectionBoundingRect)) {\n                    graph.value.selectedNodes.push(node);\n                }\n            });\n        };\n\n        let pointersDown = 0;\n        const onPointerDown = (ev) => {\n            pointersDown += 1;\n            if (ev.target === el.value) {\n                panZoom.onPointerDown(ev);\n            }\n            temporaryConnection.onMouseDown(ev);\n\n            pressStartTime = new Date();\n        };\n\n        const onRightPointerDown = (ev) => {\n            if (ev.target === el.value) {\n                unselectAllNodes();\n                rectangleSelection.value.onPointerDown(ev);\n            }\n\n            pressStartTime = new Date();\n        };\n\n        const onPointerMove = (ev) => {\n            panZoom.onPointerMove(ev);\n            temporaryConnection.onMouseMove(ev);\n            rectangleSelection.value.onPointerMove(ev);\n            if (rectangleSelection.value.selecting) {\n                selectMultipleNodes();\n            }\n        };\n\n        const onPointerUp = (ev) => {\n            panZoom.onPointerUp(ev);\n            temporaryConnection.onMouseUp();\n\n            // handle press & hold\n            const currentTime = new Date();\n            const elapsedTime = currentTime - pressStartTime;\n            if (elapsedTime < longPressMilisThreshold\n                && ev.target === el.value) {\n                unselectAllNodes();\n            }\n\n            if (pointersDown === 1) {\n                document.removeEventListener('pointerup', onPointerUp);\n                document.removeEventListener('pointermove', onPointerMove);\n            }\n            pointersDown -= 1;\n        };\n\n        const onRightPointerUp = (ev) => {\n            // handle press & hold right mouse button\n            const currentTime = new Date();\n            const elapsedTime = currentTime - pressStartTime;\n            if (elapsedTime >= longPressMilisThreshold\n                && ev.target === el.value) {\n                appendSelectMultipleNodes();\n            }\n            rectangleSelection.value.onPointerUp();\n\n            document.removeEventListener('pointerup', onRightPointerUp);\n            document.removeEventListener('pointermove', onPointerMove);\n        };\n\n        const onRightPointerDownCtrl = (ev) => {\n            rectangleSelection.value.onPointerDown(ev);\n            selectedNodesCtrlBackup.value = graph.value.selectedNodes;\n        };\n\n        const onRightPointerUpCtrl = () => {\n            graph.value.selectedNodes = selectedNodesCtrlBackup.value;\n            appendSelectMultipleNodes();\n            rectangleSelection.value.onPointerUp();\n\n            document.removeEventListener('pointerup', onRightPointerUpCtrl);\n            document.removeEventListener('pointermove', onPointerMove);\n        };\n\n        document.addEventListener('pointerdown', (ev) => {\n            // Dragging\n            if (ev.button === 0 && !ev.shiftKey) {\n                onPointerDown(ev);\n                document.addEventListener('pointerup', onPointerUp);\n                document.addEventListener('pointermove', onPointerMove);\n            }\n\n            // Rectangle selection\n            if (readonly.value) {\n                return;\n            }\n            if (ev.button === 2 && ev.ctrlKey) {\n                onRightPointerDownCtrl(ev);\n                document.addEventListener('pointerup', onRightPointerUpCtrl);\n                document.addEventListener('pointermove', onPointerMove);\n            } else if (ev.button === 2) {\n                onRightPointerDown(ev);\n                document.addEventListener('pointerup', onRightPointerUp);\n                document.addEventListener('pointermove', onPointerMove);\n            }\n        });\n\n        const clearHighlight = () => {\n            highlightConnections.value.splice(0, highlightConnections.value.length);\n        };\n\n        // If a connection is removed by clicking on it all highlighted connections are removed\n        watch(connections.value, () => {\n            clearHighlight();\n        });\n\n        const addHighlight = (connection) => {\n            if (!highlightConnections.value.includes(connection)) {\n                highlightConnections.value.push(connection);\n            }\n        };\n\n        const addInterfaceHighlight = (it) => {\n            if (!highlightInterfaces.value.includes(it)) {\n                highlightInterfaces.value.push(it);\n            }\n        };\n        const clearInterfaceHighlight = () => {\n            highlightInterfaces.value.splice(0, highlightInterfaces.value.length);\n        };\n\n        watch(temporaryConnection?.temporaryConnection, () => {\n            if (typeof (temporaryConnection ?? null) === 'undefined') return;\n            if (temporaryConnection?.temporaryConnection === null) return;\n            if (temporaryConnection?.temporaryConnection?.value?.from) {\n                for (let a = 0; a < nodes.value.length; a += 1) {\n                    const viableConnections = [\n                        ...(Object.values(nodes.value[a].outputs) || []),\n                        ...(Object.values(nodes.value[a].inputs) || []),\n                    ];\n\n                    viableConnections.forEach((n) => {\n                        if (n.port && n !== temporaryConnection.temporaryConnection.value.from) {\n                            const result = graph.value.checkConnection(\n                                temporaryConnection.temporaryConnection.value.from,\n                                n,\n                            );\n                            if (!result.connectionAllowed) {\n                                addInterfaceHighlight(n);\n                            }\n                        }\n                    });\n                }\n            } else {\n                clearInterfaceHighlight();\n            }\n        });\n\n        const removeHighlight = (connection) => {\n            const index = highlightConnections.value.indexOf(connection);\n            if (index >= 0) {\n                highlightConnections.value.splice(index, 1);\n            }\n        };\n\n        const findConnectionsToHighlight = (elementsUnderCursor) => {\n            const elementsWithZIndex = elementsUnderCursor.map((element) => {\n                const z = window.getComputedStyle(element).zIndex;\n                return {\n                    z_index: Number.isNaN(parseInt(z, 10)) ? 0 : parseInt(z, 10),\n                    element,\n                };\n            });\n\n            const highestZIndexElement =\n                elementsWithZIndex.reduce(\n                    (max, curr) => (curr.z_index > max.z_index ? curr : max), elementsWithZIndex[0],\n                );\n\n            const hoveredHtml = connRefs.value.filter((conn) =>\n                conn.containsPoint([highestZIndexElement.element]),\n            );\n            // Convert DOM elements to BaklavaJS connections.\n            const hoveredConnections = connections.value.filter(\n                (conn) => hoveredHtml.filter((htmlEl) => htmlEl.connection === conn).length > 0,\n            );\n\n            // Check for hovered interfaces.\n            const hoveredInterface = elementsUnderCursor.find((element) => {\n                // Check if the element is a port or inside an interface.\n                if (element.classList?.contains('__port')) {\n                    return true;\n                }\n                if (element.classList?.contains('baklava-node-interface')) {\n                    return true;\n                }\n                // Check if element is inside an interface.\n                return element.closest?.('.baklava-node-interface') !== null;\n            });\n\n            let connectionsToHighlight = [];\n\n            if (hoveredConnections.length > 0) {\n                const highlighted = connections.value.filter(\n                    (conn) => hoveredConnections.filter((hov) => hov.from === conn.from).length > 0,\n                );\n                const mostSuitableHighlight = highlighted.at(0);\n                if (mostSuitableHighlight) {\n                    connectionsToHighlight = [mostSuitableHighlight];\n                }\n            } else if (hoveredInterface) {\n                // Find the interface ID and highlight all connections.\n                let interfaceElement = hoveredInterface;\n\n                interfaceElement = hoveredInterface.closest('.baklava-node-interface');\n                if (interfaceElement?.id) {\n                    // Find all connections that involve this interface.\n                    connectionsToHighlight = connections.value.filter((conn) =>\n                        conn.from?.id === interfaceElement.id\n                        || conn.to?.id === interfaceElement.id,\n                    );\n                }\n            }\n\n            return connectionsToHighlight;\n        };\n\n        const changeHoveredConnections = (ev) => {\n            const elements = document.elementsFromPoint(ev.clientX, ev.clientY);\n            const connectionsToHighlight = findConnectionsToHighlight(elements);\n\n            // Toggle highlighting of connections.\n            connections.value.forEach((conn) => {\n                if (connectionsToHighlight.includes(conn)) {\n                    addHighlight(conn);\n                } else {\n                    removeHighlight(conn);\n                }\n            });\n        };\n\n        const ignoredLayers = computed(() => props.viewModel.ignoredLayers);\n        const ignorableLayers = computed(() => props.viewModel.layers);\n\n        const ignoredInterfacesTypes = computed(() => {\n            const temp = new Set();\n\n            ignorableLayers.value.forEach((layer) => {\n                if (layer.nodeInterfaces && ignoredLayers.value.has(layer.name)) {\n                    layer.nodeInterfaces.forEach(temp.add, temp);\n                }\n            });\n            return temp;\n        });\n\n        const ignoredNodesTypes = computed(() => {\n            const temp = new Set();\n\n            ignorableLayers.value.forEach((layer) => {\n                if (layer.nodeLayers && ignoredLayers.value.has(layer.name)) {\n                    layer.nodeLayers.forEach(temp.add, temp);\n                }\n            });\n            return temp;\n        });\n\n        const visibleNodes = computed(() =>\n            nodes.value.filter((n) => !ignoredNodesTypes.value.has(n.layer)),\n        );\n        const ignoredNodes = computed(() =>\n            nodes.value.filter((n) => ignoredNodesTypes.value.has(n.layer)),\n        );\n        const ignoredNodesId = computed(() => ignoredNodes.value.map((n) => n.id));\n\n        const visibleConnections = computed(() =>\n            connections.value.filter(\n                (c) =>\n                    !c.from.type?.some((t) => ignoredInterfacesTypes.value.has(t)) &&\n                    !c.to.type?.some((t) => ignoredInterfacesTypes.value.has(t)) &&\n                    !ignoredNodesId.value.includes(c.from.nodeId) &&\n                    !ignoredNodesId.value.includes(c.to.nodeId),\n            ),\n        );\n\n        const highlightedNodes = computed(() =>\n            visibleNodes.value.filter(\n                (n) => props.viewModel.displayedGraph.selectedNodes.includes(n),\n            ),\n        );\n\n        const externalApplicationManager = getExternalApplicationManager();\n\n        watch(visibleNodes, async (value, old) => {\n            if (!externalApplicationManager.isConnected()) return;\n            if (!editorManager.notifyWhenChanged) return;\n            const newIds = Object.values(value).map((n) => n.id);\n            const oldIds = Object.values(old).map((n) => n.id);\n            const nodesAdded = [];\n            Object.values(value).forEach((node) => {\n                if (!(oldIds.includes(node.id))) {\n                    nodesAdded.push(node.save());\n                }\n            });\n            const nodesDeleted = [];\n            Object.values(old).forEach((node) => {\n                if (!(newIds.includes(node.id))) {\n                    nodesDeleted.push(node.id);\n                }\n            });\n            const data = {\n                graph_id: graph.value.id,\n                nodes: {\n                    added: nodesAdded,\n                    deleted: nodesDeleted,\n                },\n            };\n            await externalApplicationManager.notifyAboutChange('nodes_on_change', data);\n        });\n\n        watch(visibleConnections, async (value, old) => {\n            if (!externalApplicationManager.isConnected()) return;\n            if (!editorManager.notifyWhenChanged) return;\n            const newIds = Object.values(value).map((n) => n.id);\n            const oldIds = Object.values(old).map((n) => n.id);\n            const connectionsAdded = [];\n            Object.values(value).forEach((connection) => {\n                if (!(oldIds.includes(connection.id))) {\n                    connectionsAdded.push({\n                        id: connection.id,\n                        from: connection.from.id,\n                        to: connection.to.id,\n                    });\n                }\n            });\n            const connectionsDeleted = [];\n            Object.values(old).forEach((connection) => {\n                if (!(newIds.includes(connection.id))) {\n                    connectionsDeleted.push({\n                        from: connection.from.id,\n                        to: connection.to.id,\n                    });\n                }\n            });\n            const data = {\n                graph_id: graph.value.id,\n                connections: {\n                    added: connectionsAdded,\n                    deleted: connectionsDeleted,\n                },\n            };\n            await externalApplicationManager.notifyAboutChange('connections_on_change', data);\n        });\n\n        watch(highlightedNodes, async (value, old) => {\n            if (!externalApplicationManager.isConnected()) return;\n            if (!editorManager.notifyWhenChanged) return;\n            const newIds = Object.values(value).map((n) => n.id);\n            const oldIds = Object.values(old).map((n) => n.id);\n            const nodesSelected = [];\n            Object.values(value).forEach((node) => {\n                if (!(oldIds.includes(node.id))) {\n                    nodesSelected.push(node.id);\n                }\n            });\n            const nodesUnselected = [];\n            Object.values(old).forEach((node) => {\n                if (!(newIds.includes(node.id))) {\n                    nodesUnselected.push(node.id);\n                }\n            });\n            const data = {\n                graph_id: graph.value.id,\n                nodes: {\n                    selected: nodesSelected,\n                    unselected: nodesUnselected,\n                },\n            };\n            await externalApplicationManager.notifyAboutChange('nodes_on_highlight', data);\n        });\n\n        const filterNodes = (query) => {\n            const threshold = -50;\n\n            const matchingNodes = visibleNodes.value.filter((node) => {\n                const { type } = node;\n\n                const resultTitle = fuzzysort.single(query, node.title);\n                const resultType = fuzzysort.single(query, type);\n\n                if ((resultTitle !== null && resultTitle.score > threshold) ||\n                    (resultType !== null && resultType.score > threshold)) {\n                    node.highlightedTitle = fuzzysort.highlight(resultTitle, '<span>', '</span>');\n                    node.highlightedType = fuzzysort.highlight(resultType, '<span>', '</span>');\n\n                    return true;\n                }\n                node.highlightedTitle = node.title;\n                node.highlightedType = node.type;\n                return false;\n            });\n\n            return matchingNodes;\n        };\n\n        const nodeTitles = computed(() =>\n            nodes.value.map((n) => n.title),\n        );\n\n        watch([searchQuery, nodeTitles], () => {\n            if (searchQuery.value === undefined || searchQuery.value === '') {\n                greyedOutNodes.value = [];\n                visibleNodes.value.forEach((node) => {\n                    node.highlightedTitle = node.title;\n                    node.highlightedType = node.type;\n                });\n                return;\n            }\n            const matchingNodes = filterNodes(searchQuery.value);\n\n            const nonMatchingNodes = visibleNodes.value.filter(\n                (node) => !matchingNodes.includes(node),\n            );\n\n            greyedOutNodes.value = nonMatchingNodes;\n        });\n\n        const defaultSpecification = process.env.VUE_APP_SPECIFICATION_PATH !== undefined;\n        const defaultDataflow = process.env.VUE_APP_DATAFLOW_PATH !== undefined;\n        const verboseLoad =\n            process.env.VUE_APP_VERBOSE !== undefined && process.env.VUE_APP_VERBOSE === 'true';\n\n        /**\n         * Prepares the Editor based on specification configuration.\n         *\n         * The function validates the specification, updates the Editor\n         * and provides error messages for erroneous content.\n         *\n         * @param specification The object holding the parsed specification file\n         */\n        async function updateEditorSpecification(specification) {\n            let errors = EditorManager.validateSpecification(specification);\n            let warnings;\n            let info;\n\n            if (errors.length) {\n                NotificationHandler.terminalLog('error', 'Specification is invalid', errors);\n                if (editorManager.specificationVersion !== specification.version) {\n                    NotificationHandler.terminalLog(\n                        'error',\n                        'Mismatched specification version',\n                        `Specification version (${specification.version}) differs from the current version (${editorManager.specificationVersion}). It may result in unexpected behaviour.` +\n                        ' Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.',\n                    );\n                }\n                return errors;\n            }\n\n            ({ errors, warnings, info } = await editorManager.updateEditorSpecification(specification)); // eslint-disable-line prefer-const,max-len\n            if (Array.isArray(warnings) && warnings.length) {\n                NotificationHandler.terminalLog(\n                    'warning',\n                    'Issue when loading specification',\n                    warnings,\n                );\n            }\n            if (Array.isArray(errors) && errors.length) {\n                NotificationHandler.terminalLog('error', 'Specification is invalid', errors);\n                if (Array.isArray(info) && info.length) {\n                    NotificationHandler.terminalLog(\n                        'error',\n                        'Mismatched specification version',\n                        `${info} Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.`,\n                    );\n                }\n            } else if (Array.isArray(info) && info.length) {\n                NotificationHandler.terminalLog('info', 'Specification loaded', info);\n            }\n\n            return errors;\n        }\n\n        /**\n         * Prepares the Editor based on dataflow configuration.\n         *\n         * The function loads the dataflow\n         * and provides error messages for erroneous content.\n         *\n         * @param dataflow The object holding the parsed dataflow file\n         */\n        async function updateDataflow(dataflow) {\n            const { errors, warnings, info } = await editorManager.loadDataflow(dataflow);\n\n            if (Array.isArray(warnings) && warnings.length) {\n                NotificationHandler.terminalLog(\n                    'warning',\n                    'Issue when loading dataflow',\n                    warnings,\n                );\n            }\n            if (Array.isArray(errors) && errors.length) {\n                const messageTitle = process.env.VUE_APP_GRAPH_DEVELOPMENT_MODE === 'true' ?\n                    'Softload enabled, errors found while loading the dataflow' :\n                    'Dataflow is invalid';\n                NotificationHandler.terminalLog('error', messageTitle, errors);\n                if (Array.isArray(info) && info.length) {\n                    NotificationHandler.terminalLog(\n                        'error',\n                        'Mismatched dataflow version',\n                        `${info} Please refer to https://antmicro.github.io/kenning-pipeline-manager/changelogs.html to see if that is the case.`,\n                    );\n                }\n            } else if (Array.isArray(info) && info.length) {\n                NotificationHandler.terminalLog('info', 'Dataflow loaded', info);\n            }\n\n            return errors;\n        }\n\n        /* eslint-disable no-lonely-if */\n        onMounted(async () => {\n            // Load specification and/or dataflow delivered via window.postMessage\n            window.addEventListener('message', async (event) => {\n                // TODO: introduce mechanism for checking event.origin against allowed origins\n                const data = event.data ?? {};\n                data.jsonrpc ??= JSONRPC;\n\n                if (isJSONRPCResponse(data)) {\n                    if (event.source === window) return;\n                    jsonRPC.client.receive(data);\n                    return;\n                }\n\n                data.id ??= jsonRPC.client.createID();\n                if (!isJSONRPCRequest(data)) return;\n\n                let response = data.method === 'register_external_frontend'\n                    ? externalApplicationManager.registerFrontendApplication(event.source, data)\n                    : null;\n\n                response ??= event.data.method in frontendEndpoints\n                    ? (await jsonRPC.server.receive(data))\n                    : (await jsonRPC.requestAdvanced(data, {\n                        externalApp: externalApplicationManager.externalApp,\n                    }));\n\n                if (response) event.source.postMessage(JSON.parse(JSON.stringify(response)), '*');\n            });\n\n            NotificationHandler.setShowNotification(false);\n            editorManager.updateMetadata({}); // Defaulting metadata values\n\n            // eslint-disable-next-line no-use-before-define\n            await loadingScreen(loadInit, setLoad);\n        });\n\n        const loadInit = async () => {\n            const escapedsearch = window.location.search.replace(/&amp;/g, '&');\n            const urlParams = new URLSearchParams(escapedsearch);\n            if (urlParams.has('preview')) {\n                const setting = urlParams.get('preview') === 'true';\n                props.viewModel.editor.preview = setting;\n            }\n\n            let specText;\n            // Try loading default specification and/or dataflow from URLs provided in an\n            if (urlParams.has('spec')) {\n                const [status, ret] = await loadJsonFromRemoteLocation(urlParams.get('spec'));\n                if (status === false) {\n                    NotificationHandler.terminalLog(\n                        'error',\n                        ret,\n                    );\n                    NotificationHandler.terminalLog(\n                        'error',\n                        `Failed to load the specification file from: ${urlParams.get('spec')}`,\n                    );\n                } else {\n                    specText = ret;\n                }\n            } else if (defaultSpecification) {\n                // Use raw-loader which does not parse the specification so that it is possible\n                // To add a more verbose validation log\n                if (verboseLoad) {\n                    specText =\n                        require(`!!raw-loader!${process.env.VUE_APP_SPECIFICATION_PATH}`).default; // eslint-disable-line global-require,import/no-dynamic-require\n                } else {\n                    specText = require(process.env.VUE_APP_SPECIFICATION_PATH); // eslint-disable-line global-require,import/no-dynamic-require,max-len\n                }\n            }\n\n            if (specText !== undefined) {\n                if (urlParams.has('include')) {\n                    if (specText.include === undefined) specText.include = [];\n                    specText.include.push(urlParams.get('include'));\n                }\n                const errors = await updateEditorSpecification(specText);\n\n                if (errors.length) {\n                    NotificationHandler.restoreShowNotification();\n                    return;\n                }\n\n                let dataflow;\n                if (urlParams.has('graph')) {\n                    const [status, ret] = await loadJsonFromRemoteLocation(urlParams.get('graph'));\n                    if (status === false) {\n                        NotificationHandler.terminalLog(\n                            'error',\n                            ret,\n                        );\n                        NotificationHandler.terminalLog(\n                            'error',\n                            `Failed to load the graph file from: ${urlParams.get('graph')}`,\n                        );\n                    } else {\n                        dataflow = ret;\n                    }\n                } else if (defaultDataflow) {\n                    dataflow = require(process.env.VUE_APP_DATAFLOW_PATH); // eslint-disable-line global-require,max-len,import/no-dynamic-require\n                }\n                if (dataflow) {\n                    await updateDataflow(dataflow);\n                }\n            }\n            NotificationHandler.restoreShowNotification();\n        };\n\n        const loadFiles = async (files) => loadingScreen(async () => {\n            const notify = NotificationHandler.showToast;\n\n            if (files.length > 2) {\n                notify('error', `Up to two files supported, inserted: ${files.length}`);\n                return;\n            }\n\n            let objects;\n            try {\n                const parse = async (file) => JSON.parse(await file.text());\n                objects = await Promise.all(Array.from(files).map(parse));\n            } catch (error) {\n                notify('error', 'Dropped file is not in JSON format');\n                return;\n            }\n\n            const isSpecificationFunc = (o) => Boolean(o.nodes || o.include || o.includeGraphs);\n            const isDataflowFunc = (o) => Boolean(o.graphs && !isSpecificationFunc(o));\n            const isInvalid = objects.map((o) => !isSpecificationFunc(o) && !isDataflowFunc(o));\n\n            // [invalid, invalid]\n            if (isInvalid.every(Boolean)) {\n                if (objects.length === 1) notify('error', 'Provided file is not of Pipeline Manager format');\n                else notify('error', 'Neither of provided files is of Pipeline Manager format');\n                return;\n            }\n\n            // Remove invalid\n            objects = objects.filter((_, i) => !isInvalid[i]);\n            if (isInvalid.some(Boolean)) {\n                notify('warning', 'One of the objects is not of Pipeline Manager format');\n            }\n\n            const isSpecification = objects.map(isSpecificationFunc);\n            const isDataflow = objects.map(isDataflowFunc);\n            let specification;\n            let dataflow;\n\n            if (isSpecification.every(Boolean)) {\n                // [spec], [spec, spec]\n                if (objects.length > 1) {\n                    notify('warning', 'Two specifications provided, using the first one.');\n                }\n                [specification] = objects;\n            } else if (isDataflow.every(Boolean)) {\n                // [dataflow], [dataflow, dataflow]\n                if (objects.length > 1) {\n                    notify('warning', 'Two dataflows provided, using the first one.');\n                }\n                [dataflow] = objects;\n            } else if (isSpecification.some(Boolean) && isDataflow.some(Boolean)) {\n                // [spec, dataflow], [dataflow, spec]\n                if (isSpecification[0]) [specification, dataflow] = objects;\n                else [dataflow, specification] = objects;\n            }\n\n            let isValidSpec = true;\n            if (specification) {\n                if (externalApplicationManager.usesBackend()) {\n                    NotificationHandler.showToast(\n                        'warning',\n                        'Specification is managed by an external application.',\n                    );\n                    isValidSpec = false;\n                } else {\n                    const errors = await updateEditorSpecification(specification);\n                    isValidSpec = !errors.length;\n                }\n            }\n\n            if (isValidSpec && dataflow) {\n                await updateDataflow(dataflow);\n            }\n        }, setLoad);\n\n        const onDrop = async (event) => {\n            event.preventDefault();\n            event.dataTransfer.dropEffect = 'copy';\n            const files = [];\n            if (event.dataTransfer.items) {\n                [...event.dataTransfer.items].filter(\n                    (item) => item.kind === 'file',\n                ).forEach(\n                    (item) => files.push(item.getAsFile()),\n                );\n            } else {\n                files.push(...event.dataTransfer.files);\n            }\n            await loadFiles(files);\n        };\n\n        const center = () => {\n            editorManager.centerZoom();\n        };\n\n        const returnFromSubgraph = () => {\n            editorManager.returnFromSubgraph();\n        };\n\n        const showWelcome =\n            computed(() => editorManager.baklavaView.welcome &&\n                !editorManager.baklavaView.editor.readonly &&\n                !nodes.value.length &&\n                !editorManager.editor.isInSubgraph());\n\n        return {\n            el,\n            counter,\n            selectedNodes,\n            nodeContainerStyle,\n            onRightPointerUp,\n            onDrop,\n            nodes,\n            keyDown,\n            keyUp,\n            selectNode,\n            rectangleSelection,\n            greyedOutNodes,\n            temporaryConnection: temporaryConnection.temporaryConnection,\n            temporaryConnectionRender: temporaryConnection.render,\n            mouseWheel: panZoom.onMouseWheel,\n            dragging: panZoom.dragging,\n            changeHoveredConnections,\n            highlightConnections,\n            connRefs,\n            clearHighlight,\n            readonly,\n            hideHud,\n            scale,\n            visibleConnections,\n            visibleNodes,\n            ignoredNodes,\n            highlightInterfaces,\n            editorStyle,\n            zoomIn: panZoom.onZoomIn,\n            zoomOut: panZoom.onZoomOut,\n            center,\n            returnFromSubgraph,\n            isInSubgraph,\n            preview,\n            showWelcome,\n            loadFiles,\n            validating: editorManager.validating,\n        };\n    },\n});\n</script>\n","<!--\nCopyright (c) 2022-2025 Antmicro <www.antmicro.com>\n\nSPDX-License-Identifier: Apache-2.0\n-->\n\n<!--\nThe baklavajs functionality was fully copied to this component, as the original\nimplementation uses `<script setup>` which does not work well with `extends` feature.\n\nAside from the original source code, the custom node implements displaying name tags\nfor properties that do not display them, support for readonly mode that prevents the user\nfrom moving or deleting the nodes.\n -->\n\n<template>\n    <div\n        :id=\"node.id\"\n        ref=\"nodeRef\"\n        class=\"baklava-node\"\n        :class=\"classes\"\n        :style=\"styles\"\n        :data-node-type=\"node.type\"\n        @pointerdown.left.exact=\"(ev) => select(ev)\"\n        oncontextmenu=\"return false;\"\n    >\n        <div class=\"interface-cursor\">\n            <div class=\"line\" :style=\"interfaceCursorStyle\"></div>\n        </div>\n        <div\n            class=\"__title\"\n            ref=\"titleRef\"\n            :style=\"nodeTitleStyle\"\n            @pointerdown.left.exact=\"onMouseDown\"\n            @pointerdown.left=\"startDragWrapper($event)\"\n            @pointerdown.right=\"openContextMenuTitle\"\n            v-long-press:500=\"openContextMenuTitle\"\n        >\n            <img\n                class=\"__title-icon\"\n                v-if=\"iconPath !== undefined\"\n                :src=\"iconPath\"\n            >\n            <div v-if=\"!renaming\" class=\"__title-label\" v-html=\"DOMPurify.sanitize(nodeTitle)\">\n            </div>\n            <input\n                v-else\n                type=\"text\"\n                class=\"baklava-input\"\n                v-model=\"tempName\"\n                placeholder=\"Node Name\"\n                ref=\"renameField\"\n                v-click-outside=\"doneRenaming\"\n                @keydown=\"(ev) => ev.stopPropagation()\"\n                @keydown.enter=\"doneRenaming\"\n            />\n            <template v-if=\"nodeStyle.name !== undefined && nodeStyle.name !== null\">\n                <component\n                    v-if=\"nodeStyle.icon !== undefined\"\n                    class=\"__title-icon\"\n                    :is=\"nodeStyle.icon\"\n                    :imgURI=\"nodeStyle.name\"\n                />\n                <img\n                    v-else\n                    class=\"__title-icon\"\n                    :src=\"nodeStyle.name\"\n                />\n             </template>\n            <icons.Subgraph\n                class=\"__subgraph-icon\"\n                v-if=\"isGraphNode || nodeHasRelatedGraphs\"\n            />\n            <div\n                v-if=\"pillText !== undefined\"\n                class=\"pill\"\n                :style=\"nodePillStyle\"\n                v-html=\"DOMPurify.sanitize(pillText)\"\n            />\n            <CustomContextMenu\n                v-if=\"showContextMenuTitle\"\n                v-model=\"showContextMenuTitle\"\n                :x=\"contextMenuTitleX\"\n                :y=\"contextMenuTitleY\"\n                :items=\"contextMenuTitleItems\"\n                :urls=\"nodeURLs\"\n                :style=\"contextMenuStyle\"\n                @pointerdown.left.stop\n                @click=\"onContextMenuTitleClick\"\n                @sizeUpdate=\"onContextMenuSizeUpdate\"\n            />\n        </div>\n\n        <div\n            class=\"__content\"\n            @pointerdown.right=\"openContextMenuTitle\"\n            >\n            <!-- Properties -->\n            <div class=\"__properties\">\n                <div\n                    v-for=\"input in displayedProperties\"\n                    :key=\"input.id\"\n                    @pointerdown.right.exact=\"openContextMenuProperty(input, $event)\"\n                >\n                    {{ getOptionName(input.componentName) ? `${input.name}:` : '' }}\n                    <CustomInterface\n                        :node=\"node\"\n                        :intf=\"input\"\n                        :toggleGroup=\"toggleGroup\"\n                        :updateDynamicInterfaces=\"updateDynamicInterfaces\"\n                    />\n                </div>\n            </div>\n\n            <div class=\"__interfaces\">\n                <!-- Outputs -->\n                <div class=\"__outputs\" ref=\"rightSocketsRefs\">\n                    <template v-for=\"output in displayedRightRows\">\n                        <CustomInterface\n                            :key=\"output.id\"\n                            v-if=\"output\"\n                            @pointerdown.left.shift=\"pickInterface(output, $event)\"\n                            @pointerdown.right.exact=\"openContextMenuInterface(output, $event)\"\n                            v-long-press-to-right:500\n                            :node=\"node\"\n                            :intf=\"output\"\n                            :highlighted=\"props.interfaces?.includes(output)\"\n                            :picked=\"isPickedInterface(output)\"\n                            :switchSides=\"switchSides\"\n                        />\n                        <!-- eslint-disable-next-line vue/require-v-for-key -->\n                        <div v-else class=\"baklava-node-interface --output\">&nbsp;</div>\n                    </template>\n                </div>\n\n                <!-- Inputs -->\n                <div class=\"__inputs\" ref=\"leftSocketsRefs\">\n                    <template v-for=\"input in displayedLeftRows\">\n                        <CustomInterface\n                            :key=\"input.id\"\n                            v-if=\"input\"\n                            @pointerdown.left.shift=\"pickInterface(input, $event)\"\n                            @pointerdown.right=\"openContextMenuInterface(input, $event)\"\n                            v-long-press-to-right:500\n                            :node=\"node\"\n                            :intf=\"input\"\n                            :highlighted=\"props.interfaces?.includes(input)\"\n                            :picked=\"isPickedInterface(input)\"\n                            :switchSides=\"switchSides\"\n                        />\n                        <!-- eslint-disable-next-line vue/require-v-for-key -->\n                        <div v-else class=\"baklava-node-interface --input\">&nbsp;</div>\n                    </template>\n                </div>\n            </div>\n\n            <CustomContextMenu\n                v-if=\"showContextMenuInterface\"\n                v-model=\"showContextMenuInterface\"\n                :x=\"contextMenuInterfaceX\"\n                :y=\"contextMenuInterfaceY\"\n                :items=\"contextMenuInterfaceItems\"\n                :style=\"contextMenuStyle\"\n                @click=\"onContextMenuInterfaceClick\"\n            />\n            <CustomContextMenu\n                v-if=\"showContextMenuProperty\"\n                v-model=\"showContextMenuProperty\"\n                :x=\"contextMenuPropertyX\"\n                :y=\"contextMenuPropertyY\"\n                :items=\"contextMenuPropertyItems\"\n                :style=\"contextMenuStyle\"\n                @click=\"onContextMenuPropertyClick\"\n            />\n\n        </div>\n    </div>\n</template>\n\n<script setup>\n/* eslint-disable object-curly-newline */\nimport { ref, computed, toRef, onUpdated, onMounted, nextTick, watch } from 'vue';\nimport { useViewModel, useGraph } from '@baklavajs/renderer-vue';\nimport { AbstractNode } from '@baklavajs/core';\nimport DOMPurify from 'dompurify';\n\nimport useGroupDragMove from './useGroupDragMove';\nimport CustomInterface from './CustomInterface.vue';\nimport CustomContextMenu from './ContextMenu.vue';\nimport { gridSnapper } from '../core/snappers';\nimport icons from '../icons/index';\nimport doubleClick from '../core/doubleClick.js';\nimport { getOptionName, updateInterfacePosition, removeNode } from './CustomNode.js';\nimport {\n    startTransaction, commitTransaction,\n} from '../core/History.ts';\n\nimport EditorManager, { DEFAULT_GRAPH_NODE_TYPE } from '../core/EditorManager';\nimport NotificationHandler from '../core/notifications.js';\nimport getExternalApplicationManager from '../core/communication/ExternalApplicationManager';\n\nimport { configurationState, menuState } from '../core/nodeCreation/ConfigurationState.ts';\n\n// Baklavajs implementation\n\nconst props = defineProps({\n    node: AbstractNode,\n    selected: Boolean,\n    greyedOut: Boolean,\n    hidden: Boolean,\n    interfaces: Array,\n});\n\nconst emit = defineEmits(['select']);\n\nconst { viewModel } = useViewModel();\nconst { graph } = useGraph();\nconst movementStep = computed(() => viewModel.value.movementStep);\n\n// Template refs\nconst nodeRef = ref(null);\nconst titleRef = ref(null);\nconst renaming = ref(false);\nconst renameField = ref(null);\nconst tempName = ref('');\n\n// Reactive values\nconst node = toRef(props, 'node');\nconst nodeURLs = viewModel.value.editor.getNodeURLs(props.node.type);\nconst nodeColor = computed(() => viewModel.value.editor.getNodeColor(node.value));\nconst nodeTitleColor = computed(() => viewModel.value.editor.getTextColor(nodeColor.value));\nconst nodeCategory = viewModel.value.editor.getNodeCategory(props.node.type);\nconst isGraphNode = viewModel.value.editor.isGraphNode(props.node.type);\nconst nodeHasRelatedGraphs\n    = computed(() => viewModel.value.editor.nodeHasRelatedGraphs(node.value));\nconst pillText = computed(() => viewModel.value.editor.getPillText(node.value.type));\nconst pillColor = computed(() => viewModel.value.editor.getPillColor(node.value.type));\nconst pillTextColor = computed(() => viewModel.value.editor.getTextColor(pillColor.value));\n\nconst displayNoResources = !viewModel.value.editor.nodeURLsEmpty();\n\nconst editorManager = EditorManager.getEditorManagerInstance();\n\nconst displayedInputs = computed(() => Object.values(props.node.inputs).filter((ni) => !ni.hidden));\nconst displayedOutputs = computed(() =>\n    Object.values(props.node.outputs).filter((ni) => !ni.hidden),\n);\nconst sidebarProperties = computed(() =>\n    Object.values(displayedInputs.value)\n        .filter((intf) => !intf.port),\n);\nconst displayedProperties = computed(() => {\n    if (editorManager.baklavaView.settings.showHiddenProperties) {\n        return sidebarProperties.value;\n    }\n    return sidebarProperties.value\n        .filter((intf) => !(intf.hideOnDefault && (!intf.value || intf.value === intf.default)));\n});\n\nconst externalApplicationManager = getExternalApplicationManager();\n// Watch properties\nObject.entries(props.node.inputs).forEach(([name, input]) => {\n    if (name.startsWith('property_')) {\n        let firstWatch = true;\n        watch(input, async (value) => {\n            if (!externalApplicationManager.isConnected()) {\n                firstWatch = true;\n                return;\n            }\n            if (firstWatch || !editorManager.notifyWhenChanged) {\n                firstWatch = false;\n                return;\n            }\n            const data = {\n                graph_id: props.node.graphInstance.id,\n                node_id: props.node.id,\n                properties: [],\n            };\n            data.properties.push({\n                id: value.id,\n                new_value: value.value,\n            });\n            await externalApplicationManager.notifyAboutChange('properties_on_change', data);\n        });\n    }\n});\n\n// Send message about changed position\nconst notifyPositionChanged = (position) => {\n    if (!externalApplicationManager.isConnected()) return;\n    externalApplicationManager.notifyAboutChange('position_on_change', {\n        graph_id: props.node.graphInstance.id,\n        node_id: props.node.id,\n        position: {\n            x: position.x,\n            y: position.y,\n        },\n    });\n};\n// Create watcher for position\nwatch(props.node.position, notifyPositionChanged);\n\nconst focusOnRename = () => {\n    renameField.value.focus();\n    renameField.value.select();\n};\n\n// Title context menu\nconst showContextMenuTitle = ref(false);\nconst contextMenuTitleX = ref(0);\nconst contextMenuTitleY = ref(0);\nconst contextMenuVisibility = ref('hidden');\nconst contextMenuPosition = ref(0);\n\nconst contextMenuStyle = computed(() => ({\n    'transform-origin': '0 0',\n    transform: `scale(${1 / graph.value.scaling})`,\n    visible: contextMenuVisibility.value,\n}));\n\nconst contextMenuTitleItems = computed(() => {\n    const items = [];\n    items.push({ value: 'sidebar', label: 'Details', icon: icons.Sidebar, endSection: true });\n    if (editorManager.baklavaView.settings.editableNodeTypes &&\n        node.value.type !== DEFAULT_GRAPH_NODE_TYPE &&\n        !viewModel.value.editor.readonly) {\n        items.push(\n            { value: 'configure', label: 'Configure' },\n            { value: 'property', label: 'Add property' },\n            { value: 'interface', label: 'Add interface' },\n            { value: 'layer', label: 'Set layer' },\n            { value: 'delete-property', label: 'Delete property' },\n            { value: 'delete-interface', label: 'Delete interface', endSection: true },\n        );\n        if (!isGraphNode && !editorManager.editor.preview) {\n            items.push(\n                { value: 'addSubgraph', label: 'Add subgraph', icon: icons.Subgraph },\n                { value: 'addAndEditSubgraph', label: 'Add and edit subgraph', icon: icons.Subgraph },\n            );\n        }\n    }\n    if (isGraphNode) {\n        items.push({ value: 'editSubgraph', label: 'Go to graph', icon: icons.Subgraph });\n    }\n    if (nodeHasRelatedGraphs.value) {\n        const nodeInstance = node.value;\n        const nodeType = viewModel.value.editor.nodeTypes.get(props.node.type);\n        const toEntries = (graphs) => graphs?.map(({ id, name }) => [id, name]) ?? [];\n\n        // Merge related graphs from node type and instance\n        const relatedGraphs = Object.entries({\n            ...Object.fromEntries(toEntries(nodeType.relatedGraphs)),\n            ...Object.fromEntries(toEntries(nodeInstance.relatedGraphs)),\n        });\n\n        relatedGraphs.forEach(([id, name]) => {\n            items.push({ value: `gotoRelatedGraph ${id}`, label: `Go to ${name} graph`, icon: icons.Subgraph });\n        });\n    }\n    if (items.length > 1) {\n        items.at(-1).endSection = true;\n    }\n\n    items.push(...nodeURLs);\n\n    if (!viewModel.value.editor.readonly) {\n        if (items.length > 1) {\n            items.at(-1).endSection = true;\n        }\n        items.push(\n            { value: 'rename', label: 'Rename', icon: icons.Pencil },\n            { value: 'disconnect', label: 'Disconnect', icon: icons.Disconnect },\n            { value: 'delete', label: 'Delete', icon: icons.Bin },\n        );\n    }\n\n    // NOTE: This feature is disabled for now, as it is not fully implemented\n    const SUPPORT_NODE_UNWRAPPING = false;\n    if (SUPPORT_NODE_UNWRAPPING) {\n        if (isGraphNode) {\n            items.push({ value: 'unwrap', label: 'Unwrap Subgraph', icon: icons.Unwrap });\n        }\n    }\n\n    return items;\n});\n\nconst openSidebar = () => {\n    const { sidebar } = viewModel.value.displayedGraph;\n    sidebar.nodeId = props.node.id;\n    sidebar.visible = true;\n};\n\n/* eslint-disable default-case */\nconst onContextMenuTitleClick = async (action) => {\n    if (action !== 'delete' && action !== 'disconnect') {\n        const nodeData = {\n            name: props.node.type,\n            category: nodeCategory,\n            layer: props.node.layer,\n            color: nodeColor,\n        };\n\n        configurationState.editedType = nodeData.name;\n        configurationState.nodeData = nodeData;\n\n        let nodeInterfaces = [...displayedInputs.value, ...displayedOutputs.value];\n        nodeInterfaces = nodeInterfaces.filter((intf) => intf.direction !== undefined);\n        const configuredInterfaces = nodeInterfaces?.map((intf) => ({\n            name: intf?.name,\n            type: intf?.type,\n            direction: intf?.direction,\n            maxConnectionsCount: intf?.maxConnectionsCount,\n        }));\n\n        /* eslint-disable no-underscore-dangle */\n        const properties = sidebarProperties.value;\n        const configuredProperties = properties?.map((prop) => ({\n            name: prop?.name,\n            type: prop?.type,\n            default: prop?._value,\n            min: prop?.min,\n            max: prop?.max,\n            values: prop?.items,\n            step: prop?.step,\n            readonly: prop?.readonly,\n            dtype: prop?.dtype,\n        }));\n\n        configurationState.properties = configuredProperties;\n        configurationState.interfaces = configuredInterfaces;\n    }\n\n    const nodeData = {\n        name: props.node.type,\n        category: nodeCategory,\n        layer: props.node.layer,\n    };\n\n    if (action.includes('gotoRelatedGraph')) {\n        viewModel.value.editor.switchToRelatedGraph(action.replace(/^gotoRelatedGraph /, ''));\n    }\n    switch (action) {\n        case 'delete':\n            startTransaction();\n            // If the node is not selected, select it\n            if (!graph.value.selectedNodes.includes(props.node)) {\n                graph.value.selectedNodes.push(props.node);\n            }\n            graph.value.selectedNodes.forEach((n) => removeNode(n));\n            graph.value.selectedNodes = [];\n            commitTransaction();\n            break;\n        case 'rename':\n            tempName.value = props.node.title;\n            renaming.value = true;\n            await nextTick();\n            focusOnRename();\n            break;\n        case 'disconnect': {\n            startTransaction();\n            let interfaces = [...displayedInputs.value, ...displayedOutputs.value];\n            graph.value.selectedNodes.forEach((n) => {\n                interfaces = interfaces.concat(\n                    Object.entries(n.inputs).filter(([name, ni]) => !ni.hidden && !name.startsWith('property_')).map(([, ni]) => ni),\n                    Object.values(n.outputs).filter((ni) => !ni.hidden),\n                );\n            });\n            const nodeConnections = graph.value.connections.filter(\n                (c) =>\n                    (interfaces.find((i) => i === c.from || i === c.to) !== undefined),\n            );\n            nodeConnections.forEach((c) => {\n                graph.value.removeConnection(c);\n            });\n            commitTransaction();\n        } break;\n        case 'sidebar':\n            openSidebar();\n            break;\n        case 'editSubgraph': {\n            const errors = viewModel.value.editor.switchToSubgraph(props.node);\n            if (Array.isArray(errors) && errors.length) {\n                NotificationHandler.terminalLog('error', 'Dataflow is invalid', errors);\n            }\n            break;\n        }\n        case 'unwrap':\n            startTransaction();\n            removeNode(props.node, true);\n            commitTransaction();\n            break;\n        case 'configure':\n            menuState.configurationMenu.visible = true;\n            menuState.configurationMenu.addNode = false;\n            configurationState.nodeData = nodeData;\n            break;\n        case 'property':\n            menuState.propertyMenu = true;\n            break;\n        case 'interface':\n            menuState.interfaceMenu = true;\n            break;\n        case 'layer':\n            menuState.layerMenu = true;\n            break;\n        case 'addSubgraph': {\n            const errors = editorManager.addSubgraphToNode(props.node);\n            if (Array.isArray(errors) && errors.length) {\n                NotificationHandler.terminalLog('error', 'Creating subgraph failed', errors);\n            }\n            break;\n        }\n        case 'addAndEditSubgraph': {\n            let errors = editorManager.addSubgraphToNode(props.node);\n            if (Array.isArray(errors) && errors.length) {\n                NotificationHandler.terminalLog('error', 'Creating subgraph failed', errors);\n            }\n            const newGraphNode = viewModel.value.displayedGraph.nodes.filter(\n                (n) => n.type === props.node.type,\n            )[0];\n            errors = viewModel.value.editor.switchToSubgraph(newGraphNode);\n            if (Array.isArray(errors) && errors.length) {\n                NotificationHandler.terminalLog('error', 'Switching to subgraph failed', errors);\n            }\n            break;\n        }\n        case 'delete-property':\n            menuState.propertyListMenu = true;\n            break;\n        case 'delete-interface':\n            menuState.interfaceListMenu = true;\n            break;\n    }\n};\n\nconst onContextMenuSizeUpdate = (size) => {\n    // Adjust context menu position to fit into the viewport\n    const offset = contextMenuPosition.value + size.height + 200 - window.innerHeight;\n    if (offset > 0) {\n        contextMenuTitleY.value -= offset;\n    }\n    // Make it visible\n    contextMenuVisibility.value = 'visible';\n};\n\nconst canOpenContextMenu = computed(() =>\n    (contextMenuTitleItems.value.length === 0 && displayNoResources)\n        || contextMenuTitleItems.value.length > 0,\n);\n\nconst showContextMenuInterface = ref(false);\nconst showContextMenuProperty = ref(false);\n\nconst openContextMenuTitle = (ev) => {\n    if (\n        canOpenContextMenu.value &&\n        showContextMenuTitle.value === false &&\n        showContextMenuInterface.value === false &&\n        showContextMenuProperty.value === false\n    ) {\n        // Render the menu but keep it hidden\n        showContextMenuTitle.value = true;\n\n        // Set initial menu position\n        const target = ev.currentTarget;\n        contextMenuTitleX.value = ev.offsetX;\n        contextMenuTitleY.value = ev.offsetY + target.offsetTop + 20;\n        contextMenuPosition.value = ev.clientY;\n    }\n};\n\nconst groupDragMove = useGroupDragMove(\n    toRef(props.node, 'position'),\n    props.node.id,\n    gridSnapper(movementStep),\n);\n\nconst classes = computed(() => ({\n    '--selected': props.selected,\n    '--dragging': groupDragMove.dragging.value,\n    '--two-column': !!props.node.twoColumn,\n    '--greyed-out': props.greyedOut,\n    '--hidden': props.hidden,\n    __readonly: viewModel.value.editor.readonly,\n}));\n\nconst styles = computed(() => ({\n    top: `${props.node.position?.y ?? 0}px`,\n    left: `${props.node.position?.x ?? 0}px`,\n    width: `${props.node.width ?? 300}px`,\n}));\n\nconst nodeTitle = computed(() => {\n    const title = props.node.highlightedTitle ?? props.node.title;\n    const type = props.node.highlightedType ?? props.node.type;\n\n    if (title === '' || props.node.title === props.node.type) {\n        return type;\n    }\n\n    return `${title} <pre class=\"subtitle\">${type}</pre>`;\n});\n\nconst select = (event) => {\n    emit('select', event);\n};\n\nlet abortDrag;\nlet stopDrag;\n\nconst cleanEvents = () => {\n    document.removeEventListener('pointermove', groupDragMove.onPointerMove);\n    document.removeEventListener('keyboard.escape', abortDrag);\n    document.removeEventListener('pointerup', stopDrag);\n};\n\nabortDrag = () => {\n    cleanEvents();\n};\n\nstopDrag = () => {\n    groupDragMove.onPointerUp();\n    cleanEvents();\n};\n\nconst startDrag = (ev) => {\n    if (!graph.value.selectedNodes.includes(props.node)) {\n        select(ev);\n    }\n\n    groupDragMove.onPointerDown(ev);\n    document.addEventListener('pointermove', groupDragMove.onPointerMove);\n    document.addEventListener('keyboard.escape', abortDrag);\n    document.addEventListener('pointerup', stopDrag);\n};\n\nconst doneRenaming = () => {\n    graph.value.findNodeById(props.node.id).title = tempName.value;\n    renaming.value = false;\n};\n\nconst onRender = () => {\n    if (nodeRef.value) {\n        viewModel.value.hooks.renderNode.execute({ node: props.node, el: nodeRef.value });\n    }\n};\n\nonMounted(onRender);\nonUpdated(onRender);\n\n// ----------\n\n/**\n * Wrapper that prevents node moving if the editor is in read-only mode.\n *\n * @param ev Event\n */\nconst startDragWrapper = (ev) => {\n    if (!viewModel.value.editor.readonly) {\n        startDrag(ev);\n    }\n};\n\nconst openDoubleClick = doubleClick(700, () => {\n    openSidebar();\n});\n\n/* eslint-disable vue/no-mutating-props,no-param-reassign */\nconst onMouseDown = () => {\n    const { sidebar } = viewModel.value.displayedGraph;\n    if (sidebar.visible) {\n        sidebar.nodeId = props.node.id;\n    }\n\n    openDoubleClick();\n};\nconst displayedLeftSockets = computed(() =>\n    Object.values([...displayedInputs.value, ...displayedOutputs.value])\n        .filter((intf) => intf.side === 'left' && intf.port)\n        .sort((intf1, intf2) => intf1.sidePosition - intf2.sidePosition),\n);\n\nconst displayedRightSockets = computed(() =>\n    Object.values([...displayedInputs.value, ...displayedOutputs.value])\n        .filter((intf) => intf.side === 'right' && intf.port)\n        .sort((intf1, intf2) => intf1.sidePosition - intf2.sidePosition),\n);\nconst getRows = (sockets) => {\n    if (!sockets.length) {\n        return [];\n    }\n\n    const positionArr = sockets.map((s) => s.sidePosition ?? 0);\n\n    const numOfLines = Math.max(...positionArr);\n\n    let numOfSocket = 0;\n    const rows = [];\n\n    for (let i = 0; i <= numOfLines; i += 1) {\n        if (sockets[numOfSocket]?.sidePosition === i) {\n            rows.push(sockets[numOfSocket]);\n            numOfSocket += 1;\n        } else {\n            rows.push(undefined);\n        }\n    }\n    return rows;\n};\n// another potential source of issue\nconst displayedRightRows = computed(() => getRows(displayedRightSockets.value));\nconst displayedLeftRows = computed(() => getRows(displayedLeftSockets.value));\n\nwatch(sidebarProperties, () => {\n    sidebarProperties.value.forEach((prop) => {\n        if (prop.setDefaultComponent !== undefined) {\n            prop.setDefaultComponent();\n        }\n    });\n}, {\n    immediate: true,\n});\n\nconst path = viewModel.value.editor.getNodeIconPath(props.node.type);\nconst iconPath = viewModel.value.cache[`./${path}`] ?? path;\n\n// Metadata (\"icon\" is not a string) > Predefined > Cached > Arbitrary URI\nconst nodeStyle = computed(() => {\n    let icon;\n    let name = viewModel.value.editor.getStyleIcon(node.value.type);\n\n    if (typeof name === 'object' && name !== null) {\n        name = editorManager.getMetadataIcon(name);\n    }\n    if (icons[name] !== undefined) {\n        icon = icons[name];\n    } else if (viewModel.value.cache[`./${name}`] !== undefined) {\n        icon = icons.Placeholder;\n        name = viewModel.value.cache[`./${name}`];\n    }\n\n    return { icon, name };\n});\n\n// Interface modification\n\nlet newSocketIndex;\nlet chosenInterface;\nlet chosenProperty;\n\nconst leftSocketsRefs = ref(null);\nconst rightSocketsRefs = ref(null);\n\nconst interfaceCursorStyle = ref({\n    top: '0px',\n    left: '0px',\n    display: 'none',\n});\n\nconst nodeTitleStyle = computed(() => {\n    if (!viewModel.value.editor.readonly) {\n        return {\n            cursor: 'drag',\n            backgroundColor: nodeColor.value,\n            color: nodeTitleColor.value,\n        };\n    }\n\n    if (canOpenContextMenu.value) {\n        return {\n            cursor: 'pointer',\n            backgroundColor: nodeColor.value,\n            color: nodeTitleColor.value,\n        };\n    }\n\n    return {\n        cursor: 'default',\n        backgroundColor: nodeColor.value,\n        color: nodeTitleColor.value,\n    };\n});\n\nconst nodePillStyle = computed(() => ({\n    cursor: 'default',\n    backgroundColor: pillColor.value,\n    color: pillTextColor.value,\n}));\n\nconst isPickedInterface = (intf) => intf === chosenInterface;\n\nconst assignNewPosition = () => {\n    updateInterfacePosition(\n        props.node,\n        chosenInterface,\n        chosenInterface.side,\n        newSocketIndex,\n        true,\n    );\n};\n\nconst dragInterface = (ev) => {\n    let sockets;\n    if (chosenInterface.side === 'right') {\n        sockets = rightSocketsRefs.value;\n    } else if (chosenInterface.side === 'left') {\n        sockets = leftSocketsRefs.value;\n    }\n\n    // Finding the first interface that is lower than the cursor\n    let socket = [...sockets.children].findIndex((socketRef) => {\n        const boundingRect = socketRef.getBoundingClientRect();\n        return boundingRect.bottom > ev.clientY;\n    });\n    newSocketIndex = socket;\n\n    if (socket === -1) {\n        socket = sockets.children.length - 1;\n        newSocketIndex = sockets.children.length - 1;\n    }\n\n    const el = sockets.children[socket];\n    interfaceCursorStyle.value = {\n        top: `${el.offsetTop + el.offsetHeight / 2 - 2.5}px`,\n        display: 'block',\n    };\n\n    if (chosenInterface.side === 'right') {\n        interfaceCursorStyle.value.right = '-0.7em';\n    } else if (chosenInterface.side === 'left') {\n        interfaceCursorStyle.value.left = '-0.7em';\n    }\n};\n\nconst dropInterface = () => {\n    assignNewPosition();\n\n    chosenInterface = undefined;\n    interfaceCursorStyle.value = {\n        top: '0px',\n        left: '0px',\n        right: '0px',\n        display: 'none',\n    };\n\n    document.removeEventListener('pointermove', dragInterface);\n    document.removeEventListener('pointerup', dropInterface);\n};\n\nconst pickInterface = (intf, ev) => {\n    chosenInterface = intf;\n    dragInterface(ev);\n\n    document.addEventListener('pointermove', dragInterface);\n    document.addEventListener('pointerup', dropInterface);\n};\n\n// Interface context menu\n\nconst contextMenuInterfaceX = ref(0);\nconst contextMenuInterfaceY = ref(0);\n\nconst createContextMenuInterfaceItems = () => {\n    const items = [];\n\n    if (chosenInterface !== undefined) {\n        const intfMode = (chosenInterface.externalName === undefined ?\n            { value: 'SetExternalName', label: 'Expose Interface', icon: icons.Subgraph } :\n            { value: 'UnsetExternalName', label: 'Privatize Interface', icon: icons.Subgraph }\n        );\n        items.push(intfMode);\n    }\n\n    items.push(\n        { value: 'SpaceUp', label: 'Space Up' },\n        { value: 'SpaceDown', label: 'Space Down' },\n        { value: 'MoveUp', label: 'Move Up' },\n        { value: 'MoveDown', label: 'Move Down' },\n    );\n\n    return items;\n};\n\nconst contextMenuInterfaceItems = ref(createContextMenuInterfaceItems());\n\n/* eslint-disable default-case */\nconst onContextMenuInterfaceClick = (action) => {\n    switch (action) {\n        case 'SetExternalName':\n            viewModel.value.editor.exposeInterface(\n                graph.value.id,\n                chosenInterface,\n            );\n            break;\n        case 'UnsetExternalName':\n            viewModel.value.editor.privatizeInterface(\n                graph.value.id,\n                chosenInterface,\n            );\n            break;\n        case 'MoveUp':\n            if (chosenInterface.sidePosition === 0) {\n                chosenInterface = undefined;\n                break;\n            }\n            newSocketIndex = chosenInterface.sidePosition - 1;\n            dropInterface();\n            break;\n        case 'MoveDown':\n            newSocketIndex = chosenInterface.sidePosition + 1;\n            dropInterface();\n            break;\n        case 'SpaceUp':\n        case 'SpaceDown': {\n            const sockets =\n                chosenInterface.side === 'right'\n                    ? displayedRightRows.value\n                    : displayedLeftRows.value;\n            const comparison = action === 'SpaceDown' ? (a, b) => a > b : (a, b) => a >= b;\n            Object.values(sockets).forEach((intf) => {\n                if (intf !== undefined &&\n                comparison(intf.sidePosition, chosenInterface.sidePosition)) {\n                    intf.sidePosition += 1; // eslint-disable-line no-param-reassign\n                }\n            });\n            break;\n        }\n    }\n};\n\nconst openContextMenuInterface = (intf, ev) => {\n    if (!viewModel.value.editor.readonly && showContextMenuInterface.value === false) {\n        chosenInterface = intf;\n        contextMenuInterfaceItems.value = createContextMenuInterfaceItems();\n        if (chosenInterface.side === 'right') {\n            contextMenuInterfaceX.value = ev.currentTarget.offsetLeft + 162.5;\n            contextMenuInterfaceY.value = ev.currentTarget.offsetTop + 12.5;\n        } else if (chosenInterface.side === 'left') {\n            contextMenuInterfaceX.value =\n                ev.currentTarget.offsetLeft - ev.currentTarget.offsetWidth + 162.5;\n            contextMenuInterfaceY.value = ev.currentTarget.offsetTop + 12.5;\n        }\n\n        showContextMenuInterface.value = true;\n    }\n};\n\nwatch(showContextMenuInterface, () => {\n    if (showContextMenuInterface.value === false) {\n        chosenInterface = undefined;\n    }\n});\n\nconst toggleGroup = (intf) => {\n    intf.group.forEach((name) => {\n        props.node.inputs[name].hidden = !intf.value;\n    });\n};\n\nconst updateDynamicInterfaces = (intf) => {\n    props.node.updateDynamicInterfaces(intf);\n};\n\n/* eslint-disable no-param-reassign */\nconst switchSides = (intf) => {\n    if (intf.side === 'left') {\n        updateInterfacePosition(props.node, intf, 'right');\n    } else {\n        updateInterfacePosition(props.node, intf, 'left');\n    }\n};\n\n// Property context menu\n\nconst contextMenuPropertyX = ref(0);\nconst contextMenuPropertyY = ref(0);\n\nconst createContextMenuPropertyItems = () => {\n    const items = [];\n\n    if (chosenProperty !== undefined) {\n        const propertyMode = (chosenProperty.externalName === undefined ?\n            { value: 'SetExternalName', label: 'Expose Property', icon: icons.Subgraph } :\n            { value: 'UnsetExternalName', label: 'Privatize Property', icon: icons.Subgraph }\n        );\n        items.push(propertyMode);\n    }\n\n    return items;\n};\n\nconst contextMenuPropertyItems = ref(createContextMenuPropertyItems());\n\n/* eslint-disable default-case */\nconst onContextMenuPropertyClick = (action) => {\n    switch (action) {\n        case 'SetExternalName':\n            viewModel.value.editor.exposeInterface(\n                graph.value.id,\n                chosenProperty,\n            );\n            break;\n        case 'UnsetExternalName':\n            viewModel.value.editor.privatizeInterface(\n                graph.value.id,\n                chosenProperty,\n            );\n            break;\n    }\n};\n\nconst openContextMenuProperty = (property, ev) => {\n    if (!viewModel.value.editor.readonly && showContextMenuProperty.value === false) {\n        chosenProperty = property;\n        contextMenuPropertyItems.value = createContextMenuPropertyItems();\n\n        if (contextMenuPropertyItems.value.length > 0) {\n            const target = ev.currentTarget;\n            contextMenuPropertyX.value = ev.offsetX;\n            contextMenuPropertyY.value = ev.offsetY + target.offsetTop + 20;\n            showContextMenuProperty.value = true;\n        }\n    }\n};\n\nwatch(showContextMenuProperty, () => {\n    if (showContextMenuProperty.value === false) {\n        chosenProperty = undefined;\n    }\n});\n\n</script>\n\n<style lang=\"scss\" scoped>\n.interface-cursor {\n    position: relative;\n    top: 0;\n    left: 0;\n\n    & > .line {\n        position: absolute;\n        height: 0.2em;\n        width: 1.4em;\n        background-color: $gold;\n        z-index: 100;\n    }\n}\n.pill {\n    border-radius: 25px;\n    transform: translate(-20%, -50%);\n    font-size: 0.75em;\n    padding: 5px;\n    width: auto;\n    height: auto;\n    z-index: 1;\n    pointer-events: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n}\n\n</style>\n","import script from \"./CustomNode.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CustomNode.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CustomNode.vue?vue&type=style&index=0&id=180097b4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-180097b4\"]])\n\nexport default __exports__","import { render } from \"./Editor.vue?vue&type=template&id=61775051\"\nimport script from \"./Editor.vue?vue&type=script&lang=js\"\nexport * from \"./Editor.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","/*\n * Copyright (c) 2022-2024 Antmicro <www.antmicro.com>\n *\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Implements additional functions for CustomNode\n */\n\nimport { useViewModel, useGraph } from '@baklavajs/renderer-vue';\n\n/**\n * The function decides whether a name for the option should be displayed.\n *\n * @param optionType Name of the option component\n * @returns True if the name should be displayed, false otherwise.\n */\nexport function getOptionName(optionType) {\n    switch (optionType) {\n        case 'InputInterface':\n        case 'TextAreaInterface':\n        case 'SelectInterface':\n        case 'ListInterface':\n        case 'TextInterface':\n        case 'HexInterface':\n            return true;\n        case 'NumberInterface':\n        case 'IntegerInterface':\n        case 'CheckboxInterface':\n        case 'SliderInterface':\n        case 'NodeInterface':\n        default:\n            return false;\n    }\n}\n\n/**\n * Updates a side and optionally a sidePosition of an interface\n *\n * @param node in which the interface is updated\n * @param intf interface to update\n * @param newSide new side of the interface\n * @param newSidePosition new position of the interface. If it is occupied\n * @param swap if true then if an interface is found in 'newSidePosition' then they\n * are swapped\n * then an old interface is moved.\n */\n/* eslint-disable no-param-reassign */\nexport function updateInterfacePosition(\n    node,\n    intf,\n    newSide,\n    newSidePosition = undefined,\n    swap = false,\n    editNode = true,\n) {\n    if (editNode) {\n        const { graph } = useGraph();\n        graph.value.editNode(node);\n    }\n\n    const oldSidePosition = intf.sidePosition;\n\n    intf.side = newSide;\n    if (newSidePosition !== undefined) {\n        intf.sidePosition = newSidePosition;\n    }\n\n    const found = [\n        ...Object.values(node.inputs),\n        ...Object.values(node.outputs),\n    ].find(\n        (io) => io.id !== intf.id &&\n            io.sidePosition === intf.sidePosition &&\n            io.side === intf.side,\n    );\n\n    if (found !== undefined) {\n        if (newSidePosition !== undefined && swap) {\n            found.sidePosition = oldSidePosition;\n        } else {\n            const intfToMove = newSidePosition === undefined ? intf : found;\n\n            // Finding the first non occupied side position on that side\n            const sameSide = [\n                ...Object.values(node.inputs),\n                ...Object.values(node.outputs),\n            ].filter((io) => io.side === intfToMove.side && !io.hidden);\n            const occupiedPositions = sameSide.map((io) => io.sidePosition);\n\n            let proposedPosition = 0;\n            while (occupiedPositions.includes(proposedPosition)) {\n                proposedPosition += 1;\n            }\n\n            intfToMove.sidePosition = proposedPosition;\n        }\n    }\n}\n\n/**\n * Wrapper for nodes removal\n *\n * @param node node to remove. Can be either a graph node or a regular node\n * @param unwrapGraph determines whether to unwrap the graph node contents\n * into the current graph. Can be used only when removing a graph node\n */\nexport function removeNode(node, unwrapGraph = false) {\n    const { viewModel } = useViewModel();\n    const isGraphNode = viewModel.value.editor.isGraphNode(node.type);\n    if (isGraphNode && unwrapGraph) {\n        viewModel.value.editor.unwrapSubgraph(node);\n    } else {\n        const { graph } = useGraph();\n        graph.value.removeNode(node);\n    }\n}\n"],"names":["class","extends","NodeInterface","props","highlighted","Boolean","picked","switchSides","toggleGroup","default","required","updateDynamicInterfaces","sidebar","tabindexValue","components","Arrow","setup","el","isConnected","showComponent","startHover","endHover","openSidebar","viewModel","graph","intf","events","beforeSetValue","unsubscribe","subscribe","value","prevent","editor","readonly","undefined","min","max","group","setValue","name","endsWith","hovered","propertyHovered","onMouseDown","doubleClick","displayArrow","port","direction","arrowRotation","side","newClasses","__readonly","isExposed","externalName","setPort","componentName","editExternalName","externalNameInputIncorrect","externalNameInput","externalNames","inputExternalName","enableExternalNameEdit","e","splice","length","push","obtainExposedNames","indexOf","preventDefault","then","focus","select","isIncorrectExternalName","endHoverWrapper","externalNameInputCallback","target","externalNameFocusOutCallback","newExternalName","resolveNewExposedName","exposeInterface","id","startHoverWrapper","startPropertyHover","endPropertyHover","ir","isRegistered","Array","from","graphs","map","g","nodes","flat","n","Object","entries","inputs","filter","key","_","startsWith","prop","forEach","ref","type","spellcheck","autocomplete","placeholder","blur","stopPropagation","noninteractable","color","scale","rotate","component","node","tabindex","style","ContextMenu","urls","emits","context","styles","classes","itemsWithHoverProperty","justOpened","async","size","getBoundingClientRect","emit","closeContextMenu","ev","modelValue","document","elementsFromPoint","clientX","clientY","includes","window","removeEventListener","addEventListener","onClick","item","getIconPath","cache","onPointerOver","onPointerEmit","onPointerLeave","index","url","disabled","icon","label","tooltipMsg","href","draggable","src","alt","GraphTemplate","_name","constructor","state","super","this","PipelineManagerEditor","preview","_hideHud","hideHud","val","_readonly","allowLoopbacks","nodeIcons","Map","nodeColors","baseURLs","baseIconUrls","nodeURLs","nodeStyles","layoutManager","LayoutManager","subgraphStack","parentNodes","additionalNodeTypes","Set","subgraphStackGraphTypeEnum","SUBGRAPH","RELATEDGRAPH","editorManager","newRootGraph","registerGraph","customGraph","addAnchor","removeAnchor","editNode","graphNode","checkConnection","to","connectionAllowed","error","fromNode","findNodeById","nodeId","toNode","tmp","isInput","connections","some","c","maxConnectionsCount","connectionCount","fromTypes","String","toTypes","find","t","prevented","hooks","execute","hr","errors","dummyConnection","connectionsInDanger","anchor","connection","position","anchorToAdd","x","y","anchors","replaceNode","oldNode","newNodeName","oldPosition","newNodeInstance","nodeTypes","get","title","outputs","prototype","hasOwnProperty","call","sidePosition","interfaces","values","connectionsToRestore","conn","newConn","removeNode","addNode","internalAddConnection","graphLoadingState","beforeAddNode","nodeEvents","addTarget","nodeHooks","template","newState","JSON","parse","stringify","save","_nodes","onPlaced","destroy","load","i","removeConnection","specOrGenerated","mapping","has","nodesErrors","nodeInformation","subgraph","graphState","graphsBefore","unregisterGraph","interfacesEntries","newToSpecNodeIds","newInterfaceIds","newToSpecConnIds","newToSpecIntfIds","nodeErrors","isArray","connectionsErrors","connectionErrors","fromIf","findNodeInterface","toIf","reportIfMissing","reportIfFound","intfIdLabel","nodeIdLabel","connIdLabel","checkConnectionResult","connectionToRemove","instance","sizes","HTMLelement","getElementById","width","offsetWidth","height","offsetHeight","margin","rightmostX","Math","leftmostX","bottommostY","topmostY","graphHeight","graphWidth","scaling","panning","removeSelectedNodes","selectedNodes","beforeRemoveNode","onDestroy","removeTarget","removeNodeOnly","exposedNames","sameExposedNames","sameInterfaceNames","keys","split","suffix","tmpName","createPipelineManagerGraph","subgraphStackFrames","isInSubgraph","_graph","frame","backFromSubgraph","currentGraphId","currentGraphState","dataflowState","recurrentSubgraphSave","relatedGraphs","graphObject","getNodeColor","entryGraph","reverse","switchToRelatedGraph","switchToSubgraph","deepCleanEditor","suppressHistory","bind","cleanEditor","graphName","graphInstance","unregisterGraphs","unregisterNodes","nodeKey","unregisterNodeType","registerNodeType","options","beforeRegisterNodeType","nodeInstance","_nodeTypes","set","category","isCategory","subgraphId","pill","preventCentering","loadOnly","templateName","clearRegistry","readonlySetting","usedSubgraphs","clear","fittingTemplate","add","setNodeColor","graphToLoad","preparedSubgraphState","prepareSubgraphErrors","err","toString","loaded","dfs","path","returnedPath","layoutEngine","activeAlgorithm","applyAutolayout","centerZoom","privatizeInterface","graphId","graphIds","sharedInterface","getRegisteredInterface","graphIdIdx","findIndex","updateExposedInterfaces","deleteRegisteredInterface","getExposedProperties","editorSize","Error","terminalHeight","getElementsByClassName","navbarHeight","nodePalette","sideBarWidth","paletteRect","right","editorHeight","innerHeight","editorWidth","innerWidth","scalingY","scalingX","translationX","translationY","nodeURLsEmpty","getNodeURLs","nodeName","fullUrls","urlName","getNodeIconPath","getPillText","nodeType","text","getNodeStyle","getNodeCategory","nodeColor","getStyleIcon","assign","styleName","getPillColor","getTextColor","rgb","exec","r","parseInt","b","isGraphNode","nodeHasRelatedGraphs","addGraphTemplate","beforeAddGraphTemplate","_graphTemplates","graphTemplateEvents","graphTemplateHooks","customGraphNodeType","switchGraph","subgraphNode","_switchGraph","computeLayout","updateNodesPosition","wasCentered","switchToGraph","targetGraph","pop","relatedGraphID","baklavaView","displayedGraph","relatedGraph","newGraph","changeTopLevelGraph","rootGraph","findInterface","intfId","foundIntf","concat","unwrapSubgraph","subgraphNodes","meanX","reduce","sum","meanY","addedNode","subgraphNodeConnections","fromInterface","toInterface","createdConnection","addConnection","newAnchor","resetLocations","updatedGraph","updatedState","updateCurrentSubgraphName","nodeRef","URLs","Cross","CustomInterface","CheckboxInterface","NodeSpecificationEditor","Tooltip","_props","EditorManager","getEditorManagerInstance","converter","smartIndentationFix","simpleLineBreaks","prettyCategory","replace","join","desc","html","makeHtml","description","match","hrefParts","newEnd","newHref","nodeIcon","nodeIconPath","sidebarVisible","visible","newValue","tooltipRef","tooltip","sidebarRef","top","left","onMouseMove","movementX","displayedProperties","interfaceGroups","ni","interfaceGroupsOutput","interfaceGroupsButtonClasses","interfaceGroupsCheckboxes","checkboxes","intfG","checkbox","hidden","enabledInterfaceGroups","parsedIntfName","intfDirection","groupName","enabledInterfaceGroupsCheckboxes","interfaceGroupsButton","toggleInterfaceGroup","replacementButtons","list","buttons","eName","button","newNode","nodeSiblings","siblings","extended","extending","delete","replacementParents","replacementChildren","replacementSiblings","displayedName","startResize","once","close","offsetX","currentTarget","$el","clientWidth","offsetY","getOptionName","$isMobile","settings","parent","child","sibling","input","output","scrollHandle","prepareSubgraphInstance","newSubgraphNodeId","mode","isRoot","specSubgraphNodeId","createNewNodeId","newId","getOrGenerate","factory","createNewInterfaceId","oldId","idMap","nonExposed","exposedNotInSubgraphNode","getOrGenerateInterfaceId","addNewId","mapNodeInterfaces","acc","addNewInterfaceIds","CreateCustomGraphNodeType","nodeInputs","newNodeOutputs","parsedInterfaces","prepareInterfaces","properties","parsedProperties","prepareProperties","newNodeInputs","nodeInterfaces","layer","twoColumn","beforeLoad","out","instanceName","privatize","evaluatedIntf","evaluatedProp","updateInterfaces","updateProperties","initialize","_title","update","privatizeInterfaces","newInterfaces","currentInterfaces","nodeIntf","container","removeInterface","newInputs","newOutputs","pushGraphIdToRegistry","createSharedInterface","addInterface","newProperties","property","foundProperty","np","addInput","movementStep","titleRef","renaming","renameField","tempName","nodeTitleColor","nodeCategory","pillText","pillColor","pillTextColor","displayNoResources","displayedInputs","displayedOutputs","sidebarProperties","showHiddenProperties","hideOnDefault","externalApplicationManager","firstWatch","notifyWhenChanged","data","graph_id","node_id","new_value","notifyAboutChange","showContextMenuTitle","contextMenuTitleX","contextMenuTitleY","contextMenuVisibility","contextMenuPosition","contextMenuStyle","transform","contextMenuTitleItems","items","icons","Sidebar","endSection","editableNodeTypes","Subgraph","toEntries","fromEntries","at","Pencil","Disconnect","Bin","onContextMenuTitleClick","action","nodeData","editedType","configuredInterfaces","configuredProperties","_value","step","dtype","terminalLog","configurationMenu","propertyMenu","interfaceMenu","layerMenu","addSubgraphToNode","newGraphNode","propertyListMenu","interfaceListMenu","onContextMenuSizeUpdate","offset","canOpenContextMenu","showContextMenuInterface","showContextMenuProperty","openContextMenuTitle","offsetTop","groupDragMove","useGroupDragMove","selected","dragging","greyedOut","nodeTitle","highlightedTitle","highlightedType","event","abortDrag","stopDrag","cleanEvents","onPointerMove","onPointerUp","doneRenaming","onRender","renderNode","openDoubleClick","displayedLeftSockets","sort","intf1","intf2","displayedRightSockets","getRows","sockets","positionArr","s","numOfLines","numOfSocket","rows","displayedRightRows","displayedLeftRows","setDefaultComponent","immediate","iconPath","nodeStyle","getMetadataIcon","Placeholder","newSocketIndex","chosenInterface","chosenProperty","leftSocketsRefs","rightSocketsRefs","interfaceCursorStyle","display","nodeTitleStyle","cursor","backgroundColor","nodePillStyle","isPickedInterface","dragInterface","socket","children","socketRef","bottom","dropInterface","pickInterface","contextMenuInterfaceX","contextMenuInterfaceY","createContextMenuInterfaceItems","intfMode","contextMenuInterfaceItems","onContextMenuInterfaceClick","comparison","a","openContextMenuInterface","offsetLeft","contextMenuPropertyX","contextMenuPropertyY","createContextMenuPropertyItems","propertyMode","contextMenuPropertyItems","onContextMenuPropertyClick","oncontextmenu","$event","onPointerDown","startDrag","sanitize","imgURI","loading","CustomNode","Panel","ParentMenu","PipelineManagerConnection","TemporaryConnection","Palette","RectangleSelection","WelcomeMenu","Zoom","Return","counter","nodeContainerStyle","keyDown","keyUp","connRefs","panZoom","temporaryConnection","highlightConnections","highlightInterfaces","rectangleSelection","selectedNodesCtrlBackup","searchQuery","greyedOutNodes","pressStartTime","editorStyle","unselectAllNodes","setLoad","appendSelectMultipleNodes","selectionBoundingRect","boundingRect","pointersDown","selecting","onMouseUp","Date","onRightPointerUp","onRightPointerUpCtrl","shiftKey","ctrlKey","onRightPointerDownCtrl","onRightPointerDown","clearHighlight","it","ignoredLayers","ignorableLayers","layers","ignoredInterfacesTypes","temp","ignoredNodesTypes","nodeLayers","visibleNodes","ignoredNodes","ignoredNodesId","visibleConnections","highlightedNodes","old","newIds","oldIds","nodesAdded","nodesDeleted","added","deleted","connectionsAdded","connectionsDeleted","nodesSelected","nodesUnselected","unselected","nodeTitles","matchingNodes","query","resultTitle","resultType","score","nonMatchingNodes","defaultSpecification","VUE_APP_SPECIFICATION_PATH","defaultDataflow","VUE_APP_DATAFLOW_PATH","updateEditorSpecification","specification","warnings","info","validateSpecification","specificationVersion","version","updateDataflow","dataflow","loadDataflow","messageTitle","jsonrpc","JSONRPC","isJSONRPCResponse","source","client","receive","createID","isJSONRPCRequest","response","method","registerFrontendApplication","server","requestAdvanced","externalApp","postMessage","setShowNotification","updateMetadata","loadInit","escapedsearch","location","search","urlParams","URLSearchParams","setting","specText","status","ret","include","restoreShowNotification","loadFiles","files","notify","showToast","objects","file","Promise","all","isSpecificationFunc","o","includeGraphs","isDataflowFunc","isInvalid","every","isSpecification","isDataflow","isValidSpec","usesBackend","showWelcome","welcome","onDrop","dataTransfer","dropEffect","kind","getAsFile","selectNode","commandHandler","pressedKeys","temporaryConnectionRender","render","mouseWheel","onMouseWheel","changeHoveredConnections","connectionsToHighlight","elementsUnderCursor","elementsWithZIndex","element","z","getComputedStyle","zIndex","z_index","Number","isNaN","highestZIndexElement","curr","hoveredHtml","containsPoint","hoveredConnections","htmlEl","hoveredInterface","classList","contains","closest","mostSuitableHighlight","hov","interfaceElement","findConnectionsToHighlight","removeHighlight","zoomIn","onZoomIn","zoomOut","onZoomOut","center","returnFromSubgraph","validating","isHighlighted","floating","optionType","updateInterfacePosition","newSide","newSidePosition","swap","oldSidePosition","found","io","intfToMove","occupiedPositions","proposedPosition","unwrapGraph"],"sourceRoot":""}